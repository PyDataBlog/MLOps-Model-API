Imports MySql.Data.MySqlClient

Namespace Dao.MySQL.Licitacao
    Public Class BuildLicitacaoCotacao
        Implements Dao.IModel(Of SGV.CotacaoLicitacao)
        Public Function BuildModel(ByVal myData As MySqlDataReader) As CotacaoLicitacao Implements IModel(Of CotacaoLicitacao).BuildModel
            Dim cotacao As New CotacaoLicitacao()
            cotacao.GetID = myData.GetInt32(0)
            cotacao.GetEmpresa = New Empresa(myData.GetInt32(1))
            cotacao.GetCliente = New Cliente(myData.GetInt32(2))
            Using modalidadeDao As New Dao.MySQL.Licitacao.LicitacaoModalidadeDao(New Dao.MySQL.ConnectionFactory().GetConnection())
                cotacao.GetModalidade = modalidadeDao.Get(myData.GetInt32(3))
            End Using
            cotacao.GetIDTipo = myData.GetInt32(4)
            cotacao.GetIDTipoServico = myData.GetInt32(5)
            cotacao.GetIDSituacao = myData.GetInt32(6)
            If Not myData.IsDBNull(7) Then cotacao.GetIDMotivoImpugnacao = myData.GetInt32(7)
            If Not myData.IsDBNull(8) Then cotacao.GetIDOrigem = myData.GetInt32(8)
            cotacao.GetCadastro = myData.GetDateTime(9)
            cotacao.GetStatus = myData.GetBoolean(10)
            If Not myData.IsDBNull(11) Then cotacao.GetDescricaoServico = myData.GetString(11)
            If Not myData.IsDBNull(12) Then cotacao.GetEdital = myData.GetString(12)
            If Not myData.IsDBNull(13) Then cotacao.GetProcesso = myData.GetString(13)
            If Not myData.IsDBNull(14) Then cotacao.GetPublicacao = myData.GetDateTime(14)
            If Not myData.IsDBNull(15) Then cotacao.GetVencimentoEdital = myData.GetDateTime(15)
            If Not myData.IsDBNull(16) Then cotacao.GetSite = myData.GetString(16)
            If Not myData.IsDBNull(17) Then cotacao.GetPrazoImpugnacao = myData.GetInt32(17)
            If Not myData.IsDBNull(18) Then cotacao.GetPregoeiroNome = myData.GetString(18)
            If Not myData.IsDBNull(19) Then cotacao.GetEmpresaVencedora = myData.GetString(19)
            If Not myData.IsDBNull(20) Then cotacao.GetValorFinal = myData.GetDouble(20)
            If Not myData.IsDBNull(21) Then cotacao.GetEmpenho = myData.GetString(21)
            If Not myData.IsDBNull(22) Then cotacao.GetDataEmpenho = myData.GetDateTime(22)
            If Not myData.IsDBNull(23) Then cotacao.GetValorEmpenho = myData.GetDouble(23)
            If Not myData.IsDBNull(24) Then cotacao.GetValorCaucao = myData.GetDouble(24)
            If Not myData.IsDBNull(25) Then cotacao.GetObs = myData.GetString(25)
            If Not myData.IsDBNull(26) Then cotacao.IsUse = myData.GetBoolean(26)
            If Not myData.IsDBNull(27) Then cotacao.GetIDUsuario = myData.GetInt32(27)
            cotacao.IsAprovado = myData.GetBoolean(28)
            cotacao.IsUseID = myData.GetBoolean(29)
            If Not myData.IsDBNull(30) Then cotacao.IsReprovado = myData.GetBoolean(30)
            If Not myData.IsDBNull(31) Then cotacao.GetReprovacao = New ReprovacaoCotacao().getIDReprovacao(myData.GetString(31))
            Return cotacao
        End Function
    End Class
End Namespace