using Vallado, Base.Test

# Vallado (2001), Example 5-1, p.266-7
JD = julianDate(1994, 4, 2, 0, 0, 0)
T  = JD2JDC(JD)

@test JD ≈ 2449444.5
@test T  ≈ -0.057508555

λecl, ϕecl, r☉ = sun_ecl(T)

@test isapprox(λecl, deg2rad(12.022725), rtol=1e-6)
@test ϕecl ≈ 0
@test r☉   ≈ 0.9994850

@test meanObliquity(T) ≈ deg2rad(23.4400388)

r⃗☉ = sun(JD)

@test isapprox(r⃗☉[1], 0.9775614, rtol=1e-6)
@test isapprox(r⃗☉[2], 0.1910117, rtol=1e-6)
@test isapprox(r⃗☉[3], 0.0828167, rtol=1e-6)