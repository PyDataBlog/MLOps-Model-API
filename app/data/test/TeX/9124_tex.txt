\hypertarget{namespacebasis__m}{}\section{basis\+\_\+m Module Reference}
\label{namespacebasis__m}\index{basis\+\_\+m@{basis\+\_\+m}}


This module contains the definition of the one-\/electron basis, and of the N-\/electron basis (now, just 2 electrons).  


\subsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
type \hyperlink{structbasis__m_1_1basis__t}{basis\+\_\+t}
\begin{DoxyCompactList}\small\item\em The two-\/electron basis (or N-\/electrons, in the future). \end{DoxyCompactList}\item 
type \hyperlink{structbasis__m_1_1one__basis__t}{one\+\_\+basis\+\_\+t}
\begin{DoxyCompactList}\small\item\em The one-\/electron basis data type. It just stores the total dimension, and the number of points in the lattice. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
\hypertarget{namespacebasis__m_a2fa8391246407e6293eb713352d6756e}{}\label{namespacebasis__m_a2fa8391246407e6293eb713352d6756e} 
subroutine, public \hyperlink{namespacebasis__m_a2fa8391246407e6293eb713352d6756e}{one\+\_\+basis\+\_\+init} ()
\begin{DoxyCompactList}\small\item\em Construction of the 1e basis. It is trivial\+: one just needs the number of lattice points. The dimension is twice that number. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacebasis__m_add42d96237ec46063b0493dc16755382}{one\+\_\+basis\+\_\+write\+\_\+info} (filename)
\begin{DoxyCompactList}\small\item\em Writes a file with information about the one-\/electron basis function. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacebasis__m_a79c9e6f9d79118aefa9945c92df4e580}{basis\+\_\+init} (N)
\begin{DoxyCompactList}\small\item\em Construction of the N-\/electron basis\+: the Slater determinants corresponding to a one-\/electron basis given in argument one\+\_\+basis. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacebasis__m_a8550e0fbe322b97c5f9e4a7414c14583}{basis\+\_\+write\+\_\+info} (filename)
\begin{DoxyCompactList}\small\item\em Writes a file with information about the one-\/electron basis function. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacebasis__m_ac5dfaeb47932787f83b34a034fa66744}{basis\+\_\+diff} (ii, jj, ndifs, i, a, phase)
\begin{DoxyCompactList}\small\item\em Given two Slater determinants ii and jj, it returns the number of different spin orbitals ndifs. It also returs which are the different spin orbitals i(1) and i(2) are the spin orbitals present in ii but not in jj, and a(1) and a(2) are the spin orbitals present in jj but not in ii. If there are no differences between the spin obitals, then i and a contain zeroes; if there is only difference betwwen the spin orbitals, then i(2) and a(2) contain zeroes. Finally phase is (-\/1) to the number of transpositions necessary in ii (or jj) in order to make both Slater determinants equal orbital by orbital except for the different ones. \end{DoxyCompactList}\item 
integer function, public \hyperlink{namespacebasis__m_a76484191ead448e008af978766070267}{i\+\_\+msigma} (m, sigma)
\begin{DoxyCompactList}\small\item\em This function defines the \char`\"{}order\char`\"{} of the one-\/electron basis elements. For a given orbital index (i.\+e. the grid point) and spin index, it is given by\+: \[ i(m, \sigma) = p\sigma + m \] where $\sigma$ is zero for spin down, and one for spin up, and $m$ runs over the $P$ points in the lattice. Therefore, the first $P$ basis elements are spin down, and the next basis elements are spin up. \end{DoxyCompactList}\item 
integer function, public \hyperlink{namespacebasis__m_a2330a7bdd4ab32ee8937e97ed4434d61}{m\+\_\+i} (i)
\begin{DoxyCompactList}\small\item\em This function computes the \char`\"{}m\char`\"{} value corresponding the the i-\/th 1e basis element. \end{DoxyCompactList}\item 
integer function, public \hyperlink{namespacebasis__m_aa3a464dd040afd84ea9d4af8c50381af}{sigma\+\_\+i} (i)
\begin{DoxyCompactList}\small\item\em Computation of the sigma value corresponding to the i-\/th 1e basis element\+: 0 for spin down basis elements, 1 for spin up elements. \end{DoxyCompactList}\item 
integer function, public \hyperlink{namespacebasis__m_a4629d4ef730d35e70a6225de68e9832a}{basis\+\_\+dotp} (I, J)
\begin{DoxyCompactList}\small\item\em Returns the dot product between two Slater determinants, $<$I$\vert$J$>$. \end{DoxyCompactList}\item 
integer function \hyperlink{namespacebasis__m_adb3fb17db9cb5f0c0807fef07379b715}{basis\+\_\+position} (ii, j)
\begin{DoxyCompactList}\small\item\em Given a Slater determinant ii, it returns the position occupied in that Slater determinant by the spin orbital j. If j does not belong to ii, then it returns 0. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hypertarget{namespacebasis__m_a3be7defbb73b2e69d3f70c44643688fb}{}\label{namespacebasis__m_a3be7defbb73b2e69d3f70c44643688fb} 
type(\hyperlink{structbasis__m_1_1one__basis__t}{one\+\_\+basis\+\_\+t}), public \hyperlink{namespacebasis__m_a3be7defbb73b2e69d3f70c44643688fb}{one\+\_\+basis}
\begin{DoxyCompactList}\small\item\em Global variable that holds the one-\/electron basis. \end{DoxyCompactList}\item 
\hypertarget{namespacebasis__m_ad1098245a0114d157a24b664b604f9e1}{}\label{namespacebasis__m_ad1098245a0114d157a24b664b604f9e1} 
type(\hyperlink{structbasis__m_1_1basis__t}{basis\+\_\+t}), public \hyperlink{namespacebasis__m_ad1098245a0114d157a24b664b604f9e1}{basis}
\begin{DoxyCompactList}\small\item\em Global variable that holds the many-\/electron basis. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
This module contains the definition of the one-\/electron basis, and of the N-\/electron basis (now, just 2 electrons). 

The one-\/electron basis is formed by a set of P localized basis elements (around the points of the lattice), multiplied by the spin part. The orbital Hilbert space is spanned by the basis functions\+:

\[ \pi_n(x) = \Delta^{-1/2} \theta\left(x-x_n-\frac{\Delta}{2}\right) \theta\left(x+x_n+\frac{\Delta}{2}\right) = \left\{ \begin{array}{cc} \Delta^{-1/2}\,, & x_n-\frac{\Delta}{2} \le x \le x_n + \frac{\Delta}{2}\,, \\ 0\,, & \textrm{otherwise} \end{array} \right. \] for $n=1,\dots,P$. We may then approximate any function $f$ by\+: \[ f \approx \sum_{n=1}^P f(x_n)\pi_n\,. \] Note that the index runs from $n=1$ to $P$, the extreme values are not considered since it is assumed that $f(x_0) = f(x_{P+1}) = 0$.

Those functions define the orbital Hilbert space; the complete one-\/electron Hilbert space is $\mathcal{H}_1 = \mathcal{H}_{\rm orb}\otimes\mathcal{H}_{\rm spin}$. Therefore the one-\/electron Hilbert space is generated by the orthonormal $ \lbrace \vert\pi_n\rangle\otimes\vert\sigma\rangle\rbrace_{ n=1,\dots,P}^{\sigma = \downarrow,\uparrow}$. The notation is usually simplified to $\vert\pi_n\sigma\rangle \equiv\vert\pi_n\rangle \otimes \vert\sigma\rangle$. Furthermore, it is convenient to define a combined index $i \equiv n\sigma$, and use $\vert\varphi_i\rangle \equiv \vert\varphi_{n\sigma}\rangle\equiv \vert\pi_n\sigma\rangle$. And, for the computer representation of these basis elements, it is even more convenient to consider $i$ as an integer index that runs from 1 to $2P$, such that $ i(n,\sigma) = P\sigma + n$, where remember $0\equiv\downarrow$, $1\equiv\uparrow$.

The $N$-\/electron basis is then constructed from the one-\/electron basis by constructing the Slater determinants in the usual way by making use of the creation-\/ annihilation operators. For two electrons, a basis for the $\mathcal{H}_2$ Hilbert space can be constructed as\+: \[ \vert \varphi_i \varphi_j \rangle = \hat{d}^\dagger_j \hat{d}^\dagger_i \vert 0\rangle\,. \] for $i=1,\dots,2P-1$, and $j=i+1,\dots 2P$. Therefore, \[ \dim(\mathcal{H}_2) = {{2P}\choose{2}} = P(2P-1)\,. \] since the basis is formed by all the different pairs of one-\/particle basis states. The many-\/electron basis can be denoted by $\lbrace\vert I \rangle\rbrace$, where $I$ runs from 1 to $\dim(\mathcal{H}_2)$. It remains to establish a relation between $(i,j)$ and $ I$, i.\+e. to establish what is the pair of spin orbitals that corresponds to each Slater determinant. The formula that we follow is\+:

\[ I(1, j) = j\;\;(j=2,\dots,P) \] \[ I(i, j) = I(i-1, P) + (j-i)\;\;(j=i+1,\dots,P; i > 1) \] 

\subsection{Function/\+Subroutine Documentation}
\hypertarget{namespacebasis__m_ac5dfaeb47932787f83b34a034fa66744}{}\label{namespacebasis__m_ac5dfaeb47932787f83b34a034fa66744} 
\index{basis\+\_\+m@{basis\+\_\+m}!basis\+\_\+diff@{basis\+\_\+diff}}
\index{basis\+\_\+diff@{basis\+\_\+diff}!basis\+\_\+m@{basis\+\_\+m}}
\subsubsection{\texorpdfstring{basis\+\_\+diff()}{basis\_diff()}}
{\footnotesize\ttfamily subroutine, public basis\+\_\+m\+::basis\+\_\+diff (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{ii,  }\item[{integer, intent(in)}]{jj,  }\item[{integer, intent(out)}]{ndifs,  }\item[{integer, dimension(2), intent(out)}]{i,  }\item[{integer, dimension(2), intent(out)}]{a,  }\item[{integer, intent(out)}]{phase }\end{DoxyParamCaption})}



Given two Slater determinants ii and jj, it returns the number of different spin orbitals ndifs. It also returs which are the different spin orbitals i(1) and i(2) are the spin orbitals present in ii but not in jj, and a(1) and a(2) are the spin orbitals present in jj but not in ii. If there are no differences between the spin obitals, then i and a contain zeroes; if there is only difference betwwen the spin orbitals, then i(2) and a(2) contain zeroes. Finally phase is (-\/1) to the number of transpositions necessary in ii (or jj) in order to make both Slater determinants equal orbital by orbital except for the different ones. 


\begin{DoxyParams}{Parameters}
{\em ii} & index of one of the Slater determinants. \\
\hline
{\em jj} & index of one of the Slater determinants. \\
\hline
{\em ndifs} & number of different spin orbitals in the determinants \\
\hline
{\em i(2)} & \char`\"{}holes\char`\"{}, i.\+e. the spin orbitals present in ii but not in jj \\
\hline
{\em a(2)} & \char`\"{}particles\char`\"{}, i.\+e. the spin orbitals present in jj but not in ii \\
\hline
{\em phase} & (-\/1) to the number of transpositions necessary to bring both determinants to maximum coincidence \\
\hline
\end{DoxyParams}
\hypertarget{namespacebasis__m_a4629d4ef730d35e70a6225de68e9832a}{}\label{namespacebasis__m_a4629d4ef730d35e70a6225de68e9832a} 
\index{basis\+\_\+m@{basis\+\_\+m}!basis\+\_\+dotp@{basis\+\_\+dotp}}
\index{basis\+\_\+dotp@{basis\+\_\+dotp}!basis\+\_\+m@{basis\+\_\+m}}
\subsubsection{\texorpdfstring{basis\+\_\+dotp()}{basis\_dotp()}}
{\footnotesize\ttfamily integer function, public basis\+\_\+m\+::basis\+\_\+dotp (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{I,  }\item[{integer, intent(in)}]{J }\end{DoxyParamCaption})}



Returns the dot product between two Slater determinants, $<$I$\vert$J$>$. 

It is useful only for debugging purposes; it should return 1 if I=J, and zero otherwise


\begin{DoxyParams}{Parameters}
{\em I} & the left Slater determinant index \\
\hline
{\em j} & the right Slater determinant index \\
\hline
\end{DoxyParams}
\hypertarget{namespacebasis__m_a79c9e6f9d79118aefa9945c92df4e580}{}\label{namespacebasis__m_a79c9e6f9d79118aefa9945c92df4e580} 
\index{basis\+\_\+m@{basis\+\_\+m}!basis\+\_\+init@{basis\+\_\+init}}
\index{basis\+\_\+init@{basis\+\_\+init}!basis\+\_\+m@{basis\+\_\+m}}
\subsubsection{\texorpdfstring{basis\+\_\+init()}{basis\_init()}}
{\footnotesize\ttfamily subroutine, public basis\+\_\+m\+::basis\+\_\+init (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{N }\end{DoxyParamCaption})}



Construction of the N-\/electron basis\+: the Slater determinants corresponding to a one-\/electron basis given in argument one\+\_\+basis. 


\begin{DoxyParams}{Parameters}
{\em N} & number of electrons \\
\hline
\end{DoxyParams}
\hypertarget{namespacebasis__m_adb3fb17db9cb5f0c0807fef07379b715}{}\label{namespacebasis__m_adb3fb17db9cb5f0c0807fef07379b715} 
\index{basis\+\_\+m@{basis\+\_\+m}!basis\+\_\+position@{basis\+\_\+position}}
\index{basis\+\_\+position@{basis\+\_\+position}!basis\+\_\+m@{basis\+\_\+m}}
\subsubsection{\texorpdfstring{basis\+\_\+position()}{basis\_position()}}
{\footnotesize\ttfamily integer function basis\+\_\+m\+::basis\+\_\+position (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{ii,  }\item[{integer, intent(in)}]{j }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



Given a Slater determinant ii, it returns the position occupied in that Slater determinant by the spin orbital j. If j does not belong to ii, then it returns 0. 


\begin{DoxyParams}{Parameters}
{\em ii} & The Slater determinant index \\
\hline
{\em j} & The spin orbital whose occupations is queried. \\
\hline
\end{DoxyParams}
\hypertarget{namespacebasis__m_a8550e0fbe322b97c5f9e4a7414c14583}{}\label{namespacebasis__m_a8550e0fbe322b97c5f9e4a7414c14583} 
\index{basis\+\_\+m@{basis\+\_\+m}!basis\+\_\+write\+\_\+info@{basis\+\_\+write\+\_\+info}}
\index{basis\+\_\+write\+\_\+info@{basis\+\_\+write\+\_\+info}!basis\+\_\+m@{basis\+\_\+m}}
\subsubsection{\texorpdfstring{basis\+\_\+write\+\_\+info()}{basis\_write\_info()}}
{\footnotesize\ttfamily subroutine, public basis\+\_\+m\+::basis\+\_\+write\+\_\+info (\begin{DoxyParamCaption}\item[{character(len=$\ast$), intent(in)}]{filename }\end{DoxyParamCaption})}



Writes a file with information about the one-\/electron basis function. 

The name of the file is given by filename.


\begin{DoxyParams}{Parameters}
{\em filename} & Name of the file where to write the basis details. \\
\hline
\end{DoxyParams}
\hypertarget{namespacebasis__m_a76484191ead448e008af978766070267}{}\label{namespacebasis__m_a76484191ead448e008af978766070267} 
\index{basis\+\_\+m@{basis\+\_\+m}!i\+\_\+msigma@{i\+\_\+msigma}}
\index{i\+\_\+msigma@{i\+\_\+msigma}!basis\+\_\+m@{basis\+\_\+m}}
\subsubsection{\texorpdfstring{i\+\_\+msigma()}{i\_msigma()}}
{\footnotesize\ttfamily integer function, public basis\+\_\+m\+::i\+\_\+msigma (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{m,  }\item[{integer, intent(in)}]{sigma }\end{DoxyParamCaption})}



This function defines the \char`\"{}order\char`\"{} of the one-\/electron basis elements. For a given orbital index (i.\+e. the grid point) and spin index, it is given by\+: \[ i(m, \sigma) = p\sigma + m \] where $\sigma$ is zero for spin down, and one for spin up, and $m$ runs over the $P$ points in the lattice. Therefore, the first $P$ basis elements are spin down, and the next basis elements are spin up. 


\begin{DoxyParams}{Parameters}
{\em m} & the orbital index of the basis element \\
\hline
{\em sigma} & the spin index of the basis element \\
\hline
\end{DoxyParams}
\hypertarget{namespacebasis__m_a2330a7bdd4ab32ee8937e97ed4434d61}{}\label{namespacebasis__m_a2330a7bdd4ab32ee8937e97ed4434d61} 
\index{basis\+\_\+m@{basis\+\_\+m}!m\+\_\+i@{m\+\_\+i}}
\index{m\+\_\+i@{m\+\_\+i}!basis\+\_\+m@{basis\+\_\+m}}
\subsubsection{\texorpdfstring{m\+\_\+i()}{m\_i()}}
{\footnotesize\ttfamily integer function, public basis\+\_\+m\+::m\+\_\+i (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{i }\end{DoxyParamCaption})}



This function computes the \char`\"{}m\char`\"{} value corresponding the the i-\/th 1e basis element. 


\begin{DoxyParams}{Parameters}
{\em i} & the one-\/electron basis function index. \\
\hline
\end{DoxyParams}
\hypertarget{namespacebasis__m_add42d96237ec46063b0493dc16755382}{}\label{namespacebasis__m_add42d96237ec46063b0493dc16755382} 
\index{basis\+\_\+m@{basis\+\_\+m}!one\+\_\+basis\+\_\+write\+\_\+info@{one\+\_\+basis\+\_\+write\+\_\+info}}
\index{one\+\_\+basis\+\_\+write\+\_\+info@{one\+\_\+basis\+\_\+write\+\_\+info}!basis\+\_\+m@{basis\+\_\+m}}
\subsubsection{\texorpdfstring{one\+\_\+basis\+\_\+write\+\_\+info()}{one\_basis\_write\_info()}}
{\footnotesize\ttfamily subroutine, public basis\+\_\+m\+::one\+\_\+basis\+\_\+write\+\_\+info (\begin{DoxyParamCaption}\item[{character(len=$\ast$), intent(in)}]{filename }\end{DoxyParamCaption})}



Writes a file with information about the one-\/electron basis function. 

The name of the file is given by filename.


\begin{DoxyParams}{Parameters}
{\em filename} & Name of the file where to write the basis details. \\
\hline
\end{DoxyParams}
\hypertarget{namespacebasis__m_aa3a464dd040afd84ea9d4af8c50381af}{}\label{namespacebasis__m_aa3a464dd040afd84ea9d4af8c50381af} 
\index{basis\+\_\+m@{basis\+\_\+m}!sigma\+\_\+i@{sigma\+\_\+i}}
\index{sigma\+\_\+i@{sigma\+\_\+i}!basis\+\_\+m@{basis\+\_\+m}}
\subsubsection{\texorpdfstring{sigma\+\_\+i()}{sigma\_i()}}
{\footnotesize\ttfamily integer function, public basis\+\_\+m\+::sigma\+\_\+i (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{i }\end{DoxyParamCaption})}



Computation of the sigma value corresponding to the i-\/th 1e basis element\+: 0 for spin down basis elements, 1 for spin up elements. 


\begin{DoxyParams}{Parameters}
{\em i} & the one-\/electron basis function index. \\
\hline
\end{DoxyParams}
