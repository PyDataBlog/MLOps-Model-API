drop table if exists users;

-- users: ¼ÇÂ¼ÓÃ»§ÐÅÏ¢
create table users
(
	user_id			serial			primary key,
	user_name		varchar(16),
	user_pw_md5		varchar(32),
	user_type		smallint,
	work_id			integer,
	realname		varchar(40),
	gender			smallint,
	age				smallint
);
-- user_id: ÓÃ»§ID£¬Ê¹ÓÃPostgreSQLµÄserialÀàÐÍÊµÏÖ×ÔÔö
-- user_name: ÓÃ»§Ãû | user_pw_md5: ÃÜÂëµÄMD5Öµ
-- user_type: ÓÃ»§ÀàÐÍ£¬0Îª³¬¼¶¹ÜÀíÔ±£¬1ÎªÆÕÍ¨¹ÜÀíÔ±
-- work_id: ¹¤ºÅ | realname: ÐÕÃû
-- gender: ÐÔ±ð£¬0ÎªÅ®£¬1ÎªÄÐ | age: ÄêÁä

insert into users(user_name, user_pw_md5, user_type, work_id, realname, gender, age) values('root', '14976b0e726f29adc340d45ad30345c8', 0, 777, 'Mike Wallce', 1, 20);
-- ´´½¨³¬¼¶¹ÜÀíÔ±root£¬ÃÜÂëÎª£ºABS0042

drop table if exists incomes;

drop table if exists outgoings;

drop table if exists orders;

drop table if exists books;

-- books: ¼ÇÂ¼Í¼ÊéÐÅÏ¢
create table books
(
	isbn				varchar(13)			primary key,
	title				varchar(100),
	publisher			varchar(100),
	author				varchar(100),
	retail_price		numeric(8, 2),
	stock				integer				default				0
);
-- isbn: Í¼ÊéISBN±àºÅ | title: Í¼Êé±êÌâ | publisher: ³ö°æÉç
-- author: ×÷Õß | retail_price: ÁãÊÛ¼Û | stock: ¿â´æ

create index isbn_index on books(isbn);
-- Îªisbn´´½¨Ë÷Òý

create table orders
(
	order_id			serial				primary key,
	order_time			timestamp,
	isbn				varchar(13)			references books	on delete set null,
	order_price			numeric(8, 2),		
	order_amount		integer,
	order_status		smallint
);
-- order_id: ¶©µ¥ºÅ | order_time: ÏÂµ¥Ê±¼ä
-- isbn: Í¼ÊéISBN±àºÅ£¬ÊÇÒýÓÃbooksµÄÍâ¼ü£¬¼¶ÁªÉ¾³ýÊ±ÉèÎª¿ÕÒÔ±£Áô¶©µ¥ÐÅÏ¢¿É¼û
-- order_price: ¶©¹º¼Û¸ñ | order_amount: ¶©¹ºÊýÁ¿
-- order_status: ¶©µ¥×´Ì¬£¬0ÎªÎ´¸¶¿î£¬1ÎªÒÑ¸¶¿îµ«Í¼ÊéÎ´ÉÏ¼Ü£¬2Îª¶©µ¥Íê³ÉÇÒÍ¼ÊéÒÑÉÏ¼Ü

-- incomes: ¼ÇÂ¼ÂôÊéµÄÊÕÈë
create table incomes
(
	in_id				serial				primary key,
	in_time				timestamp,
	isbn				varchar(13)			references books	on delete set null,
	amount				integer,
	in_total			numeric(8, 2)
);
-- in_id: µ¥Ä¿±àºÅ | in_time: µ¥Ä¿´´½¨Ê±¼ä | isbn: Í¼ÊéISBN±àºÅ
-- amount: Âô³öÊýÄ¿ | in_total: ±¾µ¥Ä¿ÊÕÈë×Ü¶î

-- outgoings: ¼ÇÂ¼Ö§¸¶¶©µ¥µÄÖ§³ö
create table outgoings
(
	out_id				serial				primary key,
	out_time			timestamp,
	order_id			integer				references orders	on delete set null,
	out_total			numeric(8, 2)
);
-- out_id: µ¥Ä¿±àºÅ | out_time: µ¥Ä¿´´½¨Ê±¼ä
-- order_id: ¶ÔÓ¦µÄ¶©µ¥±àºÅ | out_total: ±¾µ¥Ä¿Ö§³ö×Ü¶î