---------------   WARNING   ---------------
-- keep comments outside of sql commands --
-------------------------------------------
----  the order of execution matters   ----
-------------------------------------------

CREATE TABLE IF NOT EXISTS Ek_doc( 
   document INTEGER NOT NULL UNIQUE PRIMARY KEY,
   doc_kind VARCHAR(50) NOT NULL,
   doc_name TEXT NOT NULL,
   doc_inst TEXT NOT NULL,
   doc_num VARCHAR(20),
   doc_date VARCHAR(20),
   doc_act VARCHAR(20),
   dv_danni VARCHAR(20),
   dv_date VARCHAR(20)
) charset=utf8;

-- change ID
CREATE TABLE IF NOT EXISTS Ek_kmet(
   kmetstvo varchar(8) NOT NULL UNIQUE PRIMARY KEY, 
   ekatte CHAR(5) NOT NULL, 
   name varchar(30) NOT NULL
) charset=utf8;

-- chande ID
-- duplicate ekatte values; cannot be UNIQUE
CREATE TABLE IF NOT EXISTS Ek_obst(
   obstina CHAR(5) NOT NULL UNIQUE PRIMARY KEY,
   ekatte CHAR(5) NOT NULL,
   name VARCHAR(25) NOT NULL
) charset=utf8;

-- change ID
--raion == ekatte + /\-\d\d/ like in [00357-01]
CREATE TABLE IF NOT EXISTS Ek_raion(
   raion CHAR(8) NOT NULL UNIQUE PRIMARY KEY,
   name VARCHAR(50) NOT NULL
) charset=utf8;

-- change ID
CREATE TABLE IF NOT EXISTS Ek_reg2(
   region CHAR(4) NOT NULL UNIQUE PRIMARY KEY,
   name VARCHAR(50) NOT NULL
) charset=utf8;

CREATE TABLE IF NOT EXISTS Ek_sobr( 
   ekatte CHAR(5) NOT NULL UNIQUE PRIMARY KEY,
   kind INTEGER NOT NULL,
   name VARCHAR(50) NOT NULL,
   area1 VARCHAR(50)
) charset=utf8;

-- oblast is not UNIQUE
CREATE TABLE IF NOT EXISTS Ek_obl(
   id INTEGER NOT NULL UNIQUE AUTO_INCREMENT PRIMARY KEY,
   oblast CHAR(3) NOT NULL,
   ekatte CHAR(5) NOT NULL,
   name VARCHAR(50) NOT NULL,
   region CHAR(4) NOT NULL,
   FOREIGN KEY(region) REFERENCES Ek_reg2(region)
) charset=utf8;

-- UNIQUE or not
CREATE TABLE IF NOT EXISTS Ek_tsb(
   tsb CHAR(2) NOT NULL UNIQUE PRIMARY KEY,
   name VARCHAR(50) NOT NULL
) charset=utf8;

CREATE TABLE IF NOT EXISTS Sof_rai(
   ekatte CHAR(5) NOT NULL UNIQUE PRIMARY KEY,
   t_v_m VARCHAR(5) NOT NULL,
   name VARCHAR(50) NOT NULL,
   raion CHAR(8) NOT NULL
) charset=utf8;


-- Ek_obl(oblast) is not UNIQUE therefore it isn't a FOREIGN KEY in Ek_atte
-- kmetstvo contains values that do not exist in Ek_kmet(kmetstvo); Ek_kmet(kmetstvo) can't be a foreign key
CREATE TABLE IF NOT EXISTS Ek_atte(
   ekatte CHAR(5) NOT NULL UNIQUE PRIMARY KEY,
   t_v_m VARCHAR(25) NOT NULL,
   name VARCHAR(50) NOT NULL,
   oblast CHAR(3) NOT NULL,
   obstina CHAR(5) NOT NULL,
   kmetstvo CHAR(8) NOT NULL,
   kind INTEGER NOT NULL,
   category INTEGER NOT NULL,
   altitude INTEGER NOT NULL,
   document INTEGER NOT NULL,
   tsb CHAR(2) NOT NULL,
   FOREIGN KEY(obstina) REFERENCES Ek_obst(obstina),
   FOREIGN KEY(document) REFERENCES Ek_doc(document),
   FOREIGN KEY(tsb) REFERENCES Ek_tsb(tsb)
) charset=utf8;









