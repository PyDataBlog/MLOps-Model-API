CREATE PROCEDURE `altaUsuario` (
IN nombrePersona varchar(300),
IN cargoPersona varchar(300),
IN cuentaUsuario varchar(300),
IN passwordUsuario varchar(300),
IN tipoUsuario int,
IN userSession varchar(300))
BEGIN
	DECLARE idUsuarioNuevo INT;
    
	INSERT INTO `vorrat`.`personal`
		(`nombre`,
		`cargo`,
		`tipo`)
	VALUES
		(nombrePersona,
		cargoPersona,
		tipoUsuario);
        
	SET idUsuarioNuevo = (SELECT max(idpersonal) FROM vorrat.personal);
    
	INSERT INTO `vorrat`.`usuario`
		(`idtipoUsuario`,
		`idPersonal`,
		`cuenta`,
		`clave`)
	VALUES
		(tipoUsuario,
		idUsuarioNuevo,
		cuentaUsuario,
		passwordUsuario);
        
	INSERT INTO `vorrat`.`vorrat_teil_bitaco`
		(`idUsuario`,
		`fechaOperacion`,
		`operacion`,
		`fechaLogIn`,
		`fechaLogOut`)
	VALUES
		((SELECT idusuario FROM usuario WHERE cuenta = userSession),
		(SELECT now()),
		1,
		(SELECT curdate()),
		(SELECT curdate()));
END
