-- MySQL Script generated by MySQL Workbench
-- 05/15/15 09:53:05
-- Model: New Model    Version: 1.0
SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema pavII
-- -----------------------------------------------------
CREATE database elaw;
USE elaw;
-- -----------------------------------------------------
-- Table `localidad`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `localidad` (
  `id_localidad` INT NOT NULL AUTO_INCREMENT,
  `nombre` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`id_localidad`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `estado_civil`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `estado_civil` (
  `id_estado_civil` INT NOT NULL AUTO_INCREMENT,
  `nombre` VARCHAR(45) NOT NULL,
  `descripcion` VARCHAR(45) NULL,
  PRIMARY KEY (`id_estado_civil`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `cliente`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `cliente` (
  `id_cliente` INT NOT NULL AUTO_INCREMENT,
  `cuit` INT NOT NULL,
  `apellido` VARCHAR(45) NOT NULL,
  `nombre` VARCHAR(45) NOT NULL,
  `direccion` VARCHAR(45) NOT NULL,
  `referencias` VARCHAR(45) NULL,
  `id_localidad` INT NOT NULL,
  `id_estado_civil` INT NOT NULL,
  `sexo` VARCHAR(45) NOT NULL,
  `saldo_deudor` DOUBLE NOT NULL,
  `fecha_nacimiento` DATE NOT NULL,
  PRIMARY KEY (`id_cliente`),
  UNIQUE INDEX `cuit_UNIQUE` (`cuit` ASC),
  INDEX `localidad_cliente_idx` (`id_localidad` ASC),
  INDEX `estado_civil_cliente_idx` (`id_estado_civil` ASC),
  CONSTRAINT `localidad_cliente`
    FOREIGN KEY (`id_localidad`)
    REFERENCES `localidad` (`id_localidad`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `estado_civil_cliente`
    FOREIGN KEY (`id_estado_civil`)
    REFERENCES `estado_civil` (`id_estado_civil`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `expediente`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `expediente` (
  `id_expediente` INT NOT NULL AUTO_INCREMENT,
  `caratula` VARCHAR(45) NOT NULL,
  `fecha_apertura` DATE NOT NULL,
  `cerrado` TINYINT(1) NOT NULL,
  `numero_judicial` INT NOT NULL,
  `id_cliente` INT NOT NULL,
  `descripcion` VARCHAR(45) NULL,
  PRIMARY KEY (`id_expediente`),
  UNIQUE INDEX `numero_judicial_UNIQUE` (`numero_judicial` ASC),
  INDEX `cliente_expediente_idx` (`id_cliente` ASC),
  CONSTRAINT `cliente_expediente`
    FOREIGN KEY (`id_cliente`)
    REFERENCES `cliente` (`id_cliente`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `tipo_actuacion`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `tipo_actuacion` (
  `id_tipo_actuacion` INT NOT NULL AUTO_INCREMENT,
  `nombre` VARCHAR(45) NOT NULL,
  `descripcion` VARCHAR(45) NULL,
  PRIMARY KEY (`id_tipo_actuacion`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `actuacion`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `actuacion` (
  `id_actuacion` INT NOT NULL AUTO_INCREMENT,
  `id_tipo_actuacion` INT NOT NULL,
  `id_expediente` INT NOT NULL,
  `descripcion` VARCHAR(45) NOT NULL,
  `presencial` TINYINT(1) NOT NULL,
  PRIMARY KEY (`id_actuacion`),
  INDEX `expediente_actuacion_idx` (`id_expediente` ASC),
  INDEX `tipo_actuacion_actuacion_idx` (`id_tipo_actuacion` ASC),
  CONSTRAINT `expediente_actuacion`
    FOREIGN KEY (`id_expediente`)
    REFERENCES `expediente` (`id_expediente`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `tipo_actuacion_actuacion`
    FOREIGN KEY (`id_tipo_actuacion`)
    REFERENCES `tipo_actuacion` (`id_tipo_actuacion`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `entrada_agenda`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `entrada_agenda` (
  `fecha` DATE NOT NULL,
  `hora` TIME NOT NULL,
  `maximo_actuaciones` INT NOT NULL,
  PRIMARY KEY (`fecha`, `hora`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `actuacion_entradas`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `actuacion_entradas` (
  `id_actuacion` INT NOT NULL,
  `fecha_entrada_agenda` DATE NOT NULL,
  `hora_entrada_agenda` TIME NOT NULL,
  `lugar` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`id_actuacion`, `fecha_entrada_agenda`, `hora_entrada_agenda`),
  INDEX `entrada_agenda_actuacionXentrada_idx` (`fecha_entrada_agenda` ASC, `hora_entrada_agenda` ASC),
  CONSTRAINT `actuacion_actuacionXentrada`
    FOREIGN KEY (`id_actuacion`)
    REFERENCES `actuacion` (`id_actuacion`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `entrada_agenda_actuacionXentrada`
    FOREIGN KEY (`fecha_entrada_agenda` , `hora_entrada_agenda`)
    REFERENCES `entrada_agenda` (`fecha` , `hora`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `tipo_documento`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `tipo_documento` (
  `id_tipo` INT NOT NULL AUTO_INCREMENT,
  `nombre` VARCHAR(45) NOT NULL,
  `descripcion` VARCHAR(45) NULL,
  PRIMARY KEY (`id_tipo`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `documento`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `documento` (
  `id_documento` INT NOT NULL AUTO_INCREMENT,
  `nombre` VARCHAR(45) NOT NULL,
  `descripcion` TEXT NULL,
  `path_archivo` VARCHAR(150) NOT NULL,
  `modulo_doc` VARCHAR(45) NOT NULL,
  `fecha_insercion` DATETIME NOT NULL,
  `eliminado` TINYINT(1) NOT NULL,
  `id_tipo` INT NOT NULL,
  `relevancia` INT NULL,
  PRIMARY KEY (`id_documento`),
  UNIQUE INDEX `path_archivo_UNIQUE` (`path_archivo` ASC),
  INDEX `tipo_documento_idx` (`id_tipo` ASC),
  CONSTRAINT `tipo_documento`
    FOREIGN KEY (`id_tipo`)
    REFERENCES `tipo_documento` (`id_tipo`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `actuacion_detalle`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `actuacion_detalle` (
  `actuacion_id` INT NOT NULL,
  `descripcion` TEXT NULL,
  `documento_id` INT NULL,
  INDEX `fk_actuacion_detalle_actuacion1_idx` (`actuacion_id` ASC),
  INDEX `fk_actuacion_detalle_documentos1_idx` (`documento_id` ASC),
  CONSTRAINT `fk_actuacion_detalle_actuacion1`
    FOREIGN KEY (`actuacion_id`)
    REFERENCES `actuacion` (`id_actuacion`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_actuacion_detalle_documentos1`
    FOREIGN KEY (`documento_id`)
    REFERENCES `documento` (`id_documento`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `factura`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `factura` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `fecha` DATETIME NULL,
  `monto_total` DECIMAL(20,2) NULL,
  `expediente_id` INT NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_factura_expediente1_idx` (`expediente_id` ASC),
  CONSTRAINT `fk_factura_expediente1`
    FOREIGN KEY (`expediente_id`)
    REFERENCES `expediente` (`id_expediente`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `factura_detalle`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `factura_detalle` (
  `factura_id` INT NOT NULL,
  `descripcion` VARCHAR(200) NULL,
  `monto` DECIMAL(10,2) NULL,
  `actuacion_id` INT NOT NULL,
  INDEX `fk_factura_detalle_factura1_idx` (`factura_id` ASC),
  INDEX `fk_factura_detalle_actuacion1_idx` (`actuacion_id` ASC),
  CONSTRAINT `fk_factura_detalle_factura1`
    FOREIGN KEY (`factura_id`)
    REFERENCES `factura` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_factura_detalle_actuacion1`
    FOREIGN KEY (`actuacion_id`)
    REFERENCES `actuacion` (`id_actuacion`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `vocabulario`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `vocabulario` (
  `id_vocabulario` INT NOT NULL AUTO_INCREMENT,
  `termino` VARCHAR(45) NOT NULL,
  `cant_doc` INT NOT NULL,
  PRIMARY KEY (`id_vocabulario`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `posteo`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `posteo` (
  `id_posteo` INT NOT NULL AUTO_INCREMENT,
  `vocabulario_id` INT NOT NULL,
  `documento_id` INT NOT NULL,
  `cant_apariciones` INT NOT NULL,
  PRIMARY KEY (`id_posteo`),
  INDEX `vocabulario_posteo_idx` (`vocabulario_id` ASC),
  INDEX `documento_posteo_idx` (`documento_id` ASC),
  CONSTRAINT `vocabulario_posteo`
    FOREIGN KEY (`vocabulario_id`)
    REFERENCES `vocabulario` (`id_vocabulario`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `documento_posteo`
    FOREIGN KEY (`documento_id`)
    REFERENCES `documento` (`id_documento`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
