section .bss 
buf: resb 1024
pos: resd 1
read: resd 1

section        .text                
global        _start

_start: 
        xor ebx, ebx
        mov eax, 3
        mov ecx, buf 
        mov edx, 1024
        int 80h
        test eax, eax 
        js error
        jnz check
        jmp ex
check: 
        mov [read], eax
        mov esi, buf
nl_search:
        lodsb
        cmp al, 0
        je print
        cmp al, 10 
        jne nl_search
        mov [pos], esi
sp_skip: lodsb 
        cmp al, 0
        je print
        cmp al, 20h
        je sp_skip
        cmp al, 34h
        jne nl_search
        lodsb
        cmp al, 0
        je print
        cmp al, 32h
        jne nl_search
sp_skip2: lodsb 
        cmp al, 0
        je print
        cmp al, 20h
        je sp_skip2
        cmp al, 10
        jne nl_search
        jmp print_last

print:  mov ebx, 1
        mov eax, 4
        mov ecx, buf
        mov edx, [read]
        int 80h
        jmp _start


error:

        mov        eax,1
        mov        ebx,1
        int        80h

print_last: 
        mov edx,[pos]
        mov edi, buf
        sub edx, edi
        mov ebx, 1
        mov eax, 4
        mov ecx, buf
        
        int 80h
 
ex:
        mov        eax,1
        mov        ebx,0
        int        80h
        
