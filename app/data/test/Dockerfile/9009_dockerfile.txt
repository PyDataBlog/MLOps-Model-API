FROM golang:1.5.1

MAINTAINER Hamed Ghasemzadeh version: 0.1
RUN apt-get update && apt-get -y install rsync cron
ENV SYNC_HOME=/go/src/git.jiksoot.com/jiksoot/sync/
RUN mkdir -p $SYNC_HOME
RUN go get github.com/tools/godep
COPY . $SYNC_HOME
ADD ./crontab /etc/crontab
RUN chmod g-w /etc/crontab

WORKDIR $SYNC_HOME
RUN godep go build
RUN godep go install


EXPOSE 8080

ENTRYPOINT ["/go/src/git.jiksoot.com/jiksoot/sync/entrypoint.sh"]
