	implicit none
	integer i,n,j
	real*8, dimension(:,:), allocatable :: a,b,c
	real*8, dimension(:),   allocatable :: eig_value
	

	! *** MATRIXES VALUES READING ***

	! Input file allocation
	open (1,file='matrix.dat',status='old')

	! Matrixes dimension reading
	read (1,*) n

	! Matrixes allocation
	allocate (a(n,n))
	allocate (b(n,n))
	allocate (c(n,n))
	allocate (eig_value(n))

	! Matrix values reading
	do i=1,n
	read(1,*) (a(i,j),j=1,n)
	enddo

	close(1)

!_____________________________________________________________________

	b(:,:) = a(:,:)	
	call diag(b,n,eig_value)
	
	
	write(*,'(15f10.5)') (eig_value(i),i=1,n)
	
	c = matmul((transpose(b)),a)
	a = matmul(c,b)	

	do i=1,n
	write(*,'(15f10.5)') (a(i,j),j=1,n)
	enddo

	end
!_____________________________________________________________________

!	Subroutine to call the LAPACK Library
!	IN	a		A matrix
!	IN	n		A matrix dimensions
!	OUT	a		Orthonormal eigenvectors
!	OUT	eig_value 	Eigenvalues

	subroutine diag(a,n,eig_value)
 	implicit none
 	integer n,l,inf
 	real*8  a(n,n),eig_value(n),work(n*(3+n/2))
	
!	Lenght of the array work
 	l=n*(3+n/2)
	
 	call dsyev('V','U',n,a,n,eig_value,work,l,inf)
	if (inf .ne. 0) print *,'Lib error',inf
	return
 	end
