Public Class KB_DETAIL
    Inherits System.Web.UI.Page

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        If IsPostBack Then

        Else

            If IsNothing(Request.QueryString("id")) Then
                Response.Redirect("kb.aspx")
            Else
                'Hit the db and retrieve all listings. 
                Dim strSql As String = "Select * from KB_DETAIL where knowledgebase_id = " & Request.QueryString("id")
                Dim tblResults As DataTable = g_IO_Execute_SQL(strSql, False)

                If tblResults.Rows.Count > 0 Then
                    'build the header
                    If checkUserSessionPrivilege("KBDetail_UpdateArticle") Then
                        litContent.Text &= "<div style=""float: right;""><a href=""NewArticle.aspx?action=update&id=" & Request.QueryString("id") & """>Update</a></div>"
                    End If
                    litContent.Text &= "<h2>" & tblResults.Rows(0)("Title") & "</h2>"
                    litContent.Text &= Server.HtmlDecode(tblResults.Rows(0)("TEXT"))
                    litContent.Text &= "<br><br><div style=""margin-top: 200px;"">Created By: " & tblResults.Rows(0)("user_name") & " (" & tblResults.Rows(0)("CREATOR") & ")"
                    If Not IsDBNull(tblResults.Rows(0)("last_updated_by")) Then
                        litContent.Text &= "<br>Last Updated by " & tblResults.Rows(0)("Last_Updated_By_user_name") & " on " & tblResults.Rows(0)("Last_Updated")
                    End If
                    litContent.Text &= "</div>"
                    litContent.Text &= "<hr style=""margin-top: 50px;"">"
                Else
                    'No entries
                    litContent.Text = "<h3>There are no Articles in the system as this time.</h3>"
                End If
            End If


        End If
    End Sub

End Class