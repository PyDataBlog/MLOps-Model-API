Imports Visomes.MySQL
Imports Visomes.SGV.Core

Public Class TipoObservacaoDoCliente
    Implements ICadastro(Of TipoObservacaoDoCliente)
    Private idValue As Integer
    Private descricaoValue As String
    Private cadastroValue As Date
    Private usuarioValue As Usuario
    Private statusValue As Boolean = True

#Region "Property"

    Public Property ID() As Integer Implements ICadastro(Of Visomes.SGV.TipoObservacaoDoCliente).ID
        Get
            Return idValue
        End Get
        Set(ByVal value As Integer)
            idValue = value
        End Set
    End Property

    Public Property Usuario() As Usuario Implements ICadastro(Of Visomes.SGV.TipoObservacaoDoCliente).Usuario
        Get
            Return usuarioValue
        End Get
        Set(ByVal value As Usuario)
            usuarioValue = value
        End Set
    End Property

    Public Property Descricao() As String Implements ICadastro(Of Visomes.SGV.TipoObservacaoDoCliente).Descricao
        Get
            Return descricaoValue
        End Get
        Set(ByVal value As String)
            descricaoValue = value
        End Set
    End Property

    Public Property Status() As Boolean Implements ICadastro(Of Visomes.SGV.TipoObservacaoDoCliente).Status
        Get
            Return statusValue
        End Get
        Set(ByVal value As Boolean)
            statusValue = value
        End Set
    End Property

    Public Property Cadastro() As Date Implements ICadastro(Of Visomes.SGV.TipoObservacaoDoCliente).Cadastro
        Get
            Return cadastroValue
        End Get
        Set(ByVal value As Date)
            cadastroValue = value
        End Set
    End Property

#End Region

    Public Sub New(ByVal id As Integer)
        Me.idValue = id
        CarregaDados()
    End Sub

    Public Sub New()
    End Sub

    Private Sub CarregaDados()
        Dim idUsuario As Integer = 0
        Connection.ConnectionMysql()
        MyData = DML.Select("*", "tipo_obs_cliente t", "idTipoObsCliente = " & Me.idValue & "")
        If MyData.Read() Then
            idUsuario = MyData.GetInt32(1)
            Me.descricaoValue = MyData.GetString(2)
            Me.statusValue = MyData.GetBoolean(3)
            Me.cadastroValue = MyData.GetDateTime(4)
        End If
        Connection.DisconnectMySQL()
        MyData.Dispose()
        If idUsuario > 0 Then Me.usuarioValue = New Usuario(idUsuario)
    End Sub

    Public Function Commit() As Boolean Implements ICadastro(Of Visomes.SGV.TipoObservacaoDoCliente).Commit
        If Me.idValue = 0 Then
            Return DML.Insert("tipo_obs_cliente", "descricao,dtCadastro,status,idUsuario", "'" & Me.descricaoValue & "',CURRENT_DATE()," & Me.statusValue & "," & Me.usuarioValue.ID & "")
        Else
            Return DML.Update("tipo_obs_cliente", "descricao='" & Me.descricaoValue & "',dtCadastro=CURRENT_DATE(),status=" & Me.statusValue & ",idUsuario=" & Me.usuarioValue.ID & "", "idTipoObsCliente=" & Me.idValue & "")
        End If
    End Function

    Public Function GetLista() As Object() Implements ICadastro(Of Visomes.SGV.TipoObservacaoDoCliente).GetLista
        Return Core.FeedsLists("ts.descricao", "tipo_obs_cliente ts  ", "ts.status = 1 ")
    End Function

    Public Function CarregaCadastros() As Generic.List(Of TipoObservacaoDoCliente) Implements ICadastro(Of Visomes.SGV.TipoObservacaoDoCliente).CarregaCadastros
        Dim lista As New Generic.List(Of TipoObservacaoDoCliente)
        Dim listaID As New Generic.List(Of Integer)
        Connection.ConnectionMysql()
        Core.MyData = DML.Select("idTipoObsCliente", "tipo_obs_cliente", "status=1")
        While MyData.Read
            listaID.Add(MyData.GetInt32(0))
        End While
        Connection.DisconnectMySQL()
        Core.MyData.Dispose()
        For Each num As Integer In listaID
            lista.Add(New TipoObservacaoDoCliente(num))
        Next
        Return lista
    End Function

    Public Function Inativar() As Boolean Implements ICadastro(Of Visomes.SGV.TipoObservacaoDoCliente).Inativar
        Return DML.Update("tipo_obs_cliente", "status=0", "idTipoObsCliente=" & Me.idValue & "")
    End Function

    Public Function Delete() As Boolean Implements ICadastro(Of Visomes.SGV.TipoObservacaoDoCliente).Delete
        Return DML.Delete("tipo_obs_cliente", "idTipoObsCliente=" & Me.idValue & "")
    End Function

    Public Shared Function GetIDByDescricao(ByVal str As String) As Integer
        Dim id As Integer = 0
        Connection.ConnectionMysql()
        MyData = DML.Select("idTipoObsCliente", "tipo_obs_cliente", "descricao = '" & str & "'")
        If MyData.Read() Then id = MyData.GetInt32(0)
        Connection.DisconnectMySQL()
        MyData.Dispose()
        Return id
    End Function

    Public Shared Function GetDescricaoByID(ByVal id As Integer) As String
        Dim descricao As String = String.Empty
        Connection.ConnectionMysql()
        Core.MyData = DML.Select("descricao", "tipo_obs_cliente", "idTipoObsCliente = '" & id & "'")
        If Core.MyData.Read() Then descricao = Core.MyData.GetString(0)
        Connection.DisconnectMySQL()
        Core.MyData.Dispose()
        Return descricao
    End Function

    Public Overrides Function ToString() As String
        Return Me.descricaoValue
    End Function
End Class
