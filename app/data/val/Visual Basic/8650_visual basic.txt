Public Class EditTraceFormOneEach
    Private _main As Main
    Private _tmpTrace As AnalyzerTraceObject
    Private _tmpAzr As AnalyzerObject
    Private _traceNumber As Integer
    Private _scanForm As EditScanForm

    Public Sub New(ByRef aMain As Main, ByRef aAzr As AnalyzerObject, ByRef aTrace As AnalyzerTraceObject, ByVal trcNum As Integer, Optional ByVal existing As Boolean = True, Optional ByRef scanForm As EditScanForm = Nothing)
        Me._main = aMain
        Me._tmpTrace = aTrace
        Me._tmpAzr = aAzr
        Me._traceNumber = trcNum

        ' This call is required by the designer.
        InitializeComponent()

        ' Add any initialization after the InitializeComponent() call.
        'populate the detectors combo box from the enum defined
        Me.cmbBxDetectorType.DataSource = System.Enum.GetValues(GetType(Enumerations.TraceDetectorType))
        'populate the trace type combo box from the enum defined
        Me.cmbBxTraceType.DataSource = System.Enum.GetValues(GetType(Enumerations.TraceTypes))

        'set up with existing values
        If existing = True Then
            Me.setUpBoxes()
        End If

        ' Add any initialization after the InitializeComponent() call.
        Me.Text = "Trace " & Me._traceNumber
        Me.StartPosition = FormStartPosition.Manual
        Me.Left = 300
        Me.Top = 300
        Me.Visible = True

    End Sub

    Public Sub SetUpBoxes()
        Try
            Me.cmbBxDetectorType.SelectedItem = Me._tmpTrace.getDetectorType
            Me.cmbBxTraceType.SelectedItem = Me._tmpTrace.getTraceType
            If Me._tmpTrace.getDownLoadState = True Then
                Me.cmbBxDwnldDefaultState.Text = "TRUE"
            Else
                Me.cmbBxDwnldDefaultState.Text = "FALSE"
            End If

            If Me._tmpTrace.getClearState = True Then
                Me.cmbBxClrState.Text = "TRUE"
            Else
                Me.cmbBxClrState.Text = "FALSE"
            End If
            Me.ButtonDelete.Visible = True
        Catch ex As Exception
            MsgBox("Unable to set up boxes from analyzer trace: " & Me._traceNumber)
        End Try
    End Sub

    Private Sub btnFinished_Click(sender As System.Object, e As System.EventArgs) Handles btnFinished.Click
        Try

        With Me._tmpTrace
            .getDetectorType = Me.cmbBxDetectorType.SelectedItem
            .getTraceType = Me.cmbBxTraceType.SelectedItem
                .getDownLoadState = Me.cmbBxDwnldDefaultState.SelectedItem
                .getClearState = Me.cmbBxClrState.SelectedItem
            End With

        Me.Visible = False
        Me.Close()
            'Me.main.MissionController.editDeleteExistingMissionForm.EditSurveyController.EditSurveyForm.EditScanForm.updateTotalNumberOfTraces()
            Try
                Me._main.MissionController.editDeleteExistingMissionForm.EditTransporterController.EditTransporterForm.editSurveyForm.EditScanForm.updateTotalNumberOfTraces()
            Catch ex As Exception
            End Try
        Catch ex As Exception
            MsgBox("Unable to save analyzer trace from set up boxes : " & Me._traceNumber)
        End Try
    End Sub

    Private Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles Button1.Click
        Me.Visible = False
        Me.Close()
    End Sub

    Private Sub ButtonDelete_Click(sender As System.Object, e As System.EventArgs) Handles ButtonDelete.Click
        'Me.main.missionObj.getSearchAnalyzerClass.getAnalyzerSettings.getAnalyzerTraceObj = Me.main.removeArrayMember(Me.main.missionObj.getSearchAnalyzerClass.getAnalyzerSettings.getAnalyzerTraceObj, Me.main.missionObj.getSearchAnalyzerClass.getAnalyzerSettings.getAnalyzerTraceObj(Me.traceNumber), GetType(AnalyzerTraceObject))
        'Me.main.missionObj.getSearchAnalyzerClass.getAnalyzerSettings.getnumberTracesDefined -= 1
        Me._tmpAzr.getAnalyzerTraceObj = Me._main.removeArrayMember(Me._tmpAzr.getAnalyzerTraceObj, Me._tmpAzr.getAnalyzerTraceObj(Me._traceNumber), GetType(AnalyzerTraceObject))
        Me._tmpAzr.getnumberTracesDefined -= 1
        Try
            Me._main.MissionController.editDeleteExistingMissionForm.EditSurveyController.EditSurveyForm.EditScanForm.updateTotalNumberOfTraces()
        Catch ex As Exception
            If Me._scanForm Is Nothing Then
            Else
                Me._scanForm.updateTotalNumberOfTraces()
            End If
        End Try

        Try
            If Me._main.editSearchAzrForm Is Nothing Then
            Else
                Me._main.editSearchAzrForm.cmbBxTraces.Items.Remove(Me._tmpAzr.getnumberTracesDefined + 1)
                Me._main.editSearchAzrForm.cmbBxTraces.Text = ""
            End If
        Catch ex As Exception

        End Try

        Me.Close()

    End Sub
End Class