Public Class formBuscar

    Protected buscarNombre As String

    Private Sub btnBuscar_Click(sender As Object, e As EventArgs) Handles btnBuscar.Click

        lblNameResult.Text = "Nombre:"
        lblApellidoResult.Text = "Apellidos"
        lblCodigoResult.Text = "Codigo:"
        lblCursoResult.Text = "Curso:"
        lblTlfResult.Text = "Teléfono"
        lblEmailResult.Text = "Email:"


        If IsNothing(alumnosArray) Then
            MsgBox("No hay alumnos", vbExclamation)
        Else

            Dim buscar As Boolean
            Dim buscarNombre As String = txtBuscarNombre.Text()

            If buscarNombre = "" Then
                MsgBox("Introduzca un nombre", vbExclamation)
            Else
                For Each Str As Alumno In alumnosArray
                    If Str.nomAlum = buscarNombre Then
                        buscar = True
                        txtNombre.Text = Str.nomAlum
                        txtApellidos.Text = Str.apellAlum
                        txtCodigo.Text = Str.codAlumno
                        txtCurso.Text = Str.cursoAlum
                        txtTelefono.Text = Str.telfAlum
                        txtEmail.Text = Str.emailAlum
                        Exit For
                    Else
                        buscar = False
                    End If
                Next
                If buscar = False Then
                    MsgBox("Alumno no encontrado", vbExclamation)
                End If
            End If
        End If
    End Sub

    Private Sub btnActualizar_Click(sender As Object, e As EventArgs) Handles btnActualizar.Click

        Dim buscarNombre As String = txtBuscarNombre.Text()
        Dim actualizar As Boolean


        If buscarNombre = "" Then
            MsgBox("Introduzca un nombre", vbExclamation)
        Else
            For contador As Integer = 0 To alumnosArray.Length - 1
                If alumnosArray(contador).nomAlum = buscarNombre Then
                    alumnosArray(contador).nomAlum = txtNombre.Text
                    alumnosArray(contador).apellAlum = txtApellidos.Text
                    alumnosArray(contador).telfAlum = txtTelefono.Text
                    alumnosArray(contador).emailAlum = txtEmail.Text
                    alumnosArray(contador).cursoAlum = txtCurso.Text
                    actualizar = True
                End If
            Next
        End If

        If actualizar = True Then
            MsgBox("Usuario actualizado con exito")
        End If


    End Sub

    Private Sub btnSalir_Click(sender As Object, e As EventArgs) Handles btnSalir.Click
        Me.Hide()
        formMenu.Show()
    End Sub
End Class