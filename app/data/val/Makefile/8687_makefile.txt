SRCDIR=src
INCDIR=include
OUTDIR=bin
WINOUTDIR=bin
WINOBJDIR=wintmp
OBJDIR=lintmp

SRC=fieldstatus.cpp game.cpp main.cpp player.cpp ship.cpp shot.cpp table.cpp field.cpp ai.cpp user.cpp
OBJ=$(SRC:.cpp=.o)
OPTIONS=-Wall -Wextra -std=c++11
HEADERS=$(INCDIR)/*.h
LIBS=
WINLIBS=

ifeq ($(OS),Windows_NT)
  runnable=win
else
  runnable=lin
endif

.PHONY: all debug clean win lin

Debug: $(runnable)
	@echo DEBUG \($(runnable)\)

win: $(WINOUTDIR)/run.exe
lin: $(OUTDIR)/run

release:
	echo Not implemented.

$(WINOUTDIR)/run.exe: $(addprefix $(WINOBJDIR)/,$(OBJ))
	@echo Creating executable...
	$(CXX) -g -Wall -Wextra $^ -o $(WINOUTDIR)/run.exe $(WINLIBS) $(LIBDIR)
	@echo Done.

$(OUTDIR)/run: $(addprefix $(OBJDIR)/,$(OBJ))
	@echo Creating executable...
	$(CXX) -g -Wall -Wextra $^ -o $(OUTDIR)/run $(LIBS)
	@echo Done.

$(OBJDIR)/%.o: $(SRCDIR)/%.cpp $(HEADERS)
	@echo Compiling $@...
	$(CXX) -g -c $(OPTIONS) -I$(INCDIR) -o $@ $<
	@echo Done.

$(WINOBJDIR)/%.o: $(SRCDIR)/%.cpp $(HEADERS)
	@echo Compiling $@...
	$(CXX) -g -c $(OPTIONS) -I$(INCDIR) -o $@ $<
	@echo Done.

clean%:
	rm -f $(WINOBJDIR)/*
	rm -f $(OBJDIR)/*
	rm -f $(WINOUTDIR)/run.exe
	rm -f $(WINOUTDIR)/run
