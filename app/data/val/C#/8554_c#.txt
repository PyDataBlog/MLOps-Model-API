namespace Dike.Web
{
    using System;

    /// <summary>
    /// Provides some helper methods for HTTP verbs.
    /// </summary>
    public static class HttpVerbHelper
    {
        #region Methods

        /// <summary>
        /// Converts the specified HTTP method to a <see cref="HttpVerbs"/> value.
        /// </summary>
        /// <param name="httpMethod">The HTTP method.</param>
        /// <returns>The converted <see cref="HttpVerbs"/> value.</returns>
        /// <exception cref="InvalidOperationException">Unknown HTTP METHOD: <paramref name="httpMethod"/></exception>
        public static HttpVerbs Convert(string httpMethod)
        {
            switch (httpMethod.ToUpperInvariant())
            {
                case "GET":
                    return HttpVerbs.Get;

                case "POST":
                    return HttpVerbs.Post;

                case "PUT":
                    return HttpVerbs.Put;

                case "DELETE":
                    return HttpVerbs.Delete;

                case "OPTIONS":
                    return HttpVerbs.Options;

                case "TRACE":
                    return HttpVerbs.Trace;

                case "HEAD":
                    return HttpVerbs.Head;

                case "PATCH":
                    return HttpVerbs.Patch;

                default:
                    throw new InvalidOperationException($"Unknown HTTP METHOD: {httpMethod}");
            }
        }

        #endregion Methods
    }
}