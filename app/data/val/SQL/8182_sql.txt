DROP TABLE IF EXISTS order_entry;
DROP TABLE IF EXISTS orders;
DROP TABLE IF EXISTS customer;

DROP TABLE IF EXISTS product;
DROP TABLE IF EXISTS pstate;
DROP TABLE IF EXISTS message;
DROP TABLE IF EXISTS msubject;


CREATE TABLE IF NOT EXISTS customer (
  id          BIGINT(8) UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,
  crt_time    DATETIME,
  mod_time    DATETIME,
  name        VARCHAR(100),
  address     VARCHAR(255),
  email       VARCHAR(100),
  phone       VARCHAR(20),
  INDEX (name)
) engine=InnoDB;





CREATE TABLE IF NOT EXISTS pstate (
  id          INT(4) UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,
  crt_time    DATETIME,
  mod_time    DATETIME,
  name        VARCHAR(80),
  INDEX (name)
) engine=InnoDB;


CREATE TABLE IF NOT EXISTS product (
  id          BIGINT(8) UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,
  crt_time    DATETIME,
  mod_time    DATETIME,
  code        VARCHAR(50),
  description TEXT,
  inventory   INT(4),
  price       DECIMAL(10,2),
  pstate_id   INT(4) UNSIGNED NOT NULL,
  FOREIGN KEY (pstate_id) REFERENCES pstate (id),
  INDEX (code)
) engine=InnoDB;


CREATE TABLE IF NOT EXISTS msubject (
  id          INT(4) UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,
  crt_time    DATETIME,
  mod_time    DATETIME,
  name       VARCHAR(50),
  INDEX (name)
) engine=InnoDB;


CREATE TABLE message (
  id          BIGINT(8) UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,
  crt_time    DATETIME,
  mod_time    DATETIME,
  name        VARCHAR(100),
  message     TEXT,
  email       VARCHAR(100),
  msubject_id INT(4) UNSIGNED NOT NULL,
  FOREIGN KEY (msubject_id) REFERENCES msubject (id),
  INDEX (name)
) engine=InnoDB;



CREATE TABLE IF NOT EXISTS orders (
  id          BIGINT(8) UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,
    crt_time    DATETIME,
    mod_time    DATETIME,
    remark      TEXT,
    total       DECIMAL(10,2),
    customer_id BIGINT(8) UNSIGNED NOT NULL,
    FOREIGN KEY (customer_id) REFERENCES customer(id)
) engine=InnoDB;

CREATE TABLE IF NOT EXISTS order_entry (
  id          BIGINT(8) UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,
  quantity    INT(4) NOT NULL,
  price       DECIMAL(10,2),
  amount      DECIMAL(10,2),
  order_id    BIGINT(8) UNSIGNED NOT NULL,  
  product_id  BIGINT(8) UNSIGNED NOT NULL,
  FOREIGN KEY (order_id) REFERENCES orders (id),
  FOREIGN KEY (product_id) REFERENCES product (id)
) engine=InnoDB;  