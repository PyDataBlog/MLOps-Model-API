#!/usr/bin/env zsh
#

set -euo pipefail
trap "echo 'error: Script failed: see failed command above'" ERR

#### ffmpeg CRF param:
#
# See https://unix.stackexchange.com/questions/28803/how-can-i-reduce-a-videos-size-with-ffmpeg
#     http://www.mpabo.com/2014/12/14/ffmpeg-and-x264-encoding-guide/
#
# Unless you're looking for a specific bitrate, I'd recommend the -crf option.
#
# This is the most commonly used for  x264 encoding: http://slhck.info/articles/crf
#
# In short: a CRF of 23 would make "DVD" quality movie (~700MB-1GB) and lower CRF values would be higher quality (larger files).

# $1: file name
# $2: compress radio
ffmpeg_compress_video(){
  local filename=$(basename "$1")
  local extension="${filename##*.}"
  ffmpeg -i $1 -vcodec libx264 -crf $2 $filename.compressed.$extension
}

# TODO make it zsh plugin
