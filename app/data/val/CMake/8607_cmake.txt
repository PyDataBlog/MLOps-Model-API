include (ExternalProject)

set(MISSING_DEPENDENCIES)

# forward relevant command line args to sub-builds
set(USER_CMAKE_ARGS
    -DCMAKE_PREFIX_PATH=${CMAKE_PREFIX_PATH}
    -DCMAKE_MODULE_PATH=${CMAKE_MODULE_PATH}
)

include(cmake/Protobuf.cmake)
include(cmake/c-ares.cmake)
include(cmake/OpenSSL.cmake)
include(cmake/gRPC.cmake)

ExternalProject_Add(PubSubCppAPI
    DEPENDS ${MISSING_DEPENDENCIES}
    SOURCE_DIR ${PROJECT_SOURCE_DIR}

    CMAKE_ARGS -DBUILD_DEPENDENCIES=OFF
               ${USER_CMAKE_ARGS}
               -DCMAKE_PREFIX_PATH=${CMAKE_BINARY_DIR}/thirdparty
    INSTALL_COMMAND ""
    BINARY_DIR ${CMAKE_BINARY_DIR}
)
