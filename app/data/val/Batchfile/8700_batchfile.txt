@echo off
set a=MIA.DLL
set c=0
for %%x in (%*) do set /a c+=1
if NOT %c%==0 (
  set a=%1
)
echo Started signing %a%.
rem   if not exist MIA.cer (
rem   makecert -n "CN=MIA.DLL,O=Luismark,L=Cascais,S=Lisboa,C=Portugal" -iv ..\luissign.pvk -ic ..\luissign.cer -m 8 -eku 1.3.6.1.5.5.7.3.3 -cy end -sv MIA.pvk -a sha512 -len 4096 MIA.cer
rem   pvk2pfx -pvk MIA.pvk -spc MIA.cer -pfx MIA.pfx
rem   )
rem   echo Certificate generated!
signtool sign /v /f %userprofile%\sign2017.pfx /tr http://sha256timestamp.ws.symantec.com/sha256/timestamp /td sha256 /fd sha512 %a%
echo SHA-512 signing complete.
signtool sign /as /v /f %userprofile%\sign2017.pfx /tr http://sha256timestamp.ws.symantec.com/sha256/timestamp /td sha256 /fd sha256 %a%
echo SHA-256 signing complete.
rem   del MIA.pvk
rem   del MIA.pfx
rem   echo Private keys deleted!
