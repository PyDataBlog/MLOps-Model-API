##
# startupScript.ps1
#
# Copyright(c) Ethan Goh
# MIT Licensed
##

Param(
   [Parameter(Mandatory=$True,Position=1)]
   [string]$shellRoot)

function Copy-Files
{
    [CmdletBinding()]
    param(
        [string]
        [Parameter(Mandatory=$true)]
        $shellRoot)
    
    # copy env 
    robocopy $PSScriptRoot $shellRoot env.ps1
    robocopy /MIR $PSScriptRoot\modules $shellRoot\modules
}

function Create-DesktopShortcut 
{
    [CmdletBinding()]
    param(
        [string]
        [Parameter(Mandatory=$true)]
        $shellRoot)

    # Create Desktop Shortcut
    $w = New-Object -ComObject WScript.Shell
    $l = $w.CreateShortcut("$home\Desktop\shell1.lnk")
    $l.TargetPath = "%SystemRoot%\system32\WindowsPowerShell\v1.0\powershell.exe"
    $l.Arguments = "-noexit ""ipmo $shellRoot\env.ps1"""
    $l.Hotkey = "CTRL+ALT+1"
    $l.Save()

    # Create Desktop Shortcut2
    $w = New-Object -ComObject WScript.Shell
    $l = $w.CreateShortcut("$home\Desktop\shell2.lnk")
    $l.TargetPath = "%SystemRoot%\system32\WindowsPowerShell\v1.0\powershell.exe"
    $l.Arguments = "-noexit ""ipmo $shellRoot\env.ps1"""
    $l.Hotkey = "CTRL+ALT+2"
    $l.Save()
}

# START!
Copy-Files $shellRoot
Create-DesktopShortcut $shellRoot