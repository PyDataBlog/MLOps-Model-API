<# 
--=======================================================================
Name:  Abdul Hannan Ijaz
Date:  2018-1-22
Desc:  Call the Web Service URL for report generation
--=======================================================================
.Steps
1: Get list of all jobs which are have same command and are in following states 'Completed','Failed','stopped'
2: Remove all these jobs to free resources
3: Call the web request as job so that no time out issue happens
#>





Get-job | ? {$_.State -iin ('Completed','Failed','Stopped') -and $PSItem.Command -like ("Invoke-WebRequest*")} |Remove-Job


#Calling HTTP Request as job

Start-Job -ScriptBlock{Invoke-WebRequest -Uri "https://xmk-dev.ricompass.com/api/ReportAPI/GenerateReportAndEmail" -Method Get -UseBasicParsing  -DisableKeepAlive -TimeoutSec 30} 


