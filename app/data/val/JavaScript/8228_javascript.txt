'use strict';

/*
 * Regex
 */
var regex = {
  facebookPattern: /(?:https?:\/\/)?(?:[\w\-]+\.)?facebook\.com\/(?:(?:\w)*#!\/)?(?:pages\/)?(?:[\w\-]*\/)*([\w\-\.]*)/, // jshint ignore:line
  facebookPluginPattern: /.*%2F(\w+?)&/
};


module.exports = {
  /**
   * Returns the page id for a given URL
   *   e.g. : https://www.facebook.com/my_page_id => my_page_id
   *          http://www.facebook.com/pages/foo/Bar/123456 => 123456
   *
   * @param  String     URL   FacebookURL
   * @return Page ID
   */
  getPageId: function (url) {
    if (typeof url !== 'string') {
      return null;
    }
    var match = url.replace(/\/$/, '').match(regex.facebookPattern);

    if (match) {
      var short_url = match[0],
          id        = match[1];

      if (/plugins/.test(short_url)) {
        var likeMatch = regex.facebookPluginPattern.exec(match.input);
        if (likeMatch) { return likeMatch[1]; }
      } else {
        return id;
      }
    }

    return null;
  }
};
