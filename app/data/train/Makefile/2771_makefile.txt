PREFIX ?= /usr/local
MANPREFIX ?= $(PREFIX)/man

BIN = validatehtml

install:
	install -d $(DESTDIR)$(PREFIX)/bin
	install -m 755  $(BIN) $(DESTDIR)$(PREFIX)/bin
	install -d $(DESTDIR)$(MANPREFIX)/man1
	install -m 444 $(BIN).1 $(DESTDIR)$(MANPREFIX)/man1

uninstall:
	rm -f $(DESTDIR)$(PREFIX)/bin/$(BIN)
	rm -f $(DESTDIR)$(MANPREFIX)/man1/$(BIN).1

setPermissions:
	@command -v git > /dev/null && git --git-dir=.git rev-parse 2>/dev/null ||\
	(chmod +x $(BIN) && chmod +x $(BIN)_test)

unsetPermissions:
	@command -v git > /dev/null && git --git-dir=.git rev-parse 2>/dev/null ||\
	(chmod -x $(BIN) && chmod -x $(BIN)_test)

runTest:
	@./$(BIN)_test

test: setPermissions runTest unsetPermissions
