/*
Nihonium Engine
This file is licensed under the terms of the MIT License.
See LICENCE.txt for the full licence.
*/

#include "../common/object.h"
#include "../common/screen.h"
#include "../windows/windows_filesystem.h"
#include "../windows/windows_input.h"
#include "../windows/windows_audio.h"

int main(int argc, char** argv) {

  filesystem::instance = new filesystem::WindowsFilesystem();
  input::instance = new input::WindowsInput();
  audio::instance = new audio::WindowsAudio();
  audio::instance->init(nullptr);
  audio::BaseMusic* music = audio::instance->new_music("resources/music/music.ogg"); // TODO: This is a temporary testing feature.
  audio::instance->play_music(music);

  screen::init();

  object::load_scene("resources/scenes/main.lua");

  while (!screen::should_close) {
    double frame_time = screen::get_frame_time();
    object::update(frame_time, object::root);
    screen::end_frame();
  }

  screen::uninit();

  return 0;

}