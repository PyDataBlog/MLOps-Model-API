# -*- coding: utf-8 -*-
from tg.configuration import AppConfig, config
from tg import request
from pollandsurvey import model
from tgext.pyutilservice import Utility
import logging
log = logging.getLogger(__name__)

from tgext.pylogservice import LogDBHandler



class InterfaceWebService(object):

    def __init__(self):
        self.modules ='INTERFACESERVICE.WEBSERVICE'
        
        dh = LogDBHandler( config=config,request=request)
        log.addHandler(dh)
        self.utility = Utility()
        
    def mapVoterUser(self, voter):
        """
        Check Voter and User in table sur_member_user is Empty will create again.
        if not will pass. 

        Keyword arguments:
        voter -- Object Voter 
        """
        self.memberUser = model.MemberUser();
        try:
            if voter:
                user = model.User.by_email_address(voter.email)
                if user :
                    self.memberUser = model.MemberUser.getByUserIdandVoter(user.user_id, voter.id_voter)
                    if self.memberUser is None:
                        self.memberUser = model.MemberUser();
                        self.memberUser.user_id = user.user_id
                        self.memberUser.id_voter = voter.id_voter
                        self.memberUser.save()
                del user
        except Exception as e:
            log.error("mapVoterUser : %s" %e, extra=extraLog(modules=self.modules));  
            
        return self.memberUser;