package watcher

func (w *Watcher) webhookPolling() {
	defer w.syncWg.Done()

	if w.once {
		return
	}

	errCh := make(chan error, 1)
	// Passing errCh instead of w.ErrCh to better handle watcher termination
	// since the caller can't determine what type of error it receives from watcher
	go w.ListenAndServe(errCh)

	for {
		select {
		case err := <-errCh:
			w.ErrCh <- err
		case <-w.rcvDoneCh:
			return
		}
	}
}
