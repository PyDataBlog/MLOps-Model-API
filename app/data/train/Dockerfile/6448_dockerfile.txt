# bitgandtter webimage
FROM        ubuntu:15.04

# basic env fix
ENV         TERM xterm

# install packages
RUN         apt-get update && apt-get dist-upgrade -y
RUN         apt-get install -y apt-utils
RUN         apt-get install -y htop nano curl git
RUN         apt-get install -y nginx php5-common php5-cli php5-fpm php5-mcrypt php5-apcu php5-gd php5-imagick \
            php5-curl php5-intl php5-mysql php5-mongo

RUN         curl -sS https://getcomposer.org/installer | php && mv composer.phar /usr/local/bin/composer
RUN         curl -LsS http://symfony.com/installer -o /usr/local/bin/symfony && chmod a+x /usr/local/bin/symfony

# configure services
ADD         nginx.conf /etc/nginx/
ADD         src.conf /etc/nginx/sites-available/src.conf
ADD         src.ini /etc/php5/fpm/conf.d/
ADD         src.ini /etc/php5/cli/conf.d/
ADD         pool.conf /etc/php5/fpm/pool.d/

RUN         ln -s /etc/nginx/sites-available/src.conf /etc/nginx/sites-enabled/src
RUN         rm /etc/nginx/sites-enabled/default

# mount
VOLUME      /var/www
WORKDIR     /var/www

EXPOSE      80

CMD         service php5-fpm restart && nginx
