FROM debian:jessie

MAINTAINER Maksim Y. Baranov "maxim.baranov@simbirsoft.com"

ENV DEBIAN_VERSION jessie

ENV PHP_UPLOAD_MAX_FILESIZE=64M
ENV PHP_MAX_INPUT_VARS=2000

ENV PMA_URL https://www.phpmyadmin.net/downloads/phpMyAdmin-latest-all-languages.tar.gz

RUN	apt-get update && \
	apt-get install --no-install-recommends --no-install-suggests -y \
		ca-certificates \
		php5-cli \
		php5-mysql \
		php5-gd \
		php5-curl \
		php5-xcache \
		php5-json \
		php5-mcrypt \
		curl && \
	apt-get clean && \
	rm -rf /var/lib/apt/lists/*

RUN mkdir -p /srv/www/ && \
	curl --location ${PMA_URL} | tar xzf - && \
	mv phpMyAdmin* /srv/www/pma && \
	rm -rf /srv/www/pma/js/jquery/src/ /srv/www/pma/examples /srv/www/pma/po/

COPY conf/config.inc.php /srv/www/pma/
COPY conf/run.sh /run.sh
RUN chmod u+rwx /run.sh

EXPOSE 80

ENTRYPOINT ["/run.sh"]