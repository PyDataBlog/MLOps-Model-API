;
;	HSP help managerp HELP\[Xt@C
;	(æªªu;vÌsÍRgÆµÄ³êÜ·)
;

%type
g£½ß
%ver
3.3
%note
llmod3.hspðCN[h·éBKvÉ¶Äabout.hsp,msgdlg.hsp,multiopen.hsp,console.hsp,unicode.hsp,dragdrop.hsp,input.hspðCN[h·é

%date
2009/08/01
%author
tom
%dll
llmod3
%url
http://www5b.biglobe.ne.jp/~diamond/hsp/hsp2file.htm


%index
about
vOÌo[Wð\¦·é_CAOðì¬
%group
g£üoÍ§ä½ß
%prm
"s1","s2"
s1 : AvP[V¼ªüÁ½¶ñÏÜ½Í¶ñ
s2 : »ìÒ¼ªüÁ½¶ñÏÜ½Í¶ñ

%inst
vOÌo[Wð\¦·éÈÇÉgíêé_CAOð\¦µÜ·B
AvP[V¼s1ð"my.exeÌÊÞ°¼Þ®Ýîñ#my.exe ver 1.00"
Ìæ¤É#ÅæØéÆ'Microsoft my.exe ver 1.00'Æ¢¤\¦ªÁíèÜ·B


%index
msgdlg
g£dialog(type 0`3 )
%group
IuWFNg§ä½ß
%prm
"s1","s2",n3,n4
s1 : bZ[WªüÁ½¶ñÏÜ½Í¶ñ
s2 : ^CgªüÁ½¶ñÏÜ½Í¶ñ
n3 : ^Cv
n4 : ACR^Cv

%inst
HSPÌdialog½ßÌg£ÅÅ·B
^p
^Cv
 0 Ok
 1 Ok ·¬Ý¾Ù
 2 ~@Äs@³
 3 Í¢@¢¢¦@·¬Ý¾Ù
 4 Í¢@¢¢¦
 5 ÄJs ·¬Ý¾Ù
^
ACR^Cv
 0 ACR³µ
 1 G[(x)
 2 NGX`}[N(?)
 3 x(!)
 4 îñ(i)
 5 EXEªÁÄ¢éACR
^
±Ì½ßðÄÑoµ½ãÌstatÌl
l Ið³ê½{^
 1 Ok
 2 ·¬Ý¾Ù
 3 ~
 4 Äs
 5 ³
 6 Í¢
 7 ¢¢¦
-1 G[­¶
^p
^CvÉÈºÌlðÁ¦éÆftHg{^ªÏ¦çêÜ·B
    0       {^1
    $100    {^2
    $200    {^3
ACR^CvÉÈºÌlðÁ¦éÆr[v¹ªÏ¦çêÜ·B
    0       ¢¹(m[})
    $100    x¹

%sample
msgdlg "¡úÍ±±ÅI¹µÜ·©H","vOÌI¹",3,5
if stat=6 : dialog "Í¢@ªIð³êÜµ½"
if stat=7 : dialog "¢¢¦@ªIð³êÜµ½"
if stat=2 : dialog "·¬Ý¾Ù@ªIð³êÜµ½"


%index
multiopen
¡Ìt@C¼ðæ¾
%group
IuWFNg§ä½ß
%prm
v1,v2,n3,n4
v1 : Ið³ê½t@C¼ðó¯æé½ßÌÏ
v2 : îñ
n3 : tB^ÌCfbNX(1©ç)
n4 : Read Only{bNXðt¯é

%inst
HSPÌdialog(type 16,17)Å¡Ìt@CðIðÅ«éæ¤Éµ½àÌÅ·B
multiopenÄÑoµÉAv1.0,v1.1É»ê¼êv1,v2ÌTCYðãüµÄ¨«Ü·B
v2ÉÍáÌæ¤È`®ÅtB^ðãüµÜ·B
n3ðÈªAÜ½Í}CiXÌlðgÁ½Æ«Ì®ìÍõlQÆB
n4ð1É·éÆReadOnly{bNXðt¯Ü·B2É·éÆReadOnly{bNXð`FbNµ½óÔÉµÜ·B
^
±Ì½ßðÄÑoµ½ãÌstatÌl
^p
0 LZ³ê½
1 t@CªIð³êÄOK{^ª³ê½
2 t@CªIð³êÄOK{^ª³ê½(ReadOnlyª`FbN³êÄ¢éB½¾µ¡Ið³êÄ¢È¢êÌÝ)
^p
p3ð0(Èª)ÉµÄp1,p2É¶ñðüêéÆp1ª^CgÉÈèAp2ÍútH_ÉÈèÜ·B
p3ð}CiXlÉ·éÆÛ¶·ét@C¼ð¾éÆ«Ég¤±ÆªÅ«Ü·B(½¾µ¡IðÍÅ«Ü¹ñ)
^
¡Ìt@CªIð³ê½©Ínotesel,notemaxðgÁÄ²×Ü·B
t@CªêÂµ©Ið³êÈ©Á½êAp1ÉÍt@C¼ÌtpXªãü³êAp2ÉÍt@CÌg£qªãü³êÜ·B
t@Cª¡IÎê½êÍAp1ÉnotegetÅæ¾Å«é`®Åt@C¼ª¡üÁÄ¢ÄAp2ÉÍIð³ê½t@Cª étH_ªãü³êÜ·B(p1Ìt@C¼Í'\r'($0d)ÅæØçêÄ¢Ü·B)

%sample
	buf_size=512 : info_size=128
	alloc buf,buf_size
	alloc info,info_size
^
	buf="Ì§²ÙðJ­test title" : info="a:\\windows"
	multiopen buf,info

	buf=buf_size
	buf.1=info_size
	info="HSP2 ½¸ØÌßÄÌ§²Ù(*.hsp)|*.hsp|Ã·½ÄÌ§²Ù(*.txt)|*.txt|SÄÌÌ§²Ù|*.*|"
	multiopen buf,info,1
	if stat=0 : mes "LZ³êÜµ½" : else {
		notesel buf
		notemax mx
		mes "Ið³ê½t@C "+mx
		repeat mx
			noteget a,cnt
			mes a
		loop
		if mx=1 : mes "g£qÍ"+info : else mes "tH_ "+info
	}


%index
console_end
R\[EBhEðÂ¶é
%group
½ßTv
%inst
R\[EBhEðÂ¶Ü·B
%href
console



%index
console
R\[EBhEðì¬
%group
½ßTv
%inst
R\[EBhEðì¬µÜ·B

%href
console_end
gets
puts
console_color
console_pos




%index
puts
R\[É¶ñð«Þ
%group
½ßTv
%prm
v1
v1 : R\[É\¦·é¶ñªüÁ½¶ñÏ

%inst
R\[É¶ñð\¦µÜ·B
(putzðg¤Æv1É¼Ú¶ñðgp·é±ÆªÅ«Ü·B)

%href
gets
console




%index
gets
R\[©ç¶ñðÇÝÞ
%group
½ßTv
%prm
v1,n2
v1 : R\[©çÌ¶ñðæ¾·éÏ
n2 : æ¾·é¶Ì

%inst
R\[©ç¶ñðæ¾µÜ·B
n2ðÈªµ½Æ«ÌlÍ63Å·B

%href
puts
console




%index
console_color
R\[ÌeLXgÌFÝè
%group
½ßTv
%prm
n1
n1 : R\[Ì¶ñÌF

%inst
R\[É\¦·é¶ñÌFðÝèµÜ·B
n1ÍÈºÌlðgÝí¹Äg¢Ü·B1+4¾ÆÉÈèÜ·B
1+4+8Å¾é¢ÉÈèÜ·B
^
^p
n1Ìl  F
1       Â
2       Î
4       Ô
8       ­²
$10     Â(wi)
$20     Î(wi)
$40     Ô(wi)
$80     ­²(wi)
^p

%href
puts
console



%index
console_pos
R\[Ì¶\¦ÊuÝè
%group
½ßTv
%prm
n1,n2
n1 : xÀW
n2 : yÀW

%inst
¶ñð\¦·éÀWðÝèµÜ·B

%href
puts
console


%index
to_uni
UnicodeÖÏ·
%group
¶ñì½ß
%prm
v1,v2,n3
v1 : Unicodeði[·éÏ
v2 : UnicodeÉÏ··é¶ñÏ
n3 : UnicodeÉÏ··é¶ñÌ·³

%inst
ANSI¶ñ(SJIS)ðUNICODEÉÏ·µÜ·B
^
±Ì½ßðÄÑoµ½ãAstatÉobt@É«Üê½Unicode¶Ìªãü³êÜ·B
0ÈçG[Å·B
^
unicodeÄÑoµãÉstatÉüélÌ'obt@É«Üê½Unicode¶Ì'ÍA1oCg(¼p)¶Í1¶¤2oCg(Sp)¶à1¶Æ¦Ü·B
á¦Î
	s="abc ¢¤"
ð·×ÄUnicodeÉÏ·µ½ ÆÌstatlÍ6+1(* +1ÍÅãÌ¶ñI¶Ôñ)BÆÈèÜ·B
^
n3ð-1É·éÆwèµ½¶ñSÄðÏ·µÜ·B
n3ð0É·éÆUnicodeði[·éÌÉKvÈÏÌTCYðÔµÜ·B(oCgPÊ)

%href
from_uni

%sample
	s="UnicodeÉÏ··é¶ñ"
	strlen sl,s
	;alloc buf,(sl+1)*2	;±Ìê(sl+1)*2ª64É½È¢ÌÅallocÍKvÈ¢
	to_uni buf,s,sl+1
	usize=stat
	if usize=-1 : dialog "G[ª­¶µÜµ½"
	if usize=0 : dialog "Ï·ª¸sµÜµ½"
	if usize>0 : bsave "unicode.dat",buf,usize*2




%index
from_uni
Unicode©çANSIÉÏ·
%group
¶ñì½ß
%prm
v1,v2,n3
v1 : Multibyteði[·éÏ
v2 : MultibyteÉÏ··éUnicode¶ñªüÁÄ¢éÏ
n3 : MultibyteÉÏ··éUnicode¶ñÌ·³

%inst
UNICODEðANSI¶ñÉÏ·µÜ·B
^
±Ì½ßðÄÑoµ½ãAstatÉobt@É«Üê½Multibyte¶Ìªãü³êÜ·B
0ÈçG[Å·B
^
±Ì½ßðÄÑoµ½ãÌstatÌlA'obt@É«Üê½Multibyte¶Ì'Í1oCg(¼p)¶Í1¶¤2oCg(Sp)¶Í2¶Æ¦Ü·B
^
'MultibyteÉÏ··éUnicode¶ñÌ·³'ð-1É·éÆSÄÏ·µÜ·B
'MultibyteÉÏ··éUnicode¶ñÌ·³'ð0É·éÆMultibyteði[·éÌÉKvÈÏÌTCYðÔµÜ·B(oCgPÊ)

%href
to_uni

%sample
	exist "unicode.dat"
	bload "unicode.dat",uni,strsize
	buf=""
	from_uni buf,uni,-1
	mbsize=stat
	if mbsize=-1 : dialog "G[ª­¶µÜµ½"
	if mbsize=0 : dialog "Ï·ª¸sµÜµ½"
	if mbsize>0 : dialog buf


%index
dd_accept
hbO&hbvðÅ«éæ¤É·é
%group
½ßTv
%prm
v1,v2,n3
v1 : hbO&hbv³ê½t@C¼ðüêéÏ
v2 : hbO&hbv³ê½t@CðüêéÏ
n3 : EBhEID
%inst
n3Åwèµ½EBhEÉhbO&hbv(ÈºD&D)ðÅ«éæ¤ÉµÜ·B
½¾µAEBhEID 1ÍÝèÅ«Ü¹ñB
dd_acceptðÀsµ½ãAEBhEÉt@CªD&D³êéÆv1Åwèµ½ÏÉD&D³ê½t@C¼ªüèÜ·B
v2ÉÍD&D³ê½t@CÌAD&D³ê½ÀWAEBhEIDªãü³êÜ·B
^
D&D³ê½t@C¼Í"\n"ÅæØçêÄ¢Ü·(D&D³ê½t@Cª1ÂÌêÅà)B
1ÂÌt@C¼ðæèoµ½¢Æ«Ím[gpbh½ßðg¤ÆÖÅ·B
^
dd_acceptÀsãÍAv1,v2ÉÝèµ½ÏÍalloc,dim,sdimÈÇÉgpµÈ¢Åº³¢B

%href
dd_reject
%sample
	#include "llmod3.hsp"
	#include "dragdrop.hsp"
^
	alloc buf,1024*64	;hbO&hbv³ê½t@C¼ðüêéÏ
	dd_accept buf,a
^
*@
	wait 1
	if a {
		cls
		pos 0,0
		mes "hbO&hbv³ê½t@C:"+a
		mes "hbO&hbv³ê½t@CÊu x:"+a.1+" y:"+a.2
		mes "hbO&hbv³ê½EBhEID :"+a.3
		mes buf
		a=0		; aðZbgµÄ­¾³¢
	}
	goto @b




%index
dd_reject
hbO&hbvðÅ«È¢æ¤É·é
%group
g£üoÍ§ä½ß
%prm
n1,n2
n1 : EBhEID
n2 : tO
%inst
hbO&hbvðÅ«È¢æ¤ÉµÜ·B
dd_acceptðÀsµÄ¢È¢êÉÍøÊª èÜ¹ñB
n2ð1É·éÆà¤êxhbO&hbvðÅ«éæ¤ÉµÜ·B
%href
dd_accept



%index
keybd_event
L[{[hì
%group
g£üoÍ§ä½ß
%prm
n1,n2,n3
n1 : L[R[h
n2 : L[ðú·tO
n3 : IvV

%inst
L[{[hìðs¢Ü·B
n1Éµ½¢L[ÌL[R[hðwèµÜ·B
n2ð0ÉµÄ±Ì½ßðÀs·éÆn1ðOñÀsµ½Æ«Æ¯¶L[R[hA
n2ð1ÉµÄà¤êx±Ì½ßðÀsµÈ¢ÆL[ðúµ½±ÆÉÈèÜ¹ñB
n2ð-1É·éÆµÄúµ½±ÆÉÈèÜ·B
n3ÌIvVÍXN[VbgL[ð·Æ«ÉgpµÜ·Bn3ð0É·éÆtXN[A1É·éÆANeBuÈEBhEªNbv{[hÉRs[³êÜ·B
^
keybd_eventÍ¼ÌvOÌEBhEªANeBuÈêÅàÀs³êÜ·B
^
<>L[R[h
L[R[hÍgetkeyÅgp·éàÌÆ¯¶Å·B
Ù©ÉàÈºÌæ¤ÈàÌª èÜ·B
^p
n1Ìl
44       XN[Vbg
45       INS
46       DEL
106      eL[Ì'*'
107      eL[Ì'+'
108      eL[Ì','
109      eL[Ì'-'
110      eL[Ì'.'
111      eL[Ì'/'
^p
%sample
	#include "llmod3.hsp"
	#include "input.hsp"
^
	exec "notepad"
	s="ABCDEFG" : strlen L,s
^
	repeat L
		peek c,s,cnt
		keybd_event c,-1
	loop
^
	keybd_event 18,-1	;ALT
	keybd_event 'F',-1	;Ì§²Ù(F)
	keybd_event 'O',-1	;J­(O)
^
	keybd_event 'N',-1	;Z[umF_CAOÌ¢¢¦(N)
^
	s="INPUTnAS" : strlen L,s	;'n'ÍL[R[hÅ'.'(110)ð\·
^
	;±±ÌRgðO·ÆSHIFTðµ½±ÆÉÈèå¶ÉÈèÜ·
	;keybd_event 16
^
	repeat L
		peek c,s,cnt
		keybd_event c,-1
	loop
^
	;ãÌRgðOµ½Æ«Í±±ÌRgàOµÄ­¾³¢
	;keybd_event 16,1
^
	keybd_event 13,-1	;ENTER
^
	stop



%index
mouse_event
}EXì
%group
g£üoÍ§ä½ß
%prm
n1,n2,n3
n1 : ì^Cv
n2 : ½ûüÌÚ®Ê
n3 : ¼ûüÌÚ®Ê

%inst
}EXìðs¢Ü·B
n1Éwè·é^CvÅ}EXìðs¤±ÆªÅ«Ü·B
½ûüÌÚ®ÊÍAæÊ¶©çEÖÚ®³¹éÆ«ª³A»Ìtª
¼ûüÌÚ®ÊÍAæÊã©çºÖÚ®³¹éÆ«ª³A»Ìtª
Å é±ÆÉÓµÄ­¾³¢B
^
mouse_eventÍHSPÌvOªANeBuÅÈ¢Æ«Åà}EXìÉe¿µÜ·B
^
<>ì^Cv
n1ÌlÍÈºÌàÌðgÝí¹Ägp·é±ÆªÅ«Ü·B
^p
n1Ìl
$1       }EXÚ®
$2       ¶Ì{^ð·
$4       ¶Ì{^ðú·
$8       EÌ{^ð·
$10      EÌ{^ðú·
$20      Ì{^ð·
$40      Ì{^ðú·
^p
%sample
	#include "llmod3.hsp"
	#include "input.hsp"
^
*lp
	movx=0 : movy=0
	getkey k,37 : if k : movx-	;©L[
	getkey k,38 : if k : movy-	;ªL[
	getkey k,39 : if k : movx+	;¨L[
	getkey k,40 : if k : movy+	;«L[
^
	;SHIFTª³ê½ç¶{^ð·
	getkey kSHIFT,16 : if kSHIFT : Lbtn=$2 : else Lbtn=0
	mouse_event $1+Lbtn, movx, movy
^
	;SHIFTð·Æ}EXÌ¶{^ðµ½±ÆÉÈèkª1ÉÈé
	getkey k,1 : if k : pset mousex,mousey
^
	;SHIFTª³êÄ½ç¶{^ðú·
	if kSHIFT : mouse_event $4
^
	await 1
	goto lp

