TITLE	12080912 FINAL
	.MODEL	SMALL
	.STACK	64
	.DATA
NEW_FILE_TITLE	DB	' UNTITLED TEXT FILE '	;»õÆÄÀÏ Á¦¸ñ ÅØ½ºÆ®
FILE_TITLE	DB	22 DUP (' ')		;ÆÄÀÏ Á¦¸ñ ÅØ½ºÆ® 
FRAME		DB	0C9H, 2 DUP ( 0CDH ), ' EDITOR : ', 66 DUP ( 0CDH ), 0BBH ;¿¡µðÅÍ Æ²
		DB	22 DUP( 0BAH, 78 DUP (' '), 0BAH ) 
MENU_STR	DB	' ', 0AFH,' Press F1-Menu', 46 DUP(' '),'|ROW:    COL:      ' 
HELP_MENU_STR	DB	?	;µµ¿ò¸» ÅØ½ºÆ®
COUNT_ROW	DB	?
ROW		DB	1	;ÇöÀç Çà
COL		DB	1	;ÇöÀç ¿­
LEFT_LIM	EQU	1	;¿ÞÂÊ ÇÑ°è
RIGHT_LIM	EQU	4EH	;¿À¸¥ÂÊ ÇÑ°è
TOP_LIM		EQU	1	;À§ÂÊ ÇÑ°è
BTM_LIM		EQU	22	;¾Æ·¡ÂÊ ÇÑ°è
ROWLEN		DB	78	;ÇÑÁÙÀÇ Ä­ °¹¼ö
ESC_CHK		DB	0	;ESC°¡ ´­·È´ÂÁö Ã¼Å©ÇÏ´Â º¯¼ö
TEXT_AREA	DB	1800 DUP (' '), 0DH, 0AH ; ÅØ½ºÆ® ÀúÀå¿µ¿ª
CALROW		DB	2 DUP (' ')
CALCOL		DB	2 DUP (' ')
;------------------------------------------------
MTOPROW		EQU	08	;¸Þ´º¿¡¼­ÀÇ À­ÁÙ 
MBOTROW		EQU	14	;¸Þ´º¿¡¼­ÀÇ ¾Æ·§ÁÙ
MLEFCOL		EQU	30	;È­¸é³¡¿¡¼­ ¶³¾îÁø Ä­¼ö
MATTRIB		DB	?	;¸Þ´º ¼Ó¼ºÀ» ¹ÞÀ» º¯¼ö
MROW		DB	00	;¸Þ´º¿¡¼­ »ç¿ëÇÒ Çà
MESC_CHK	DB	0
SHADOW	DB	19 DUP (0B1H )	;¸Þ´ºÀÇ ±×¸²ÀÚ
MENU		DB	0C9H, 17 DUP ( 0CDH ), 0BBH	;¸Þ´º	
		DB	0BAH, '    Continue     ', 0BAH
		DB	0BAH, '    New  file    ', 0BAH
		DB	0BAH, '    Save file    ', 0BAH
		DB	0BAH, '    Load file    ', 0BAH
		DB	0BAH, '   Exit editor   ', 0BAH
		DB	0C8H, 17 DUP ( 0CDH ), 0BCH
;--------------------------------------------------
SAVEMESS	DB	'Save the data in   C:\','$'	;¼¼ÀÌºê ½Ã¿¡ Ãâ·ÂµÉ ¸Þ½ÃÁö
LOADMESS	DB	'Load the data from C:\','$'	;·Îµå ½Ã¿¡ Ãâ·ÂµÉ ¸Þ½ÃÁö
FILEMESS	DB	'Enter the file name for Save/Load','$'	;¼¼ÀÌºê,·Îµå½Ã ÆÄÀÏÀÌ¸§ ÀÔ·Â¾È³» ¸Þ½ÃÁö
ENDMESS		DB	'<Press any key> Program exiting now...'	;ÇÁ·Î±×·¥ Á¾·á½Ã Ãâ·ÂµÉ ¸Þ½ÃÁö
PRESS		DB	'<Press any key>','$'			;Å° ÀÔ·Â ¸Þ½ÃÁö
ERRORMESS	DB	'File iperation error! ','$'		;ÆÄÀÏ ¿¬»êÁß ¿¡·¯°¡ ¹ß»ýµÉ ¶§ 
FILEPATH	DB	'C:\'
INPUTPATH	DB	23 DUP(' '), 00H			;¾Æ½ºÅ°Á¦·Î ½ºÆ®¸µ
FILEHAND	DW	?					;ÆÄÀÏÇÚµé ÀúÀåº¯¼ö
PARLIST		LABEL	BYTE
MAX_LEN		DB	20
ACT_LEN		DB	?
KB_DATA		DB	21 DUP(' ')
.386 ;-------------------------------------------
	.CODE
A10MAIN	PROC	FAR
	MOV	AX,@DATA
	MOV	DS,AX
	MOV	ES,AX
			
	MOV	AH,00H	;ºñµð¿À ¸ðµå ¼³Á¤
	MOV	AL,03H
	INT	10H
			
	MOV	AH,05H	;È°¼º ÆäÀÌÁö ¼±ÅÃ
	MOV	AL,00H
	INT	10H
A20:
	CALL	B10ALLCLEAR	;ÀüÃ¼ µð½ºÇÃ·¹ÀÌ ÃÊ±âÈ­
	CALL	D10FRAME	;¿¡µðÅÍ Æ² Ãâ·Â(Á¦¸ñ,´ÜÃàÅ° ¼³¸í Æ÷ÇÔ)
	
A30:	
	MOV	DH,ROW		;Ä¿¼­ ¼³Á¤
	MOV	DL,COL
	CALL	E10CURSOR	
	
	CALL	G10KEYBRD	;ÀÔ·Â¹Þ±â
				;ÀÔ·Â¹ÞÀº°Å ¸Þ¸ð¸®¿¡ ³Ö°í
				;¸Þ¸ð¸®ÀÇ ³»¿ë Ãâ·Â
	CALL	I10DISCHR

	CMP	ESC_CHK,1	;ESC°¡ ´­·È´ÂÁö È®ÀÎÇÑ´Ù(´­¸®¸é Á¾·á)
	JE	A90		
	JMP	A30		
	MOV	AH,10H
	INT	16H
A90:				
	MOV	AX,1301H
	MOV	BH,00
	MOV	BL,0F4H
	LEA	BP,ENDMESS
	MOV	CX,38
	MOV	DX,0A14H
	INT	10H
				;Á¾·á ¸Þ½ÃÁö¸¦ Ãâ·ÂÈÄ
	MOV	AH,10H		;¾Æ¹«Å°³ª ´©¸£¸é ½ºÅ©·ÑÈÄ Á¾·á
	INT	16H		
	CALL	B10ALLCLEAR
	MOV	AX, 4C00H
	INT	21H
A10MAIN	ENDP
;------------------------------------------------
B10ALLCLEAR	PROC	NEAR
			;ÇÁ·Î½ÃÁ®¸¦ È£ÃâÇÏ¸é È­¸é ÀüÃ¼¸¦ ½ºÅ©·Ñ
			;È­¸éÀüÃ¼¸¦ ½ºÅ©·Ñ(ÅØ½ºÆ® ¿µ¿ª ¹Û±îÁö)
	PUSHA
	MOV	AX,0600H
	MOV	BH,4FH
	MOV	CX,0000H
	MOV	DX,184FH
	INT	10H
	POPA
	RET
B10ALLCLEAR	ENDP
;------------------------------------------------
C10CLEAR	PROC	NEAR
;AL¸¦ ¼¼ÆÃÇÏ¸é È£ÃâÇÏ¸é AL°ª¸¸Å­ È­¸é ½ºÅ©·Ñ
;ÅØ½ºÆ® ¿µ¿ª¾È¿¡¼­¸¸ ½ºÅ©·Ñ
	PUSHA
	MOV	AH,06H
	MOV	BH,4FH
	MOV	CX,0101H
	MOV	DX,174EH
	INT	10H
	POPA
	RET
C10CLEAR	ENDP
;------------------------------------------------
D10FRAME	PROC	NEAR
;¿¡µðÅÍÀÇ ÀüÃ¼Æ²À» Ãâ·Â
;Ä¿¼­ ¼³Á¤
	PUSHA
	MOV	DX,0000		
	CALL	E10CURSOR
	
			;¿¡µðÅÍÀÇ ¹Ù±ùÂÊ Æ²À» Ãâ·Â
	MOV	AX,1301H
	MOV	BL,4FH
	LEA	BP,FRAME
	MOV	CX,1920
	MOV	DX,0000H
	INT	10H
			;¹ØÁÙ¸Þ´º´ÜÃàÅ° Ãâ·Â
	MOV	AX,1301H
	MOV	BL,0F4H
	LEA	BP,MENU_STR
	MOV	CX,80
	MOV	DX,1700H
	INT	10H
			;¹®¼­ Á¦¸ñ(Å¸ÀÌÆ²) Ãâ·Â
	MOV	AX,1301H
	MOV	BL,0F4H
	LEA	BP,NEW_FILE_TITLE
	MOV	CX,20
	MOV	DX,000CH
	INT	10H

	POPA
	RET
D10FRAME	ENDP
;------------------------------------------------
E10CURSOR	PROC	NEAR
;DX¸¦ ¼¼ÆÃÇÏ°í È£ÃâÇÏ¸é Ä¿¼­ÀÇ À§Ä¡¸¦ ¼³Á¤
	PUSHA
	MOV	AH,02
	MOV	BH,00
	INT	10H
	POPA
	RET
E10CURSOR	ENDP
;------------------------------------------------
F10INPUTCHR	PROC	NEAR
;ÅØ½ºÆ®¿µ¿ª¿¡ Ç¥½ÃÇÒ µ¥ÀÌÅÍ¼¼±×¸ÕÆ® TEXT_AREAÀÇ ¿µ¿ª¿¡ °ª ÀÔ·Â
	PUSHA
	PUSH	AX		;°öÇÏ±â¿¡¼­ AX¸¦ »ç¿ëÇÏ¹Ç·Î ¹é¾÷
	MOV	AX,0000		;AX ÃÊ±âÈ­
	MOVZX	AX,ROW		;AX = (ROW-1)*78
	DEC	AX
	IMUL	ROWLEN
	MOVZX	BX,COL		;AX = AX + (COL-1)
	ADD	AX,BX
	DEC	AX
	MOV	CX,AX
	
	POP	AX		;¹é¾÷ÇØ³ù´ø AX¸¦ º¹¿ø
	LEA	DI,TEXT_AREA	;STOSB¸¦ ÅëÇØ¼­ TEXT_AREA¿¡ »ðÀÔ
	ADD	DI,CX
	CLD
	STOSB
				;COL°ªÀ» °è»êÇØ¼­ COLÀÌ 79±îÁö¸¸ °è»êµÇ°í
				;79¸¦ ³Ñ¾î°¡¸é ROW¸¦ Áõ°¡½ÃÄÑ ÇàÀ» ³ªÅ¸³»°ÔÇÑ´Ù.
	CMP	COL,RIGHT_LIM	;¸¶Áö¸· ¿­ÀÎÁö °Ë»çÇØ¼­ ¸¶Áö¸·¿­ÀÌ¸é ´ÙÀ½ÇàÀ¸·Î
	JB	F10
	CMP	ROW,BTM_LIM	;¸¶Áö¸·ÁÙ, ¸¶Áö¸·¿­¿¡¼± Á¦ÀÚ¸®¿¡ ¸ØÃß±âÀ§ÇØ¼­ °Ë»ç
	JE	F90		;(Áõ°¡¾øÀÌ ¹Ù·Î¸®ÅÏ)
	INC	ROW
	MOV	COL,01
	JMP	F90	
F10:
	INC	COL
F90:
	POPA
	RET
F10INPUTCHR	ENDP
;------------------------------------------------
G10KEYBRD	PROC	NEAR
;Å°º¸µå·ÎºÎÅÍ ÀÔ·ÂÀ»¹Þ¾Æµé¿©¼­ ±×¿¡ ¸Â´Â ±â´ÉÀ» ¼öÇàÇÏ´Â
;ÇÁ·Î½ÃÁ®¸¦ È£ÃâÇÑ´Ù
	PUSHA
	MOV	AH,10H	
	INT	16H	;ÀÔ·ÂÀ» ¹Þ¾ÆµéÀÎ´Ù
	CMP	AL,00H	;¹Þ¾ÆµéÀÎ ¹®ÀÚ°¡ ¾ËÆÄºªÀÎÁö °Ë»çÇÏ´Â °úÁ¤
	JE	G20
	CMP	AL,0E0H
	JE	G20
	CMP	AL,0DH
	JE	G20
	CMP	AL,08H
	JE	G40
	CMP	AL,1BH
	JE	G70
	CALL	F10INPUTCHR	;¾ËÆÄºªÀÏ¶§´Â ÅØ½ºÆ®¿µ¿ª¿¡ ¹®ÀÚ»ðÀÔ
	JMP	G90
G20:			;¿À¸¥ÂÊ È­»ìÇ¥
	CMP	AH,4DH
	JNE	G30
	CALL	H10RTARRW
	JMP	G90
G30:			;¿ÞÂÊ È­»ìÇ¥
	CMP	AH,4BH
	JNE	G33
	CALL	H20LFARRW
	JMP	G90
G33:			;¾Æ·¡ÂÊ È­»ìÇ¥
	CMP	AH,50H
	JNE	G36
	CALL	H40DWNARRW
	JMP	G90
G36:			;À§ÂÊ È­»ìÇ¥
	CMP	AH,48H
	JNE	G39
	CALL	H30UPARRW
	JMP	G90
G39:			;¿£ÅÍ
	CMP	AH,1CH
	JNE	G40
	CALL	H80ENTER
	JMP	G90
G40:			;¹é½ºÆäÀÌ½º
	CMP	AH,0EH
	JNE	G45	
	CALL	H90BACKSP
	JMP	G90
G45:			;µô¸®Æ®	
	CMP	AH,53H
	JNE	G50
	CALL	H70DELETE
	JMP	G90
G50:			;È¨
	CMP	AH,47H
	JNE	G60
	CALL	H100HOME
	JMP	G90
G60:			;¿£µå
	CMP	AH,4FH
	JNE	G65
	CALL	H110END
	MOV	ROW,24
	JMP	G90
G65:			;F1-¸Þ´º
	CMP	AH,3BH
	JNE	G70
	CALL	CAMENU
	JMP	G90
G70:			;ESC-Á¾·á
	CMP	AH,01H
	JNE	G90
	MOV	ESC_CHK,1
G90:	
	POPA
	RET
G10KEYBRD	ENDP
;------------------------------------------------
H10RTARRW	PROC	NEAR
;¿À¸¥ÂÊ È­»ìÇ¥¿¡ ´ëÇÑ µ¿ÀÛÀ» ¼öÇàÇÔ
	PUSHA
	CMP	COL, RIGHT_LIM	;¿À¸¥ÂÊ ³¡ÀÎ°¡¿¡ ´ëÇÑ °Ë»ç
	JAE	H11	;³¡ÀÌ¸é ¾Æ·§ÁÙ Ã¹Ä­À¸·Î Ä¿¼­ÀÌµ¿
	INC	COL		
	JMP	H19
H11:	
	CMP	ROW,BTM_LIM	;¸Ç¸¶Áö¸·ÁÙÀº ¿¹¿ÜÃ³¸®
	JE	H19		;¹Ù·Î ¸®ÅÏ
	CALL	H40DWNARRW
	CALL	H50FLINE
H19:	
	POPA
	RET
H10RTARRW	ENDP
;------------------------------------------------
H20LFARRW	PROC	NEAR
;¿ÞÂÊ È­»ìÇ¥¿¡ ´ëÇÑ µ¿ÀÛÀ» ¼öÇàÇÔ
	PUSHA
	CMP	COL, LEFT_LIM ;¿ÞÂÊ ³¡ÀÎ°¡¿¡ ´ëÇÑ °Ë»ç
	JBE	H21	;³¡ÀÌ¸é À­ÁÙ ¸¶Áö¸·Ä­À¸·Î Ä¿¼­ÀÌµ¿
	DEC	COL
	JMP	H29
H21:	
	CMP	ROW,TOP_LIM	;¸ÇÀ­ÁÙ¿¡¼± ¿¹¿ÜÃ³¸®
	JE	H29		;¹Ù·Î ¸®ÅÏ
	CALL	H30UPARRW
	CALL	H60ELINE
H29:
	POPA
	RET
H20LFARRW	ENDP
;------------------------------------------------
H30UPARRW	PROC	NEAR
;À§ÂÊ È­»ìÇ¥¿¡ ´ëÇÑ µ¿ÀÛÀ» ¼öÇàÇÔ
	CMP	ROW, TOP_LIM
	JE	H39
H31:
	DEC	ROW
H39:
	RET
H30UPARRW	ENDP
;------------------------------------------------
H40DWNARRW	PROC	NEAR
;¾Æ·¡ÂÊ È­»ìÇ¥¿¡ ´ëÇÑ µ¿ÀÛÀ» ¼öÇàÇÔ
	CMP	ROW, BTM_LIM
	JE	H49
H41:
	INC	ROW
H49:
	RET
H40DWNARRW	ENDP
;------------------------------------------------
H50FLINE	PROC	NEAR

;ÁÙÀÇ ¸Ç¾ÕÀ¸·Î Ä¿¼­ ÀÌµ¿
	MOV	COL, LEFT_LIM
	CALL	E10CURSOR
	RET
H50FLINE	ENDP
;------------------------------------------------
H60ELINE	PROC	NEAR
;ÁÙÀÇ ¸ÇµÚ·Î Ä¿¼­ ÀÌµ¿
	MOV	COL, RIGHT_LIM
	CALL	E10CURSOR
	RET
H60ELINE	ENDP
;------------------------------------------------
H70DELETE	PROC	NEAR
;Ä¿¼­ µÚ¿¡ ÀÖ´Â ÇÑ¹®ÀÚ¸¦ Áö¿ì´Â ±â´É
	PUSHA
	MOV	AX,0000		;AX ÃÊ±âÈ­
	MOVZX	AX,ROW		;AX = (ROW-1)*78
	DEC	AX
	IMUL	AX,78

	MOVZX	BX,COL		;AX = AX + (COL-1)
	ADD	AX,BX
	DEC	AX
	MOV	BX,AX
	MOV	CX,1794
	SUB	CX,AX

	LEA	DI, [TEXT_AREA+BX]	;ÇÑ¹®ÀÚ¾¿ ¹Ýº¹ÇØ¼­ ²ø¾î¿È
	LEA	SI, [TEXT_AREA+BX+1]
	REP	MOVSB
	POPA
	RET
H70DELETE	ENDP
;------------------------------------------------
H80ENTER	PROC	NEAR
;¿¡µðÅÍÀÇ ¿£ÅÍ±â´É
	PUSHA
	CMP	ROW,BTM_LIM	;¸¶Áö¸·ÁÙ¿¡¼± ³Ñ¾î°¡Áö¾Ê°Ô ¿¹¿ÜÃ³¸®
	JE	H89		;¸¶Áö¸·ÁÙÀÌ¸é ³Ñ¾î°¡±â
	MOV	COL,1
	INC	ROW
H89:
	POPA
	RET
H80ENTER	ENDP
;------------------------------------------------
H90BACKSP	PROC	NEAR
;¹é½ºÆäÀÌ½ºÀÇ ±â´É
;¹é½ºÆäÀÌ½º¸¦ COL¸¦ °¨¼Ò½ÃÅ°°í µô¸®Æ®¸¦ È£ÃâÇÏ¹Ç·Î½á ±¸Çö
	CMP	ROW,TOP_LIM	;¸Ç Ã¹ÀÌ°í
	JNE	H91	
	CMP	COL,LEFT_LIM	;¸Ç Ã¹Ä­ÀÌ¸é ¿¹¿ÜÃ³¸®
	JE	H99
H91:	
	JE	H99
	CALL	H20LFARRW
	CALL	H70DELETE	;µô¸®Æ® È£Ãâ
H99:
	RET
H90BACKSP	ENDP
;------------------------------------------------
H100HOME	PROC	NEAR\
;È¨Å°ÀÇ ±â´ÉÀ» ÇÑ´Ù
;ÅØ½ºÆ®¿µ¿ªÀÇ Ã¹ÁÙ,Ã¹Ä­À¸·Î Ä¿¼­ ÀÌµ¿
	MOV	ROW,1
	MOV	COL,1
	RET
H100HOME	ENDP
;------------------------------------------------
H110END	PROC	NEAR
;¿£µåÅ°ÀÇ ±â´ÉÀ» ÇÑ´Ù.
;ÅØ½ºÆ®¿µ¿ªÀÇ ¸¶Áö¸·ÁÙ,¸¶Áö¸·¿­·Î Ä¿¼­ ÀÌµ¿
	MOV	ROW,22
	MOV	COL,77
	RET
H110END	ENDP
;------------------------------------------------
I10DISCHR	PROC	NEAR
;TEXT_AREA¿¡ ÀÖ´Â ¸ðµç ¹®ÀÚ¸¦ Ãâ·ÂÇÑ´Ù.
;´õºÒ¾î ÇÏ´ÜÀÇ ¸Þ´º´ÜÃàÅ° ÁÙÀÇ ROW,COLÀ» Ãâ·ÂÇÑ´Ù.
	PUSHA
	MOV	DX,0101H
	CALL	E10CURSOR
			;Ã¹¹øÂ°ÁÙ Ãâ·Â
	MOV	AX,1301H
	MOV	BL,4FH
	LEA	BP,TEXT_AREA
	MOV	CX,78
	MOV	DX,0101H
	PUSHA
	INT	10H
	POPA
	MOV	COUNT_ROW,21
			;µÎ¹øÂ° ÁÙºÎÅÍ´Â
			;·çÇÁ¸¦ ÅëÇØ ¹Ýº¹ÇØ¼­ ÇàÀ» °è»ê, Ãâ·Â
I20:	
	ADD	BP,78
	ADD	DX,0100H
	PUSHA
	INT	10H
	POPA
	CMP	COUNT_ROW,0
	DEC	COUNT_ROW
	JNE	I20

	CALL	J10ROWCOL

	POPA
	RET
I10DISCHR	ENDP
;------------------------------------------------
J10ROWCOL	PROC	NEAR
	PUSHA
	MOV	AL,ROW		;ROW °è»êÀ» À§ÇØ AL¿¡ ROW¸¦ ´ëÀÔ
	MOV	CL,0	
	CMP	AL,0AH		;ROW > 10ÀÎ°¡ °Ë»ç
	JB	J20
J15:			
	SUB	AL,0AH		;ROW°¡ 10ÀÌ»óÀÏ¶§
	INC	CL		;AL¿¡ 10À» »©°í(ALÀº 1ÀÚ¸®¸¦ ³ªÅ¸³¿)
	CMP	AL,0AH		;CL¸¦ Áõ°¡ (CL´Â 2ÀÚ¸®¸¦ ³ªÅ¸³¿)
	JAE	J15
J20:	
	ADD	AL,30H	
	MOV	CALROW+1,AL	;CALROW+1´Â 1ÀÚ¸®¼ö
	ADD	CL,30H		;CALROW´Â 2ÀÚ¸®¼ö
	MOV	CALROW,CL
	
	MOV	AL,COL		;COL °è»êÀ» À§ÇØ AL¿¡ ROW´ëÀÔ
	MOV	CL,0		;°è»ê¹æ½ÄÀº ROW¿Í µ¿ÀÏ
	CMP	AL,0AH
	JB	J30
J25:
	SUB	AL,0AH
	INC	CL
	CMP	AL,0AH
	JAE	J25
J30:
	ADD	AL,30H
	MOV	CALCOL+1,AL
	ADD	CL,30H
	MOV	CALCOL,CL

	MOV	AX,1301H	;CALROW,CALCOL Ãâ·Â
	MOV	BX,00F4H
	LEA	BP,CALROW
	MOV	CX,2
	MOV	DH,23
	MOV	DL,68
	PUSHA			;·¹Áö½ºÅÍ¼¼ÆÃÀ» ÀçÈ°¿ëÇÏ±âÀ§ÇÑ
	INT	10H		;PUSHA,POPA
	POPA			
	LEA	BP,CALCOL	;BP¿¡ COLÁÖ¼Ò ÀÔ·Â
	MOV	DL,76
	INT	10H		;COLÀÇ Ãâ·Â

	POPA
	RET
J10ROWCOL	ENDP
;-------------------------------------------------
CAMENU		PROC	NEAR
		PUSHA
CA20:		CALL	M10MENU		;¸Þ´ºÈ­¸éÀ» È­¸é¿¡ Ãâ·ÂÇÏ´Â ÇÁ·Î½ÃÀú È£Ãâ
		MOV	MROW, MTOPROW+1	;¸Þ´ºÀÇ Ã³À½ Ç×¸ñÀ» °¡¸®Å°µµ·Ï ¼³Á¤
		MOV	MATTRIB, 40H	;¼Ó¼ºÀ» ¼³Á¤ÇÏ¿© ÇØ´ç Ç×¸ñÀÇ »ö ¹ÝÀü
		CALL	MDISPLY		
		CALL	M10INPUT	;°¢ Å°ÀÔ·ÂÀ» ¹ÞÀ» ÇÁ·Î½ÃÀú È£Ãâ
		CMP	MESC_CHK, 1	;¸Þ´º Á¾·á Ã¼Å©
		JNE	CA20
		POPA

		CALL	I10DISCHR	;'ESC'Å°·Î ¸Þ´º¸¦ Á¾·á½ÃÄ×À» °æ¿ì

		MOV	ROW, 1		;Ã¹ÁÙ Ã¹Ä­¿¡ Ä¿¼­ ¼³Á¤
		MOV	COL, 1		
		CALL	E10CURSOR	
		RET	
CAMENU		ENDP
;--------------------------------------------------------------------
M10MENU		PROC	NEAR
;¸Þ´º È­¸é Ãâ·Â ÇÁ·Î½ÃÀú
		PUSHA
		MOV	AX, 1301H	;±×¸²ÀÚ Ãâ·Â
		MOV	BX, 0040H	
		LEA	BP, SHADOW	
		MOV	CX, 19		
		MOV	DH, MTOPROW+1	;¸Þ´ºÀÇ ÇÑÁÙ ¾Æ·¡
		MOV	DL, MLEFCOL+1	;¿À¸¥ÂÊÀ¸·Î ÇÑÄ­ ¿·¿¡ Ãâ·Â
MM20:		
		PUSHA
		INT	10H
		POPA
		INC	DH
		CMP	DH, MBOTROW+2	;¸Þ´ºÀÇ ¾Æ·¡ÁÙ±îÁö ±×¸²ÀÚ°¡ Ãâ·ÂµÆ´ÂÁö È®ÀÎ
		JNE	MM20

		MOV	MATTRIB, 0F0H	;¸Þ´ºÀÇ Ãâ·Â
		MOV	AX, 1300H	
		MOVZX	BX, MATTRIB	
		LEA	BP, MENU	
		MOV	CX, 19		
		MOV	DH, MTOPROW	;¸Þ´ºÀÇ °¡Àå À­ÁÙ
		MOV	DL, MLEFCOL	;°¡Àå ¿ÞÂÊ Ä­

MM30:		PUSHA			;¹Ýº¹ÇØ¼­ ¸Þ´º³¡±îÁö Ãâ·Â
		INT	10H
		POPA
		ADD	BP, 19		
		INC	DH
		CMP	DH, MBOTROW+1	;¸Þ´º°¡ ´Ù Ãâ·ÂµÆ´ÂÁö È®ÀÎ
		JNE	MM30
		POPA
		RET
M10MENU		ENDP
;--------------------------------------------------------------------
M10INPUT	PROC	NEAR
;¸Þ´º¿¡¼­ °¢ Å°¸¦ ÀÔ·Â¹Þ¾Æ µ¿ÀÛÇÏ´Â ÇÁ·Î½ÃÀú
MC20:		MOV	AH, 10H
		INT	16H		;Å°¸¦ ÀÔ·Â¹ÞÀ½
		CMP	AH, 50H		;¾Æ·¡·Î ³»·Á°¡´Â ¹æÇâÅ°ÀÎÁö È®ÀÎ
		JE	MC30
		CMP	AH, 48H		;À§·Î ¿Ã¶ó°¡´Â ¹æÇâÅ°ÀÎÁö È®ÀÎ
		JE	MC40
		CMP	AL, 0DH		;'ENTER'Å°ÀÎÁö È®ÀÎ
		JE	MC90
		CMP	AL, 1BH		; ESC-Á¾·á
		JE	MC00
		JMP	MC20

MC30:		MOV	MATTRIB, 0F0H	;¼Ó¼º¼³Á¤
		CALL	MDISPLY
		INC	MROW		;ÇÑÁÙ ¾Æ·¡·Î ÀÌµ¿
		CMP	MROW, MBOTROW-1 ;¸Þ´º °¡Àå ¾Æ·¡ÀÏ °æ¿ì
		JBE	MC50
		MOV	MROW, MTOPROW+1 ;¸Þ´ºÀÇ À§·Î ¿Ã¶ó°¡µµ·Ï ¼³Á¤
		JMP	MC50
MC40:		MOV	MATTRIB, 0F0H	;¼Ó¼º¼³Á¤
		CALL	MDISPLY
		DEC	MROW		;ÇÑÁÙ À§·Î °¡µµ·Ï ¼³Á¤
		CMP	MROW, MTOPROW+1	;¸Þ´ºÀÇ °¡Àå À§ÀÏ °æ¿ì
		JAE	MC50
		MOV	MROW, MBOTROW-1	;¸Þ´ºÀÇ °¡Àå ¾Æ·¡·Î ³»·Á°¡µµ·Ï ¼³Á¤
MC50:		MOV	MATTRIB, 40H	;ÇØ´ç Ç×¸ñÀÇ »ö ¹ÝÀü
		CALL	MDISPLY		
		JMP	MC20

MC90:		CMP	AH, 1CH		;'ENTER'Å°ÀÏ °æ¿ì Á¾·á
		JNE	MC00		

		CMP	MROW, MTOPROW+1	; 1¹øÂ° ¸Þ´º - µ¹¾Æ°¡±â
		JNE	MC01	
		JMP	MC00		; ¸Þ´º Á¾·á
MC01:		CMP	MROW, MTOPROW+2	; 2¹øÂ° ¸Þ´º - »õÆÄÀÏ
		JNE	MC02
		CALL	NEWFILE		; È­¸é&ÅØ½ºÆ®¿µ¿ª ÃÊ±âÈ­
		JMP	MC00
MC02:		CMP	MROW, MTOPROW+3	; 3¹øÂ° ¸Þ´º - ÆÄÀÏÀúÀå
		JNE	MC03
		CALL	SAVEFILE	;ÆÄÀÏÀúÀå ÇÁ·Î½ÃÁ® È£Ãâ
		JMP	MC00	
MC03:		CMP	MROW, MTOPROW+4	; 4¹øÂ° ¸Þ´º - ÆÄÀÏ·Îµå
		JNE	MC04
		CALL	LOADFILE	;ÆÄÀÏ·Îµå ÇÁ·Î½ÃÁ® È£Ãâ
		JMP	MC00
MC04:		CMP	MROW, MTOPROW+5	; 5¹øÂ° ¸Þ´º - Á¾·á
		JNE	MC00
		MOV	ESC_CHK, 01	;ÇÁ·Î±×·¥À» Á¾·á½ÃÅ³ º¯¼ö ¼³Á¤
MC00:		MOV	MESC_CHK, 01	;¸Þ´º È­¸é Á¾·á½ÃÅ³ º¯¼ö ¼³Á¤
		RET
M10INPUT	ENDP
;¸Þ´º È­¸é¿¡¼­ ÇØ´ç Ç×¸ñÀÇ »öÀÌ ¹ÝÀüµÇµµ·Ï ÇÏ´Â ÇÁ·Î½ÃÀú
;--------------------------------------------------------------------
MDISPLY		PROC	NEAR
		PUSHA
		MOVZX	AX, MROW	;¸Þ´ºÀÇ ÇöÀç ÁÙÀ» ¹Þ¾Æ¼­
		SUB	AX, MTOPROW	;°¢ Ç×¸ñÀ» Á¤È®È÷ 
		IMUL	AX, 19		;°¡¸®Å°µµ·Ï °è»ê
		LEA	SI, MENU+1	
		ADD	SI, AX

		MOV	AX, 1300H
		MOVZX	BX, MATTRIB	;ÇØ´ç Ç×¸ñÀÇ »öÀ» ¹ÝÀü
		MOV	BP, SI
		MOV	CX, 17
		MOV	DH, MROW
		MOV	DL, MLEFCOL+1	;Ã¹Ä­ºÎÅÍ ¸Þ´º³»ºÎÀÇ Å©±â±îÁö
		INT	10H		;»öÀ» ¹ÝÀü ½ÃÅ´
		POPA
		RET
MDISPLY		ENDP
;--------------------------------------------------------------------
NEWFILE		PROC	NEAR
;ÅØ½ºÆ® ¿µ¿ªÀ» ÃÊ±âÈ­ ÇÏ¿© »õÆÄÀÏÀ» ¿¬´Â ±â´É
		PUSHA
		MOV	AL,' '		;ÅØ½ºÆ®¿µ¿ªÀÇ Àü¿µ¿ªÀ»
		LEA	DI,TEXT_AREA	;°ø¹é¹®ÀÚ·Î ÃÊ±âÈ­
		MOV	CX,1800
		REP	STOSB
				;¹®¼­ Á¦¸ñ(Å¸ÀÌÆ²) Ãâ·Â
		MOV	AX,1301H
		MOV	BL,0F4H
		LEA	BP,NEW_FILE_TITLE
		MOV	CX,20
		MOV	DX,000CH
		INT	10H
		POPA
		RET		
NEWFILE		ENDP
;--------------------------------------------------------------------
SAVEFILE	PROC	NEAR
;ÆÄÀÏÀ» ¼¼ÀÌºê ÇÏ´Â ÇÁ·Î½ÃÁ®
;ÅØ½ºÆ®¿µ¿ªÀÇ µ¥ÀÌÅÍ¸¦ ÅØ½ºÆ® ¹®¼­·Î ÀúÀåÇÑ´Ù.
		MOV	DH, 16		;¾È³» ¸Þ½ÃÁöÃâ·ÂÀ» À§ÇÑ Ä¿¼­¼³Á¤
		MOV	DL, 22		
		CALL	E10CURSOR
		MOV	AH, 09
		LEA	DX, FILEMESS	;¾È³» ¸Þ½ÃÁö
		INT	21H

		MOV	DH, 17		;¸Þ½ÃÁö Ãâ·ÂÀ» À§ÇÑ Ä¿¼­ ¼³Á¤
		MOV	DL, 17		
		CALL	E10CURSOR	
		MOV	AH, 09
		LEA	DX, SAVEMESS	;ÆÄÀÏÀÌ ¼º°øÀûÀ¸·Î ÀúÀåµÇ¾úÀ» ¶§
		INT	21H		;È­¸é¿¡ ¼º°ø ¸Þ½ÃÁö¸¦ Ãâ·Â
		
		CALL	PATH_INPUT	;ÆÄÀÏ¸íÀ» ÀÔ·Â¹Þ´Â ÇÁ·Î½ÃÁ® È£Ãâ

		CALL	FILECREATE	;ÆÄÀÏ »ý¼º
		JC	SERROR		;¿¡·¯ ¹ß»ý½Ã
		MOV	AH, 40H		;ÆÄÀÏ¿¡ ·¹ÄÚµå ±â·Ï 
		MOV	BX, FILEHAND	;ÆÄÀÏ ÇÚµé ¼³Á¤
		MOV	CX, 1794	;·¹ÄÚµåÀÇ ÀüÃ¼±æÀÌ
		LEA	DX, TEXT_AREA	;ÀúÀåÇÒ ·¹ÄÚµå
		INT	21H
		JC	SERROR
		CALL	FILECLOSE	;ÆÄÀÏ ´Ý±â

		MOV	DH, 18		;¾Æ¹«Å°³ª ´©¸£µµ·Ï ÇÏ´Â ¸Þ½ÃÁö Ãâ·Â 
		MOV	DL, 33
		CALL	E10CURSOR
		MOV	AH, 09
		LEA	DX, PRESS	
		INT	21H		

		MOV	AH, 10H		;Å° ÀÔ·Â
		INT	16H
		RET
SERROR:		CALL	ERROR		;¿¡·¯¹ß»ý½Ã ¿¡·¯ ÇÁ·Î½ÃÃ³ È£Ãâ
		RET
SAVEFILE	ENDP
;--------------------------------------------------------------------
LOADFILE	PROC	NEAR
;ÀúÀåµÈ ÀÛ¾÷À» ºÒ·¯¿À´Â ÇÁ·Î½ÃÀú
;ÀúÀåµÇÀÖ´Â ÅØ½ºÆ®¹®¼­¸¦ ÀÐ¾îµé¿©¼­
µ¥ÀÌÅÍ¿µ¿ª¿¡¼­ ÀúÀåÇÏ°í Ãâ·ÂÇÑ´Ù.

		MOV	DH, 16		;¾È³» ¸Þ½ÃÁöÃâ·ÂÀ» À§ÇÑ Ä¿¼­¼³Á¤
		MOV	DL, 22	
		CALL	E10CURSOR
		MOV	AH, 09
		LEA	DX, FILEMESS	;¾È³» ¸Þ½ÃÁö
		INT	21H

		MOV	DH, 17		;ÆÄÀÏÀÌ ¼º°øÀûÀ¸·Î ·ÎµåµÇ¾úÀ» ¶§
		MOV	DL, 17		;È­¸é¿¡ ¼º°ø ¸Þ½ÃÁö¸¦ Ãâ·Â
		CALL	E10CURSOR
		MOV	AH, 09
		LEA	DX, LOADMESS		
		INT	21H

		CALL	PATH_INPUT	;ÆÄÀÏ¸íÀ» ÀÔ·Â¹Þ´Â ÇÁ·Î½ÃÁ® È£Ãâ

		CALL	FILEOPEN	;ÆÄÀÏ ¿­±â
		JC	LERROR		;¿¡·¯ ¹ß»ý½Ã
		MOV	AH, 3FH		;ÆÄÀÏ ÀÐ±â
		MOV	BX, FILEHAND	;ÆÄÀÏ ÇÚµé ¼³Á¤
		MOV	CX, 1800	;·¹ÄÚµåÀÇ ÀüÃ¼ ±æÀÌ
		LEA	DX, TEXT_AREA	;·¹ÄÚµå°¡ ÀÐÇôÁú ¹®ÀÚ¿­
		INT	21H
		JC	LERROR	
		CALL	FILECLOSE	;ÆÄÀÏ ´Ý±â

		MOV	DH, 18		;¾Æ¹«Å°³ª ´©¸£µµ·Ï ÇÏ´Â ¸Þ½ÃÁö Ãâ·Â
		MOV	DL, 33
		CALL	E10CURSOR
		MOV	AH, 09
		LEA	DX, PRESS	
		INT	21H

		MOV	AH, 10H		;Å° ÀÔ·Â
		INT	16H

		RET
LERROR:		CALL	ERROR		;¿¡·¯¹ß»ý½Ã ¿¡·¯ ÇÁ·Î½ÃÀú È£Ãâ
		RET
LOADFILE	ENDP
;--------------------------------------------------------------------
FILECREATE	PROC	NEAR
;ÆÄÀÏÀ» »ý¼ºÇÏ¿© ÆÄÀÏÇÚµéÀ» ÀúÀåÇÏ´Â ÇÁ·Î½ÃÀú
		MOV	AH, 3CH		
		MOV	CX, 00
		LEA	DX, FILEPATH	;ÆÄÀÏÀÇ °æ·Î ¼³Á¤
		INT	21H
		MOV	FILEHAND, AX	;»ý¼ºµÈ ÆÄÀÏÀÇ ÆÄÀÏÇÚµé ÀúÀå
		RET
FILECREATE	ENDP
;--------------------------------------------------------------------
FILECLOSE	PROC	NEAR
;¿­¸° ÆÄÀÏÀ» ´Ý´Â ÇÁ·Î½ÃÀú
		MOV	AH, 3EH
		MOV	BX, FILEHAND	;ÆÄÀÏ ÇÚµé ¼³Á¤
		INT	21H
		JC	CLERROR		
		RET
CLERROR:	CALL	ERROR		;¿¡·¯¹ß»ý½Ã ¿¡·¯ ÇÁ·Î½ÃÀú È£Ãâ
		RET
FILECLOSE	ENDP
;--------------------------------------------------------------------
FILEOPEN	PROC	NEAR
;ÆÄÀÏÀ» ¿­¾î¼­ ÆÄÀÏÇÚµéÀ» ÀúÀåÇÏ´Â ÇÁ·Î½ÃÀú
		MOV	AH, 3DH
		MOV	AL, 02		;ÀÐ±â/¾²±â°¡ µÇµµ·Ï ¼³Á¤
		LEA	DX, FILEPATH	;ÆÄÀÏ °æ·Î ¼³Á¤
		INT	21H
		MOV	FILEHAND, AX	;ÆÄÀÏÇÚµé ÀúÀå
		RET
FILEOPEN	ENDP
;--------------------------------------------------------------------
PATH_INPUT	PROC	NEAR
		PUSHA
		
		MOV	DH,17		;Èò¹Ú½º¸¦ Ãâ·ÂÇÏ±â À§ÇÑ Ä¿¼­¼³Á¤
		MOV	DL,40
		CALL	E10CURSOR
		
		MOV	AH,09H		;Èò¹Ú½º Ãâ·Â(AH 09, INT10)
		MOV	AL,' '
		MOV	BH,00
		MOV	BL,0F4H
		MOV	CX,20
		INT	10H

		MOV	DH,17		;ÆÄÀÏ¸í ÀÔ·ÂÀ» ¹Þ±âÀ§ÇÑ Ä¿¼­ ¼³Á¤
		MOV	DL,40
		CALL	E10CURSOR
		
		MOV	AH,0AH		;ÆÄÀÏ¸íÀ» ÀÔ·Â¹ÞÀ½
		LEA	DX,PARLIST	;ÆÄ¶ó¸®½ºÆ®¸¦ ÅëÇØ¼­
		INT	21H
		
		CLD
		LEA	SI,KB_DATA	;MOVSB¸¦ ÅëÇØ¼­ ÆÄÀÏ¸íº¯¼ö¿¡
		LEA	DI,INPUTPATH	;ÀÔ·Â¹ÞÀº °ªÀ» ³ÖÀ½
		MOVZX	CX,ACT_LEN
		REP	MOVSB
		MOV	AL,'.'		;ÆÄÀÏÆÐ½º + È®ÀåÀÚ.txtÀ» Áý¾î³Ö±â À§ÇØ
		STOSB			;AL¿¡ °ªÀ» ³Ö°í STOSB¸¦ ¾¸
		MOV	AL,'t'
		STOSB
		MOV	AL,'x'
		STOSB
		MOV	AL,'t'
		STOSB
		MOV	AL,00H
		STOSB
		
		MOV	DX,000CH	;±âÁ¸ÀÇ Á¦¸ñ »èÁ¦¸¦ À§ÇÑ Ä¿¼­¼³Á¤
		CALL	E10CURSOR
		MOV	AX,09CDH	;±âÁ¸ÀÇ Á¦¸ñ »èÁ¦
		MOV	BX,004FH
		MOV	CX,20
		INT	10H
		
		MOV	AL,' '
		LEA	DI,FILE_TITLE
		MOV	CX,22
		REP	STOSB

		LEA	DI,FILE_TITLE+1	;ÀÔ·Â¹ÞÀº ¹®ÀÚ¸¦ Á¦¸ñÃâ·ÂÀ» À§ÇØ ÀÌµ¿
		LEA	SI,KB_DATA	
		MOVZX	CX,ACT_LEN	;ÀÌµ¿¹Ýº¹Àº ACT_LEN¸¸Å­
		REP	MOVSB		
		
		MOV	AX,1301H
		MOV	BX,00F4H	
		MOVZX	CX,ACT_LEN
		ADD	CX,2
		LEA	BP,FILE_TITLE
		MOV	DX,000CH
		PUSHA
		INT	10H
		POPA

		POPA
		RET
PATH_INPUT	ENDP
;--------------------------------------------------------------------
ERROR		PROC	NEAR
;¿¡·¯¹ß»ý½Ã ¿¡·¯¸Þ½ÃÁö¸¦ È­¸é¿¡ Ãâ·ÂÇÏ´Â ÇÁ·Î½ÃÀú
		PUSHA
		MOV	AH,09
		MOV	DH, 6
		MOV	DL, 30
		CALL	E10CURSOR
		MOV	AH, 09
		LEA	DX, ERRORMESS	;È­¸é¿¡ ¿¡·¯¸Þ½ÃÁö¸¦ Ãâ·Â
		INT	21H

		POPA
		RET
ERROR		ENDP
	END	A10MAIN
;------------------------------------------------
