.include "m16def.inc"
.def temp=r16
.def leds=r17
.cseg
.org 0x0000
jmp reset ;Reset handler
jmp interrupt0 ;IRQ0 handler
jmp interrupt1 ;IRQ1 handler
reti ;rest of the handlers
reset:
    ldi temp,high(RAMEND) ;main program
    out SPH,temp    ; stack pointer to RAM
    ldi temp,low(RAMEND)
    out SPL,temp
    ldi temp,0xFF
    out DDRC,temp
    ldi temp,1<<INT1 ; 1000 0000 (INT1 = 7)
    out GIMSK,temp  ;enable interrupt 1
    ldi temp, 0b00001100 ;pos-edge enable of the
    out MCUC,temp        ;interrupt
    sei
LOOP:
    rjmp LOOP ;wait for the interrupt

interrupt1: ;routine to serve interrupt INT1
    clr leds
    out PORTB,leds ;leds on
    ;TODO: WAIT 1 MIN
    ldi leds, 0xFF
    out PORTB,leds;leds off
    reti
