power_prefix:
 cmp ah, 86
 jnz dontset
 mov al, 1
 mov bx, var
 mov byte [bx], al

 ret

dontset:

 ret

shutdown:
 mov ax, 0x5307
 mov bx, 0x0001
 mov cx, 0x0003
 int 0x15

 mov si, shutdown_msg

 call os_print_string

 jmp get_cmd

;IN:NOTHING. OUT:NOTHING. REGS PRESERVED: NONE.

CPU_RESET:
	mov dx, 0x64
	mov al, 0xFE
	out dx, al
	nop
	nop

	mov si, restart_msg

	call os_print_string

	jmp get_cmd



 shutdown_msg db 'Shutdown failed', 13, 10, 0

 restart_msg db 'Restart failed', 13, 10, 0

	var		db 0
