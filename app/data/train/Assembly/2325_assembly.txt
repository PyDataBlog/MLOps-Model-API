;Exemple de procédure qui fait le carré d'un nombre
;et l'affiche avec printf

; assemble:	nasm -f elf procedures.asm
; link:		gcc -m32 -o procedures procedures.o

extern printf

section .data
	msg db "4 * 4 = %d\n", 0
section .text

global main
jmp main

carre:
	push ebp ;sauvegarde ebp
	mov ebp, esp 
	
	mov eax, [esp+8] ;mets le nombre 4 dans eax
	mul eax ;multiplie eax par eax
	
	leave ;restaure la pile
	ret ;le retour de la fonction est dans eax

main: ;symbole de démarrage
	push 4 ;empile l'argument 1
	call carre 
	
	push eax ;empile l'arg 2
	push msg ;empile l'arg 1
	call printf 
;quitte
mov eax, 1
mov ebx, 0
int 80h
	

