;§ £®«®¢®ª ¯à¨«®¦¥­¨ï
use32                    ; âà ­á«ïâ®à, ¨á¯®«ì§ãîé¨© 32 à §àï¤­ëå ª®¬ ­¤ë
    org 0x0              ; ¡ §®¢ë©  ¤à¥á ª®¤ , ¢á¥£¤  0x0
    db 'MENUET01'        ; ¨¤¥­â¨ä¨ª â®à ¨á¯®«­ï¥¬®£® ä ©«  (8 ¡ ©â)
    dd 0x1               ; ¢¥àá¨ï ä®à¬ â  § £®«®¢ª  ¨á¯®«­ï¥¬®£® ä ©« 
    dd start             ;  ¤à¥á, ­  ª®â®àë© á¨áâ¥¬  ¯¥à¥¤ ñâ ã¯à ¢«¥­¨¥
    ; ¯®á«¥ § £àã§ª¨ ¯à¨«®¦¥­¨ï ¢ ¯ ¬ïâì
    dd i_end             ; à §¬¥à ¯à¨«®¦¥­¨ï
    dd mem               ; ¡ê¥¬ ¨á¯®«ì§ã¥¬®© ¯ ¬ïâ¨, ¤«ï áâ¥ª  ®â¢¥¤¥¬ 0å100 ¡ ©â ¨ ¢ëà®¢­¨¬ ­  £à­¨æã 4 ¡ ©â 
    dd mem               ; à á¯®«®¦¨¬ ¯®§¨æ¨î áâ¥ª  ¢ ®¡« áâ¨ ¯ ¬ïâ¨, áà §ã §  â¥«®¬ ¯à®£à ¬¬ë. ¥àè¨­  áâ¥ª  ¢ ¤¨ ¯ §®­¥ ¯ ¬ïâ¨, ãª § ­­®¬ ¢ëè¥
    dd 0x0               ; ãª § â¥«ì ­  áâà®ªã á ¯ à ¬¥âà ¬¨.
    dd cur_dir_path      ; ãª § â¥«ì ­   ¤à¥á, ªã¤  ¯®¬¥é ¥âáï áâà®ª , á®¤¥à¦ é ï ¯ãâì ¤® ¯à®£à ¬¬ë ¢ ¬®¬¥­â § ¯ãáª .

include '../../../../../macros.inc'
include '../../trunk/box_lib.mac'
include '../../load_lib.mac'
    @use_library         ;use load lib macros
start:
;universal load library/librarys
sys_load_library  library_name, cur_dir_path, library_path, system_path, \
err_message_found_lib, head_f_l, myimport, err_message_import, head_f_i
;if return code =-1 then exit, else nornary work
    cmp      eax,-1
    jz       exit
    mcall    40,0x27          ;ãáâ ­®¢¨âì ¬ áªã ¤«ï ®¦¨¤ ¥¬ëå á®¡ëâ¨©

    push     dword check1     ;¯®¤áçñâ ¤¨­ë â¥ªáâ  ¤«ï Checkbox'®¢
    call     [init_checkbox]

    push     dword check2
    call     [init_checkbox]

red_win:
    call     draw_window      ;¯¥à¢®­ ç «ì­® ­¥®¡å®¤¨¬® ­ à¨á®¢ âì ®ª­®
align 4
still:                        ;®á­®¢­®© ®¡à ¡®âç¨ª
    mcall    10               ;¦¨¤ âì á®¡ëâ¨ï
    dec      eax
    jz       red_win
    dec      eax
    jz       key
    dec      eax
    jz       button

    push    dword edit1
    call    [edit_box_mouse]

    push    dword edit2
    call    [edit_box_mouse]

    push    dword check1
    call    [check_box_mouse]

    push    dword check2
    call    [check_box_mouse]

    push    dword Option_boxs
    call    [option_box_mouse]

    push    dword Option_boxs2
    call    [option_box_mouse]

    jmp     still           ;¥á«¨ ­¨ç¥£® ¨§ ¯¥à¥ç¨á«¥­­®£® â® á­®¢  ¢ æ¨ª«
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
button:
    mcall   17             ;¯®«ãç¨âì ¨¤¥­â¨ä¨ª â®à ­ ¦ â®© ª« ¢¨è¨
    test    ah,ah          ;¥á«¨ ¢ ah 0, â® ¯¥à¥©â¨ ­  ®¡à ¡®âç¨ª á®¡ëâ¨© still
    jz      still
exit:
    mcall   -1
key:
    mcall   2              ;§ £àã§¨¬ §­ ç¥­¨¥ 2 ¢ à¥£¨áâ®à eax ¨ ¯®«ãç¨¬ ª®¤ ­ ¦ â®© ª« ¢¨è¨

    push    dword edit1
    call    [edit_box_key]

    push    dword edit2
    call    [edit_box_key]

    jmp     still

;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
align 4
draw_window:                ;à¨á®¢ ­¨¥ ®ª­  ¯à¨«®¦¥­¨ï
    mcall   12,1
    mcall   0,(50*65536+390),(30*65536+200),0x33AABBCC,0x805080DD,hed

    push    dword edit1
    call    [edit_box_draw]

    push    dword edit2
    call    [edit_box_draw]

    push    dword check1
    call    [check_box_draw]

    push    dword check2
    call    [check_box_draw]

    push    dword Option_boxs
    call    [option_box_draw]

    push    dword Option_boxs2
    call    [option_box_draw]

    mcall   12,2
   ret
;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;DATA ¤ ­­ë¥
;á¥£¤  á®¡«î¤ âì ¯®á«¥¤®¢ â¥«ì­®áâì ¢ ¨¬¥­¨.
system_path     db '/sys/lib/'
library_name    db 'box_lib.obj',0
; á«¨ ¥áâì ¦¥« ­¨¥ à §ê¥¤¨­¨âì, â® ­ã¦­® ¨á¯®«ì§®¢ âì á«¥¤ãîé¨î ª®­áâàãªæ¨î
;system_path      db '/sys/lib/box_lib.obj',0
;... «î¡ ï ¯®á«¥¤®¢ â¥«ì­®áâì ¤àã£¨å ª®¬ ­¤ ¨ ®¯à¥¤¥«¥­¨©.
;library_name     db 'box_lib.obj',0
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

err_message_found_lib    db 'Sorry I cannot load library box_lib.obj',0

head_f_i:
head_f_l              db 'System error',0
err_message_import    db 'Error on load import library box_lib.obj',0

myimport:

edit_box_draw    dd    aEdit_box_draw
edit_box_key     dd    aEdit_box_key
edit_box_mouse   dd    aEdit_box_mouse
version_ed       dd    aVersion_ed

init_checkbox    dd    aInit_checkbox
check_box_draw   dd    aCheck_box_draw
check_box_mouse  dd    aCheck_box_mouse
version_ch       dd    aVersion_ch

option_box_draw  dd    aOption_box_draw
option_box_mouse dd    aOption_box_mouse
version_op       dd    aVersion_op

    dd    0
    dd    0

aEdit_box_draw   db 'edit_box',0
aEdit_box_key    db 'edit_box_key',0
aEdit_box_mouse  db 'edit_box_mouse',0
aVersion_ed      db 'version_ed',0

aInit_checkbox   db 'init_checkbox2',0
aCheck_box_draw  db 'check_box_draw2',0
aCheck_box_mouse db 'check_box_mouse2',0
aVersion_ch      db 'version_ch2',0

aOption_box_draw  db 'option_box_draw',0
aOption_box_mouse db 'option_box_mouse',0
aVersion_op       db 'version_op',0


check1 check_box2 (10 shl 16 + 12),(45 shl 16 + 12),5,0x80AABBCC,0,0,check_text1,ch_flag_en
check2 check_box2 (10 shl 16 + 12),(60 shl 16 + 12),6,0x80AABBCC,0,0,check_text2

edit1 edit_box 350,3,5,0xffffff,0x6f9480,0,0xAABBCC,0,308,hed,mouse_dd,ed_focus,hed_end-hed-1,hed_end-hed-1
edit2 edit_box 350,3,25,0xffffff,0x6a9480,0,0,0,99,ed_buffer,mouse_dd,ed_figure_only

op1  option_box option_group1,10,90,6,12,0xffffff,0,0,op_text.1,op_text.e1-op_text.1
op2  option_box option_group1,10,105,6,12,0xFFFFFF,0,0,op_text.2,op_text.e2-op_text.2
op3  option_box option_group1,10,120,6,12,0xffffff,0,0,op_text.3,op_text.e3-op_text.3
op11 option_box option_group2,120,90,6,12,0xffffff,0,0,op_text.1,op_text.e1-op_text.1
op12 option_box option_group2,120,105,6,12,0xffffff,0,0,op_text.2,op_text.e2-op_text.2
op13 option_box option_group2,120,120,6,12,0xffffff,0,0,op_text.3,op_text.e3-op_text.3

option_group1    dd op1    ;ãª § â¥«¨, ®­¨ ®â®¡à ¦ îâáï ¯® ã¬®«ç ­¨î, ª®£¤  ¢ë¢®¤¨âáï
option_group2    dd op12   ;¯à¨«®¦¥­¨¥
Option_boxs    dd  op1,op2,op3,0
Option_boxs2   dd  op11,op12,op13,0

hed db     'BOXs load from lib <Lrz> date 27.04.2009',0
hed_end:

rb  256
check_text1  db 'First checkbox',0
check_text2 db 'Second checkbox',0

op_text:        ; ®¯à®¢®¦¤ îé¨© â¥ªáâ ¤«ï Optionbox' 
.1 db 'Option_Box #1'
.e1:
.2 db 'Option_Box #2'
.e2:
.3 db 'Option_Box #3'
.e3:
ed_buffer    rb 100
;-----------------------
;sc      system_colors

mouse_dd        rd 1
p_info    process_information
cur_dir_path    rb 4096
library_path    rb 4096
i_end:
rb 1024
mem: