; Copyright 2017 Christian Fries
;
;   Licensed under the Apache License, Version 2.0 (the "License");
;   you may not use this file except in compliance with the License.
;   You may obtain a copy of the License at
;
;       http://www.apache.org/licenses/LICENSE-2.0
;
;   Unless required by applicable law or agreed to in writing, software
;   distributed under the License is distributed on an "AS IS" BASIS,
;   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
;   See the License for the specific language governing permissions and
;   limitations under the License.

%define CR 0xA,0xD

[bits 16]
[org 0]

; **********************
; *** data section
; **********************

;section .data


; **********************
; *** code section
; **********************

;section .text

global _start
_start:
    jmp main


main:
    mov si, startMsg
    call print

    jmp main

; print(char* msg)
; \var msg must be null terminated!
print:
    mov bp,sp
    nextByte:
        lodsb; load one byte from text in al and inc si
        or al, al; check null term
        jz stringEnd
        mov ah, 0x0e
        mov bx, 0
        int 10h
        jmp nextByte
    stringEnd:
    mov sp, bp
    ret


startMsg db "Bootloader started...",CR,0
