%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Obyèejné diferenciální rovnice}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

obyèejná diferenciální rovnice -- vztah mezi neznámou funkcí jedné promìnné a jejími derivacemi;
øád ODR -- øád nejvy¹¹í derivace v ODR.

ODR $n$-tého øádu: $F(x,y,y',\ldots,y^{(n)})=0$;
øe¹ení (integrál) ODR -- funkce, která vyhovuje rovnici v daném oboru.

ODR 1. øádu: $F(x,y,y')=0$, resp. $y'=f(x,y)$ (rozøe¹ená vzhledem k derivaci).

\begin{enumerate}
   \item \emph{Rovnice se separovanými promìnnými} ve tvaru $f(x)+g(y)y'=0$,
   kde $f,g$ jsou funkce. 
   Je-li $f$ spojitá na $(a,b)$ a $g$ je spojitá na $(c,d)$,
   potom ka¾dé øe¹ení na $I\subset(a,b)$ splòuje na $I$ rovnici
   \[
      \int f(x)\,dx + \int g(y)\,dy = C, \; C\in\mathbb{R}.
   \]
   Funkce urèená na intervalu $J\subset(c,d)$ touto rovnicí, je øe¹ením diferenciální rovnice na $J$.
   %
   \item \emph{Lineární diferenciální rovnice 1. øádu} ve tvaru $y'+f(x)y=g(x)$,
   kde $f,g$ jsou funkce spojité na $(a,b)$.
   Je-li $g=0$, nazývá se rovnice homogenní, v opaèném pøípadì je nehomogenní.
   Homogenní rovnici øe¹íme separací promìnných; máme
   \[
      y'+f(x)y = 0.
   \]
   Odtud integrací dostaneme
   \[
      y(x) = Ce^{-\int f(x)\,dx}, \; C\in\mathbb{R}.
   \]
   Nehomogenní rovnici øe¹íme variací konstanty. Uva¾ujeme ho ve tvaru
   \[
      y(x) = C(x)e^{-\int f(x)\,dx},
   \]
   kde $C$ je funkce parametru $x$.
   Dosazením do pùvodní rovnice máme
   \[
      C'(x) = g(x)e^{\int f(x)\,dx}.
   \]
   Pak tedy
   \[
      y(x)=\left[\int g(x)e^{\int f(x)\,dx}\,+K\right]\,e^{-\int f(x)\,dx}, \;K\in\mathbb{R}
   \]
   je øe¹ením nehomogenní rovnice na intervalu $(a,b)$.
   %
   \item \emph{Bernoulliho rovnice} (pøíklad pøevodu nelineární rovnice na lineární) ve tvaru 
   $y'+f(x)y=g(x)y^(\alpha)$, $f,g$ funkce spojité na $(a,b)$, $\alpha\in\mathbb{R}\setminus\{0,1\}$.
   Pro $\alpha>0$ je jedním z øe¹ení funkce $y=0$.
   Ostatní øe¹ení získáme následovnì.
   Násobeníme-li rovnici $y^{-\alpha}$, dostaneme
   \[
      y^{-\alpha}y' + f(x)y^{1-\alpha} = g(x).
   \]
   Polo¾íme-li $z=y^{1-\alpha}$, potom $z'=(1-\alpha)y^{-\alpha}y'$.
   Dosazením do pùvodní rovnice tedy máme
   \[
      \frac{1}{1-\alpha}z' + f(x)z = g(x),
   \]
   co¾ je lineární diferenciální rovnice 1. øádu.
   %
   \item \emph{Lineární diferenciální rovnice $n$-tého øádu s konstantními koeficienty}
   je rovnice ve tvaru
   \[
      a_ny^{(n)}+a_{n-1}y^{(n-1)}+\cdots+a_1y'+a_0y = f(x),
   \]
   kde $f$ je spojitá na nìjakém intervalu $(a,b)$, $a_i\in\mathbb{R}$ ($i=0,1,\ldots,n$) a $a_n\neq 0$.
   Na tomto intervalu existuje øe¹ení této rovnice;
   toto je urèeno jednoznaènì poèáteèními podmínkami
   $y(x_0)=y_0, \; y'(x_0)=y_0^{1},\; \ldots, \; y^{(n)}(x_0)=y_0^{n}$
   pro nìjaké $x_0\in(a,b)$. 
   Rovnice
   \[
      a_ny^{(n)}+a_{n-1}y^{(n-1)}+\cdots+a_1y'+a_0y = 0
   \]
   se nazývá homogenní (je-li $f(x)\neq 0$ nìkde v $(a,b)$, nazývá se rovnice nehomogenní).
   Øe¹ení homogenní rovnice tvoøí vektorový podprostor $C(a,b)$
   a existuje $n$ lineárnì nezávislých funkcí (s nenulovým Wronského determinantem), 
   které jsou jejím øe¹ením (fundamentální systém øe¹ení).
   Ka¾dé øe¹ení lze potom jednoznaènì zapsat jako lineární kombinaci funkcí fundamentálního systému.
   Nech» $\lambda\in\mathbb{C}$ je koøen charakteristické rovnice
   \[
       a_n\lambda^n+a_{n-1}\lambda^{n-1}+\cdots+a_1\lambda+a_0 = 0
   \]
   s násobností $r$.
   Je-li $\lambda\in\mathbb{R}$, jsou funkce
   \[
      S(\lambda)=\{x^ie^{\lambda x}\,| \; i=0,1,\ldots,r-1\}
   \]
   øe¹ením homogenní rovnice.
   Je-li $\lambda\in\mathbb{C}$ koøen charakteristické rovnice
   (a tedy i $\bar{\lambda}$ je koøenem), kde $\lambda=\sigma+\mathrm{i}\omega$ s $\sigma,\omega\in\mathbb{R}$, 
   jsou funkce
   \[
      S(\lambda)=\{x^ie^{\sigma x}\cos\omega x,\;x^ie^{\sigma x}\sin\omega x\,|\;i=0,1,\ldots,r-1\}
   \]
   rovnì¾ øe¹ením homogenní rovnice (pøesnìji reálná øe¹ení).
   Mno¾ina
   \[
      S = \bigcup\,\{S(\lambda)\,|\,\lambda\text{ je koøen charakteristické rovnice}\}
   \]
   tvoøí fundamentální systém øe¹ení homogenní rovnice.
   Øe¹ení nehomogenní rovnice (tj. rovnice s nenulovou pravou stranu) hledáme
   napø. jako v pøípadì øe¹ení lineární rovnice prvního øádu variací konstant. 
   Staèí nalézt alespoò jedno øe¹ení, nebo» øe¹ení nehomogenní rovnice lze psát
   jako souèet libovolného øe¹ení nehomogenní rovnice (partikulární øe¹ení)
   a funkce, která je lineární kombinací fundamentálního systému øe¹ení homogenní rovnice. 
   Uva¾ujme pravou stranu ve speciálním tvaru $p(x)e^{\lambda x}$,
   kde $p$ je polynom v $x$. Je-li $\lambda$ $r$-násobný koøen charakteristické rovnice ($r\geq 0$)
   a $p$ je stupnì $k$, pak hledáme øe¹ení ve tvaru $t^rP(x)e^{\lambda x}$,
   kde $P$ je polynom v $x$ rovnì¾ stupnì $k$.
   Má-li pravá strana tvar $p(x)e^{\sigma x}\cos\omega x+q(x)e^{\sigma x}\sin\omega x$,
   kde $p$ a $q$ jsou polynomy v $x$ stupnì nejvý¹e $k$,
   a je-li $\sigma+\mathrm{i}\omega$ (a tedy rovnì¾ $\sigma-\mathrm{i}\omega$)
   $r$-násobný koøen charakteristické rovnice ($r\geq 0$),
   hledáme øe¹ení ve tvaru $t^rP(x)e^{\sigma x}\cos\omega x+t^rQ(x)e^{\sigma x}\sin\omega x$,
   kde $P$ a $Q$ jsou polynomy promìnné $x$ nejvý¹e $k$.
\end{enumerate}

\section*{Øe¹ené pøíklady}

\begin{ex}
   Øe¹te rovnici $xy'=2y+y'$.
\end{ex}
\begin{sol}
   Rovnici pøevedeme do ekvivalentního tvaru $(x-1)y'=2y$ (jedná se o rovnici se separovatelnými promìnnými,
   tj. rovnici, kterou lze pøevést na rovnici se separovanými promìnnými).
   Nech» $y\neq 0$ (nulové øe¹ení je øe¹ením rovnice) a $x\in(1,\infty)$.
   Pak dostaneme rovnici $y'/y=2/(x-1)$. Funkce $1/y$ je spojitá v $(0,\infty)$ (rovnì¾ v $(-\infty,0)$)
   a $1/(x-1)$ je spojitá na uva¾ovaném intervalu $(1,\infty)$.
   Integrací máme
   \[
      \ln|y| = \ln|x-1|+C, \; C\in\mathbb{R}.
   \]
   Odlogaritmováním dostaneme
   \[
      |y| = C(x-1)^2, \; C>0.
   \]
   Proto¾e uva¾ujeme $y>0$ a pravá strana je kladná, máme øe¹ení
   \[
      y(x) = C(x-1)^2, \; C>0.
   \] 
   Uva¾ujeme-li $y<0$, dostaneme øe¹ení
   \[
      y(x) = -C(x-1)^2, \;C>0.
   \]
   Proto¾e nulová funkce je rovnì¾ øe¹ením pùvodní diferenciální rovnice,
   její øe¹ení na intervalu $(1,\infty)$ mají tedy tvar
   \[
      y(x) = C(x-1)^2, \; C\in\mathbb{R}.
   \]
   (Podobnì mù¾eme dostat øe¹ení na intervalu $(-\infty,1)$.)
\end{sol}

\begin{ex}
   Øe¹te rovnici $y'-y\,\mathrm{cotg}\,x=e^x\,\sin\,x$.
\end{ex}
\begin{sol}
   Jedná se o nehomogenní lineární rovnici prvního øádu.
   Nejprve nalezneme øe¹ení homogenní rovnice $y'-y\,\mathrm{coth}\,x=0$.
   Funkce $\mathrm{cotg}\,x$ je spojitá na ka¾dém intervalu ve tvaru
   $(k\pi,(k+1)\pi)$, kde $k\in\mathrm{Z}$.
   Pro jednoduchost uva¾ujme $x\in(0,\pi)$.
   Integrací dostaneme
   \[
      \ln |y| = \ln |\sin x|+C, \; C\in\mathrm{R}.
   \]
   Odlogaritmováním je
   \[
      |y| = C\sin x, \; C>0
   \]
   Proto¾e pravá strana je kladná a nulové øe¹ení je rovnì¾ øe¹ením homogenní rovnice, 
   máme øe¹ení homogenní rovnice ve tvaru
   \[
      y(x) = C\sin x,\; C\in\mathrm{R}.
   \]
   Øe¹ení nehomogenní rovnice nalezneme variací konstanty, èili polo¾me $C\equiv C(x)$.
   Dosazením øe¹ení ve tvaru $y(x)=C(x)\sin x$ do pùvodní rovnice máme $C'(x) = e^x$,
   odkud $C(x) = e^x+K$, $K\in\mathbb{R}$.
   Obecné øe¹ení nehomogenní rovnice na intervalu $(0,\pi)$ je tedy
   \[
      y(x) = (e^x+K)\sin x, \; K\in\mathbb{R}.
   \]
\end{sol}

\begin{ex}
   Øe¹te rovnici $y''-y=x^2e^x$ s poèáteèními podmínkami $y(0)=1$, $y'(0)=0$.
\end{ex}
\begin{sol}
   Koøeny charakteristické rovnice $\lambda^2-1=0$ jsou $\lambda_1=1$, $\lambda_2=-1$,
   tak¾e fundamentální systém øe¹ení pøíslu¹né homogenní rovnice je tvoøen funkcemi $e^x$ a $e^{-x}$.
   Øe¹ení nehomogenní rovnice hledáme ve tvaru $y_p(x)=x(ax^2+bx+c)e^x$, kde $a,b,c\in\mathbb{R}$.
   Derivováním dostaneme
   \[
      (y''_p-y_p)(x) = (6ax^2+(6a+4b)x+2b+2c)e^x
   \]
   a porovnáním s pravou stranou máme podmínky $6a=1$, $6a+4b=0$ a $2b+2c=0$, odkud
   $a=1/6$, $b=-1/4$ a $c=1/4$, tak¾e obecné øe¹ení nehomogenní rovnice má tvar
   \[
      y(x) = \left(\frac{1}{6}x^2-\frac{1}{4}x+\frac{1}{4}\right)e^x+c_1e^x+c_2e^{-x}, \; c_1,c_2\in\mathbb{R}.
   \]
   Konstanty $c_1$ a $c_2$ urèíme z poèáteèních podmínek.
   Derivací je
   \[
      y'(x) = \left(\frac{1}{6}x^2+\frac{1}{12}x\right)e^x+c_1e^x-c_2e^{-x},
   \]
   tak¾e má platit $c_1+c_2=-1/4$ a $c_1-c_2=0$, odkud $c_1=c_2=-1/8$.
   Øe¹ením tedy je funkce
   \[
      y(x) = \left(\frac{1}{6}x^2-\frac{1}{4}x+\frac{1}{8}\right)e^x-\frac{1}{8}e^{-x}.
   \]
\end{sol}

\begin{ex}
   Øe¹te rovnici $y''-2y'+2y=\cos x$.% s poèáteèními podmínkami $y(0)=1$, $y'(0)=0$.
\end{ex}
\begin{sol}
   Koøeny charakteristické rovnice $\lambda^2-2\lambda+2=0$ jsou $\lambda_1=1+\mathrm{i}$, $\lambda_2=1-\mathrm{i}$,
   tak¾e fundamentální systém øe¹ení pøíslu¹né homogenní rovnice je tvoøen funkcemi 
   $e^x\cos x$ a $e^x\sin x$.
   Proto¾e $0+\mathrm{i}$ není koøenem charakteristické rovnice (resp. je $0$-násobným koøenem),
   hledáme øe¹ení nehomogenní rovnice ve tvaru $y_p(x)=a\cos x+b\sin x$, kde $a,b\in\mathbb{R}$.
   Derivováním dostaneme
   \[
      (y''_p-2y'_p+2y_p)(x) = (a-2b)\cos x+(2a+b)\sin x
   \]
   a porovnáním s pravou stranou máme podmínky $a-2b=1$ a $2a+b=0$, odkud
   $a=1/5$ a $b=-2/5$, tak¾e obecné øe¹ení nehomogenní rovnice má tvar
   \[
      y(x) = \left(c_1e^x+\frac{1}{5}\right)\cos x+\left(c_2e^x-\frac{2}{5}\right)\sin x, \; c_1,c_2\in\mathbb{R}.
   \]
\end{sol}

\section*{Neøe¹ené pøíklady}

\begin{ex}
   Øe¹te diferenciální rovnice
   \begin{enumerate}
      \item $yy'=e^y$,
      \item $x+yy'=0$,
      \item $(x^2+1)(y^2-1)+xyy'=0$, $y(1)=\sqrt{2}$,
      \item $(x+1)y'+xy=0$, $y(0)=1$,      
      \bigskip
      \item $y'+\frac{y}{x}=x$,
      \item $y'-\frac{2}{x+1}y=(x+1)^3$,
      \bigskip
      \item $xy'-y=x^2y^{-1}$,
      \item $y'+xy=xy^3$,
      \bigskip
      \item $y''+y=(4x+2)\cos x+6\sin x$.
   \end{enumerate}
\end{ex}
\begin{sol}
   \begin{enumerate}
      \item $(1+y)e^{-y}=C-x$, $C\in\mathbb{R}$,
      \item $x^2+y^2=C$, $C\in\mathbb{R}$,
      \item obecné øe¹ení $\ln|y^2-1|+x^2+\ln x^2=C$, $C\in\mathbb{R}$; $C=1$, $y(x)=\sqrt{1+e^{1-x^2}/x^2}$,
      \item $y(x)=(x+1)e^{-x}$,
      %--
      \item $y(x)=\frac{x^2}{3}+\frac{C}{x}$, $x>0$, $C\in\mathbb{R}$,
      \item $y(x)=(\frac{1}{2}x^2+x+C)(x+1)^2$, $C\in\mathbb{R}$,
      %--
      \item $y^2=x^2(\ln\,x^2+C)$, $x>0$, $C\in\mathbb{R}$,
      \item $y(x)=\pm\frac{1}{\sqrt{1+Ce^{x^2}}}$, $C\in\mathbb{R}$,
      %--
      \item $y(x)=(c_1-2x)\cos x + (c_2+x^2+x)\sin x$
   \end{enumerate}
\end{sol}

