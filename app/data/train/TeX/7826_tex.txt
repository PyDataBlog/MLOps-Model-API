% Created 2017-11-05 Sun 16:32
% Intended LaTeX compiler: pdflatex
\documentclass[11pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{graphicx}
\usepackage{grffile}
\usepackage{longtable}
\usepackage{wrapfig}
\usepackage{rotating}
\usepackage[normalem]{ulem}
\usepackage{amsmath}
\usepackage{textcomp}
\usepackage{amssymb}
\usepackage{capt-of}
\usepackage{hyperref}
\usepackage{color}
\author{David Barr}
\date{\today}
\title{MMA2017 - Introduction to Yield Curves}
\hypersetup{
 pdfauthor={David Barr},
 pdftitle={MMA2017 - Introduction to Yield Curves},
 pdfkeywords={},
 pdfsubject={},
 pdfcreator={Emacs 25.2.1 (Org mode 9.1.2)}, 
 pdflang={English}}
\begin{document}

\maketitle
\setcounter{tocdepth}{1}
\tableofcontents







\section{A bit of history.}
\label{sec:orge75be2d}
\subsection{When did this happen?}
\label{sec:org8ef4f36}
\subsection{Why did the curve move as it did?}
\label{sec:org1380144}
\subsection{Yield curves produce a pretty good fit to observed yields.}
\label{sec:orga4a3385}
\section{What are yield curves used for?}
\label{sec:org38f66ea}
\begin{itemize}
\item To get a general, approximate, impression of where yields are, and how they have moved over time.
\item To guide bond traders in their general ‘curve plays’.
\item To generate estimates of expected future short rates and inflation.
\item To provide prices for new bonds.
\item To provide estimates of what an existing bond’s price ‘should’ be, or should return to.
\item To provide prices for bond derivatives.
\end{itemize}

\begin{center}
\includegraphics[width=.9\linewidth]{./3tierMarket.png}
\label{org62d1d72}
\end{center}

\section{How are they estimated, or calibrated?}
\label{sec:org6b6d423}
\subsection{Fitting a curve to observed coupon or zero-couopn bond ytm.}
\label{sec:orged6f67f}
\begin{itemize}
\item By hand (Durrand curves).
\item By fitting a curve for a single date as a function of maturity (e.g. McCulloch). E.g.
\[
    y_m = a + bm + cm^2 + dm^3 + \epsilon_m 
    \]
\begin{itemize}
\item We usually use splines for this.
\end{itemize}
\item The resulting curve will have estimation errors i.e. \(e_m = \hat{y}_m−y_m\)
\end{itemize}
\subsection{By estimating a (time-homogeneous) stochastic process for short rates.}
\label{sec:org69f3cc4}
\begin{itemize}
\item This can be used with raw yield data or with a fitted curve as above.
\item A simple process would be
\[
   y_{t+1} = \alpha + \beta y_{t} + \epsilon_{t+1}~~~~~~~\epsilon \sim id(0, \sigma)
   \]
\begin{itemize}
\item The parameters can be found from time-series, or cross-section data.
\item Either way we need \(\hat{\alpha}, \hat{\beta}\) \emph{and} a \(y\) value (usually \(y_t\)) to make it work.
\end{itemize}
\end{itemize}
\subsubsection{Time series data}
\label{sec:org0d4c309}
\begin{itemize}
\item Two \emph{times series} observations of \(y\) are sufficient for this example, but inefficient.
\end{itemize}
\subsubsection{Cross-sectional data}
\label{sec:orga2492f4}
\begin{itemize}
\item Two \emph{cross-section} yield observations are sufficient for \emph{calibration}, and may be efficient.
\begin{itemize}
\item For this we need to derive implied longer-rates from the process for short  rates.
\item We then fit the long-rate formulae to market long rates.
\item Candidate methods for the derivation include:
\begin{itemize}
\item An equilibrium model.
\item An expectations hypothesis - not great for use in asset pricing because these usually do not rule out arbitrage.
\item Risk neutral, i.e. no-arbitrage, pricing.
\end{itemize}
\end{itemize}
\end{itemize}
\subsubsection{What should we do with the fitted residuals?}
\label{sec:orgdebf740}
\begin{itemize}
\item \emph{Estimation} (TS and CS) requires a loss function (e.g. RSS) to be minimised.
\item Calibration/estimation with more observations than parameters leaves us with errors between the model and the market yields i.e. the model is over- identified by the data.
\begin{itemize}
\item Derivative pricing regards the errors as lost information.
\item The response is typically to remove them by either of the following:
\begin{itemize}
\item By estimating a short rate process with time-varying parameters e.g. Hull and White.
\item By estimating processes for forward rates instead of short rates e.g. Heath, Jarrow and Morton, and the LIBOR model. These are generally used to price volatility-interest rate derivatives.
\end{itemize}
\end{itemize}
\end{itemize}

\section{Bonds are not boring!}
\label{sec:orgaf10e72}
\subsection{Characteristics of daily, annualised,returns}
\label{sec:orga050c86}
\begin{itemize}
\item Sample: Daily 1993-2002
\item \(\rho(short,long) = 0.91\)
\item 
\end{itemize}
\begin{center}
\begin{tabular}{|rrrrrrr}
\hline
Index & Mean & S.Dev & Var & Min & Max & Obs\\
\hline
1-3 & 0.0234 & 0.1102 & 0.0121 & -1.0262 & 1.1083 & 2320\\
7-10 & 0.0303 & 0.4014 & 0.1611 & -2.5365 & 2.9542 & 2320\\
\hline
\end{tabular}
\end{center}

\begin{center}
\includegraphics[width=.9\linewidth]{./img/BondTRR.png}
\label{orgb6f910f}
\end{center}

\begin{center}
\includegraphics[width=.9\linewidth]{./img/BondTRX.png}
\label{org6e2a21e}
\end{center}



\begin{itemize}
\item If every day, A buys the index that performs better, B buys the other one.
\item A's portfolio rises by a factor of 24, B's declines by 85\%.
\item A also achieves a lower volatility.
\end{itemize}

\begin{center}
\begin{tabular}{l|rrrrrr}
\hline
Manager & Mean & S.Dev & Var & Min & Max & Obs\\
A & 0.1383 & 0.2665 & 0.0710 & -1.0262 & 2.9542 & 2320\\
B & -0.0846 & 0.2783 & 0.0774 & -2.5365 & 1.1083 & 2320\\
\hline
\end{tabular}
\end{center}


\begin{center}
\includegraphics[width=.9\linewidth]{./img/MaxTRX.png}
\label{org082e7b5}
\end{center}

\subsection{Prices, yields and rates of return.}
\label{sec:org3104d75}



\begin{figure}[htbp]
\centering
\includegraphics[width=.9\linewidth]{./bondPy.png}
\caption{\label{fig:org9457a9b}
A 10-yr zero-coupon bond on its way home.}
\end{figure}

\begin{figure}[htbp]
\centering
\includegraphics[width=.9\linewidth]{./bondHpr.png}
\caption{\label{fig:orgd35ccee}
A 10-yr zero-coupon bond disturbed on its way.}
\end{figure}

\begin{figure}[htbp]
\centering
\includegraphics[width=.9\linewidth]{./DMO-GiltsPrices-2010page1.png}
\caption{\label{fig:org823d5e1}
The DMO's 'price list'.}
\end{figure}

\begin{figure}[htbp]
\centering
\includegraphics[width=.9\linewidth]{./BBondYA.png}
\caption{\label{fig:org29b5409}
How Mike Bloomberg got rich.}
\end{figure}

\subsection{Some bond maths - and a little economics.}
\label{sec:org42c56b2}
\subsubsection{Bonds.}
\label{sec:orgb1f0558}
\begin{itemize}
\item The simplest bonds: 
\begin{itemize}
\item Bonds usually have a limited life i.e. they `mature'.
\item At maturity they provide a `redemption' or `maturity' payment to the bond holder.
\item `Coupon bonds' make regular coupon payments at fixed dates and of fixed amounts.
\item `Zero-coupon bonds' make payments only at maturity.
\item Coupons are usually paid every 6 months.
\item The total annual coupon amount is expressed as a percentage of the redemption payment.
\item So a 10$\backslash$% bond with a redemption of \pounds 100 pays \pounds 10 each year.
\end{itemize}
\end{itemize}

\begin{center}
\includegraphics[width=.9\linewidth]{./Bond-2yrZero.png}
\label{org46a8405}
\end{center}

\begin{center}
\includegraphics[width=.9\linewidth]{./Bond-10yrZero.png}
\label{org37829c1}
\end{center}


\begin{center}
\includegraphics[width=.9\linewidth]{./Bond-10yrCoupon.png}
\label{org32a5822}
\end{center}

\begin{center}
\includegraphics[width=.9\linewidth]{./Bond-10yrStrip.png}
\label{orge5c5718}
\end{center}

\subsubsection{Bond prices and yields.}
\label{sec:orgb36ed83}

\begin{itemize}
\item How much would you pay now to buy a  8-year 7.5\% bond?
\item How much would you pay now to receive £100 in 1 year?
\item The second question is the easier to answer.
\item Suppose your answer is 95.
\end{itemize}
\begin{itemize}
\item In bond markets we convert this to a discount rate \(r_1\) such that
\begin{equation}
95 = \frac{100}{1+r_1}
\end{equation}
\item In this example \(r_1 = 5.26\%\).
\item If the 100 were due in 2 years, and you were willing to pay 89 we'd find the 2-year discount rate as
\begin{equation}
89 = \frac{100}{(1+r_{2})^{2}}
\end{equation}
and get \(r_2 = 6\%\).
\end{itemize}
\begin{itemize}
\item It is convenient to approach bond pricing as if investors have some idea of their discount rates.
\item Investors then trade in financial markets and produce equilibrium, or 'economy-wide', discount rates.
\item We can then treat these as the inputs to pricing bonds.
\end{itemize}



\begin{center}
\includegraphics[width=.9\linewidth]{./DiscountRates.png}
\label{org8a6cb79}
\end{center}

\begin{center}
\includegraphics[width=.9\linewidth]{./DiscountRates-10yr.png}
\label{orgb19bbc0}
\end{center}


\begin{center}
\includegraphics[width=.9\linewidth]{./DiscountRates-10yrFormula.png}
\label{org685a9d4}
\end{center}


\subsubsection{From price to yield-to-maturity.}
\label{sec:org6ef2923}
\begin{eqnarray}
P_{c=10}(10yr) & = & \frac{10}{(1+r_{1})^{1}}  + \frac{10}{(1+r_{2})^{2}}+...+ \frac{110}{(1+r_{10})^{10}} \\
P_{c=10}(10yr) & = & \frac{10}{(1+y_{10})^{1}} + \frac{10}{(1+y_{10})^{2}}+...+ \frac{110}{(1+y_{10})^{10}}
\end{eqnarray}

\begin{center}
\includegraphics[width=.9\linewidth]{./Yield-10yrCoupon.png}
\label{orge173404}
\end{center}
\begin{itemize}
\item So\ldots{}

\begin{itemize}
\item The wider economy generates the discount rates \(r_t\).
\item Bond markets use these to generate bond prices \(P\).
\item \emph{We} make up a formula to calculate what we call `yield to maturity' (YTM)\(y\).
\end{itemize}
\begin{itemize}
\item YTM is an artificial construct that bears some relation to the rate of return from investing in the bond (but not much).
\end{itemize}
\end{itemize}

\subsection{Yield to maturity is not always the rate of return.}
\label{sec:orgb577aa8}
\begin{itemize}
\item Invest in a 2-year coupon bond costing 100, and with annual yield of y.
\item If \(y\) were the annual rate of return the value of the investment in 2 years would be
\[V = 100(1+y)^2 \]
\item We know the relationship between price and yield is
\[100 = \frac{C}{1+y} + \frac{100+C}{(1+y)^2} \]
which implies that
\[ 100(1+y)^2 = C(1+y) + (100+C)\]
\item This shows that we achieve \(V=100(1+y)^2\) only if we reinvest the first coupon at the yield \(y\).
\begin{itemize}
\item While not impossible this is rather unlikely, particularly in the case of bonds of longer maturity.
\end{itemize}
\end{itemize}
\section{Bond pricing.}
\label{sec:orgaf1e799}
\subsection{The expectations hypothesis.}
\label{sec:org246e05e}
\begin{itemize}
\item There are many versions of this.
\item The logarithmic \emph{'unbiased expectations'} version, with risk premia omitted,is
\[
  \tilde{y}_n(t) = \frac{1}{n} \left(\tilde{y}_1(t) + E_t[\tilde{y}_1(t + 1)] + ...+E_t[\tilde{y}_1(t+n−1)]\right)
  \]
where \(\tilde{y}_1(n)= ln(1+y_1(n))\) and \(y_{1}(n)\) is the 1-period yield for the period starting at \(n\), ending at \(n + 1\).
\item This implies that the whole curve is a function of expectations of future short rates.
\item We then use observed yields to find estimates of the parameters \(\alpha\) and \(\beta\) that we saw earlier.
\end{itemize}
\begin{itemize}
\item Observations of k rates being enough to provide values for k parameters in the short-rate process. 
\begin{itemize}
\item So > 3 yields will over-identify the following process for the log rate:
\end{itemize}
\[
   \tilde{y}_{t+1} = \alpha + \beta  \tilde{y}_{t} + \epsilon_{t+1}~~~~~~~\epsilon \sim nid(0, \sigma)
  \]
\end{itemize}
\begin{itemize}
\item For example, if the yield curve starts
\end{itemize}
\begin{center}
\begin{tabular}{lr}
\(\tilde{y}_1(t)\) & 0.05\\
\(\tilde{y}_2(t)\) & 0.0475\\
\(\tilde{y}_3(t)\) & 0.04583'\\
\end{tabular}
\end{center}
we have
\begin{eqnarray}
\tilde{y}_2(t) & = & \frac{1}{2}\left(\alpha + (1+\beta)  \tilde{y}_1(t)\right)\\
\tilde{y}_3(t) & = & \frac{1}{3}\left( \alpha+\alpha(1+\beta) + (1+\beta + \beta^2)  \tilde{y}_1(t)\right)
\end{eqnarray}
\begin{itemize}
\item This can be solved for
\begin{eqnarray}
\alpha & = & 0.02 \\
\beta & = & 0.5
\end{eqnarray}
from which the implied yield of any maturity \(n\) can be calculated.
\item Note that we cannot identify \(\sigma\) from cross-sectional data using this version of the expectations hypotheis.
\end{itemize}
\subsection{No-arbitrage pricing of interest rate derivatives: introduction.}
\label{sec:orga469d3a}
\subsubsection{Why is this different from pricing stock derivatives?}
\label{sec:orgedebb60}
\begin{itemize}
\item Applying the risk-neutral pricing equation that we saw earlier would give us
\[
  P(t,T) = \frac{1}{R(t,T)}\hat{E}[P(T,T)]
  \]
\item With \emph{non-stochastic short rates} \(y_1\) this becomes:
\[
  P(t,T) = \frac{1}{(1+y_1(t))}\frac{1}{(1+y_1(t+1))}...\frac{1}{(1+y_1(T-1))}\hat{E}[P(T,T)]
   \]
\end{itemize}
\begin{itemize}
\item BUT we now have to deal with \emph{stochastic short rates} so we have
\[
   P(t,T) = \hat{E}\left[\frac{1}{(1+y_1(t))}\frac{1}{(1+y_1(t+1))}...\frac{1}{(1+y_1(T-1))}P(T,T)\right]
   \]
\item We do benefit from the \emph{price} at maturity being non-stochastic though.
\end{itemize}
\subsubsection{We will need a stochastic process for interest rates.}
\label{sec:org50152f6}
\begin{itemize}
\item One approach is to use a process for the short-rate.
\item Something like \(dr = \mu(r,t)dt + \sigma(r,t)d\hat{z}\).
\item We can start with a continuous-time process, and use Ito etc.
\item Or with a discrete-time approximation.
\end{itemize}
\subsection{Then what? Continuous-time solutions}
\label{sec:org9890fdb}
\begin{itemize}
\item As before, we want to estimate, or calibrate, the model to fit the observed data.
\item First we have to construct formulae for the implied prices.
\item Let a bond have price \(V(r,t,T)\), then Ito's Lemma gives us
\[
  dV = \left(V_t+\mu(r,t)V_r +\frac{1}{2} \sigma(r,t)^2V_{rr}\right) dt + \sigma V_r d\hat{z} 
  \]
\end{itemize}
\begin{itemize}
\item Under the risk-neutral measure,
\[
  \hat{E}_t\left[\frac{dV}{V}\right] = r~dt~~~~~~~~\mbox{WHY?}
  \]
hence,
\[
  rV = \left(V_t+\mu(r,t)V_r +\frac{1}{2} \sigma(r,t)^2V_{rr}\right)  
  \]
\item I.e. a (Black-Scholes) pde that we can solve for \(V(r,t,T)\).
\end{itemize}
\subsubsection{Example: Merton’s model}
\label{sec:org2f2f60f}

\begin{itemize}
\item We have,
\end{itemize}
\begin{eqnarray}
dr & = & \mu dt + \sigma d\hat{z} \\
rV & = & \left(V_t+\mu V_r +\frac{1}{2} \sigma^2V_{rr}\right)  
\end{eqnarray}
\begin{itemize}
\item The model is \emph{'affine'}\ldots{}
\end{itemize}
\begin{itemize}
\item \ldots{}which means that its price equations look like 
\[
  V(r,t,T) = e^{A(T-t) + B(T-t)r}
  \]
where \(A\) and \(B\) are functions of \(T-t\).
\item In this case, the solution is known to have the restricted form, 
\[
  V(r,t,T) = e^{ \tilde{A}(T-t) - (T-t)r(t)} 
  \]

hence,
\begin{eqnarray}
V_t     & = & ( \tilde{A}_t+r(t))V \\
V_r     & = & -(T-t)V \\
V_{rr}  & = & (T-t)^2V
\end{eqnarray}
\end{itemize}
\begin{itemize}
\item Substituting in the BS-pde,
\begin{eqnarray}
 \tilde{A}_t + r - \mu(T-t) + \frac{1}{2} \sigma^2(T-t)^2 & = & r   \\
 \tilde{A}_t  - \mu(T-t) + \frac{1}{2} \sigma^2(T-t)^2 & = & 0 \\
\end{eqnarray}
\item Given that \(A(T,T) = 0\) this solves as 
\[
  \tilde{A}(t,T) = -\frac{1}{2} (T-t)^2 \mu + \frac{1}{6} (T-t)^3 \sigma^2
  \]
\end{itemize}

\subsubsection{Final Merton solution.}
\label{sec:orge149fd3}
\begin{itemize}
\item Thus the Merton bond price is
\[
  V(r,t,T) = e^{ \left(-\frac{1}{2} (T-t)^2 \mu + \frac{1}{6} (T-t)^3 \sigma^2\right)-(T-t)r(t)}
  \]
\item This is often written as
\[
  V(r,t,T) = A(t,T) e^{B(t,T)r(t)}
  \]
where
\begin{eqnarray}
A(t,T) & = & e^{ \left(-\frac{1}{2} (T-t)^2 \mu + \frac{1}{6} (T-t)^3 \sigma^2\right)}\\
B(t,T) & = & -(T-t)
\end{eqnarray}
\end{itemize}
\section{Definition of affine term structure models.}
\label{sec:orgf8b2752}

\begin{itemize}
\item We will treat the terms 'affine' and 'linear' as equivalent (in other contexts 'linear' does not permit the presence of a constant).
\item The 'affine' part refers to the relationship between the continuously compounded rate \(R(t,T)\) and the short rate \(r(t)\) i.e. 
\begin{equation}
R(t,T) = \alpha(t,T) + \beta(t,T) r(t)
\end{equation}
where \(\alpha\) and \(\beta\) are deterministic.
\end{itemize}
\begin{itemize}
\item It it usually written in price form however i.e. 
\begin{equation}
P(t,T) = A(t,T)e^{-B(t,T)r(t)}
\end{equation}
\item or, equivalently,
\begin{equation}
P(t,T) = e^{\tilde{A}(t,T)-B(t,T)r(t)}
\end{equation}
\end{itemize}



\subsubsection{Definitions of \(\alpha\) and \(\beta\).}
\label{sec:orgb6a8ac6}


\begin{itemize}
\item From the relationship \(P(t,T)= R(t,T)^{-(T-t)}\) we get,  
\begin{eqnarray}
\alpha(t,T) & = & -\frac{\ln A(t,T)}{T-t} \\
\beta(t,T) & = & \frac{ B(t,T)}{T-t}
\end{eqnarray}
\end{itemize}



\subsubsection{Why is the affine distinction useful?}
\label{sec:orgdf88af0}


\begin{itemize}
\item If we can identify a process as affine finding the solution for the price equation becomes much easier.
\item We will know the general form of the solution, and can substitute it into the pde to fill in the details.
\end{itemize}




\subsubsection{Affine models and the short-rate process.}
\label{sec:orgd28538f}


\begin{itemize}
\item The term structure (i.e. the bond prices) will be affine if \(\
  mu(t,r(t)\) and \(\sigma^2(t,r(t))\) are affine in \(r(t)\)
\item That is, if in
\begin{equation}
dr(t) = \mu(t,r(t))dt + \sigma(t,r(t)) dW(t)
\end{equation}
we have,
\begin{eqnarray}
\mu(t,r(t)) & = & \eta(t) + \gamma(t)r(t) \\
\sigma^2(t,r(t) & = & \phi(t) + \psi(t) r(t)
\end{eqnarray}
\item This is an `affine coefficients' (AC) model
\end{itemize}
\end{document}