% definit le type de document et ses options
\documentclass[a4paper,11pt]{article}

% des paquetages indispensables, qui ajoutent des fonctionnalites
\usepackage[latin1]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb}
\usepackage{fullpage}
\usepackage{graphicx}
\usepackage{url}
\usepackage{xspace}
\usepackage[francais]{babel}
% on rajoute ce package pour inserer du code
\usepackage{listings}
\lstset{language=Scilab}

% pour ecrire les reponses
\newtheorem{exercice}{Exercice}

% des commandes utiles pour ecrire des maths : rajoutez les votres!
\newcommand{\dx}{\,dx}
\newcommand{\ito}{,\dotsc,}
\newcommand{\R}{\mathbb{R}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Poly}[1]{\mathcal{P}_{#1}}
\newcommand{\abs}[1]{\left\lvert#1\right\rvert}
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}
\newcommand{\pars}[1]{\left(#1\right)}
\newcommand{\bigpars}[1]{\bigl(#1\bigr)}
\newcommand{\set}[1]{\left\{#1\right\}}

% titre, auteur et date
\title{Mini-stage Scilab/Latex}
\author{Cyprien Courtot, Thibault Meuret}
\date{\today}

% le debut du contenu
%===============
\begin{document}
%===============

% pour afficher titre, auteur et date
\maketitle


\section{Sensibilisation \`{a} l'arithm\'{e}tique machine}
\begin{exercice}
On obtient:
$$z = 0$$
$$w = 1$$

SciLab respecte donc les priorit\'{e}s de calculs mais n\'{e}glige y devant x dans z.
Et donc l'expression de z devient:
$$z = \frac{x-x}{y} = 0$$
Pour w, les parenth\`{e}ses emp\`{e}chent l'erreur pr\'{e}c\'{e}dente d'arriver.\\
Rq : il faudrait r\'{e}ussir \`{a} d\'{e}terminer selon quelles crit\`{e}res y devient n\'{e}gligable devant x pour SciLab.
\end{exercice}


\begin{exercice}
Ici on d\'{e}coupe l'intervalle [0;4] en 1000 points, puis on trace la courbe de f(x) avec f d\'{e}finie dans l'\'{e}nonc\'{e} (cf. le fichier exo\_2.sce).
On obtient le graphe suivant :

\begin{figure}[!ht]
\begin{center}
  \includegraphics[width=10cm]{reponse_ex_2.pdf}
\end{center}
\end{figure}

Les calculs sont faits avec les arrondis (pas de maniere formelle) d'o\`{u} le trace incorrect : 
lors du calcul de $x^{1/2^{128}}$, sur [0;1[ le r\'{e}sultat est arrondi à 0 et sur [1;4[ il est arrondi a 1.
D\`{e}s lors, on a le graphique de : 
$$x \mapsto 0^{2^{128}} sur\ [0;1[\ et\  x \mapsto 1^{2^{128}} sur\ [1;4[$$
\end{exercice}

\begin{exercice}
On cherche \`{a} calculer la valeur de l'int\'{e}grale:
$$ I_{20} = \int_0^1 x^{20}\exp(x)dx $$
\begin{enumerate}
\item On cherche tous d'abord \`{a} trouver une formule de r\'{e}currence pour calculer $I_{20}$.
On utilise une int\'{e}gration par partie et on trouve cette relation de recurrence:
$$ I_{20} = \exp(1) - 20I_{19} $$

On peut donc \'{e}valuer $I_{20}$ en fonction de $I_0$ avec SciLab.
Et l'on trouve par r\'{e}currence:
$$ I_{20} \approx 410.9 $$ 
Cette valeur est absurde puisque l'on a:
$$ I_{20} = \int_0^1 x^{20}\exp(x)dx \leq \int_0^1 \exp(x)dx \approx 1.718 $$
On peut d'ailleurs utiliser la formule de propagation des incertitudes avec une incertitude de d\'{e}part sur $ \Delta I_0 = eps $
$$ \Delta I_{20} = 20\Delta I_{19} = 20!\Delta I_0 \approx 540 $$
Ce qui montre bien qu'utiliser une formule de r\'{e}currence pour calculer $I_{20}$ ne peut pas donner de r\'{e}sultats pr\'{e}cis.

\item Cette fois-ci on va utiliser le d\'{e}veloppement en s\'{e}rie enti\`{e}re de $exp(x)$:
$$ I_{20} = \int_0^1 \sum_{n=0}^{\infty} \frac{x^{n+20}}{(n)!}dx $$
Pour $ n > 0 $, $ x \mapsto x^n $ est int\'{e}grable et continue sur [0,1], et, $ \sum_{n=0}^{\infty} \frac{1}{(n+21)(n)!}  $ est clairement convergente.

On peut donc intervertir les signes $\Sigma$ et $\int$.
On approxime alors le r\'{e}sultat final avec SciLab, via la fonction pr\'{e}sente dans le fichier exo3\_q2.sce, en sommant de 0 \`{a} 100.000 :
$$ \sum_{n=0}^{100000} \frac{1}{(n+21)(n)!} \approx 0.1238038  $$

\item Pour conclure, contrairement à la r\'{e}currence qui amplifie grandement les impr\'{e}cisions de calculs, utiliser une s\'{e}rie pour calculer
$I_{20}$ semble etre bien plus pr\'{e}cis car Scilab manipule des nombres entiers.
\end{enumerate}
\end{exercice}

\begin{exercice}
La fonction I=rectangle(n) est d\'{e}finie par le code pr\'{e}sent dans le fichier rectangle.sce ; elle utilise la m\'{e}thode des rectangles sup\'{e}rieurs (RS) \\
Avec $n = 1000000$, on obtient $rectangle(1000000)= 0.1238052$; on retrouve alors le r\'{e}sultat obtenu a la question 3.2
\end{exercice}

%====================================
\section{Etude du ph\'{e}nomene de Gibbs}
\begin{exercice}
On cherche d'abord les coefficients de Fourier de la fonction f.
Puisque f est une fonction impaire $\forall n \geq 0, a_n = 0$
et $b_n$ s'obtient avec la formule :
$$ b_n = 2\int_{\frac{-1}{2}}^{\frac{1}{2}}f(t)\sin(2{\pi}nt)dt $$
Et nous obtenons apr\`{e}s calculs :
$$ \forall n \geq 0, b_{2n} = 0 $$
$$ b_{2n+1} = \frac{4}{(2n+1)\pi} $$
f est un fonction 1-périodique, continue par morceaux et $C^1$ par morceaux sur $]\frac{-1}{2},\frac{1}{2}]$, 
donc d'après le Th\'{e}oreme de Dirichlet,
$$f(x)= \frac{4}{\pi} \sum_{n=0}^{\infty} \frac{\sin(2(2n+1){\pi}x)}{2n+1} \iff f\ est\ continue\ en\ x$$
On en d\'{e}duit l'ensemble $D$ des points o\`{u} il y a \'{e}galit\'{e},
$$ D = \mathbb{R}\!\setminus\{\frac{k}{2}\ |\ k\in\mathbb{Z}\ \} $$
\end{exercice}

\begin{exercice}
On trace la s\'{e}rie de Fourier tronqu\'{e}e de la fonction f:
\begin{figure}[!ht]
\begin{center}
  \includegraphics[width=10cm]{exo6.pdf}
  \caption{Trac\'{e} de la s\'{e}rie de Fourier pour Ntermes = 5 (rouge), 20 (vert) et 50 (bleu)}
\end{center}
\end{figure}\\
On constate l'apparition d'oscilliations amorties autour des points de discontinuit\'{e} dont l'amplitude d\'{e}croit lorsque Ntermes croit. \\
Il y a convergence simple, mais non uniforme de la série de Fourier.
\end{exercice}

\section{Th\'{e}oreme de Gersch\"{o}rin}
\begin{exercice}
1. En notant 
\begin{math}
x_k =
\begin{pmatrix}
   x_1 \\
   x_2 \\
   \ldots \\
   x_N 
\end{pmatrix}
\end{math} 
le vecteur propre associ\'{e} \'{a} la valeur propre $\lambda_k$ de A, la d\'{e}finition du produit matriciel donne :
$$\forall j \in [\!\lvert1;n\rvert\!], \sum_{i=1}^{N} a_{ij} x_i  = \lambda_k x_j \Longleftrightarrow \sum_{i=1,i \neq j}^{N} a_{ij} x_i = (\lambda_k - a_{jj})x_j \ \ (1) $$ \\
Or, 
\begin{math}x_k =
\begin{pmatrix}
   x_1 \\
   x_2 \\
   \ldots \\
   x_N 
\end{pmatrix}
\end{math} est une valeur propre donc il existe un $x_j \neq 0$ v\'{e}rifiant : $\forall i \in [\!\lvert1;n\rvert\!] , i \neq j , \mid x_j \mid \succeq \mid x_i \mid$
\\
\\
D\'{e}s lors, en passant au module dans $(1)$, on obtient: \\
$$ \mid (\lambda_k - a_{jj})\mid = \frac{1}{\mid x_j \mid} \mid \sum_{i=1, i\neq j}^{N} a_{ji} x_i\mid $$
$$ \preceq \sum_{i=1, i\neq j}^{N} \mid a_{ji}\mid \frac{\mid x_i\mid}{\mid x_j\mid} $$
$$ \preceq \sum_{i=1, i \neq j}^{N}\mid a_{ji}\mid $$
\\
Ainsi, pour tout $\lambda_k$, on a $\lambda_k \in D_j$, donc $\lambda_k \in \bigcup_{m=1,...,N} D_m$.
On a bien d\'{e}montr\'{e} le th\'{e}orème de l'\'{e}nonc\'{e}.\\
\\

2. On d\'{e}compose le trac\'{e} de l'ensemble des disques de Gerschg\"{o}rin en 2 fonctions. La premi\`{e}re, nomm\'{e}e exo7\_k\_cercle.sce est capable de tracer $D_k$ \`{a} k fix\'{e}
pour une matrice A donn\'{e}. La seconde, nomm\'{e}e exo7\_cercles d\'{e}termine la dimension de la matrice carr\'{e}e A, puis trace les $D_k$ pour k allant de 1 \`{a} la dimension de A. \newpage

3. Avec la fonction specs de SciLab on d\'{e}termine les valeurs propres de A puis on les affiche sur un graphique avec exo7\_pour\_A.sce:
\begin{figure}[!ht]
\begin{center}
  \includegraphics[width=12cm]{reponse_ex_7.pdf}
  \caption{En rouge les disques de Gerschg\"{o}rin pour A, les croix noires repr\'{e}sentent les valeurs propres de A qui sont bien dans $\bigcup_{k=1,...,3} D_k$}
\end{center}
\end{figure} \\
\\
4. Pour montrer qu'une matrice est inversible, on peut utiliser la propri\'{e}t\'{e} suivante :
\begin{center}
A non inversible $\Longleftrightarrow 0 \in Spectre(A) $\\
\end{center}
Si A est \`{a} diagonale strictement dominante, on constate que $ \forall k \in N, 0 \notin D_k $. Or, d'apr\`{e}s la premi\`{e}re question $ Spectre(A) \subset \bigcup_{m=1,...,N} D_m $. \\
D\`{e}s lors : 
\begin{center}
A \`{a} diagonale strictement dominante $\Rightarrow 0 \notin Spectre(A) \Rightarrow $ A inversible
\end{center}

\end{exercice}

%Pour obtenir le document PostScript, il faut taper les commandes:
%\begin{verbatim}
%latex rapport.tex
%\end{verbatim}
%puis, au choix
%\begin{verbatim}
%dvips rapport.dvi -o rapport.ps
%dvipdf rapport.dvi
%\end{verbatim}

%On peut visualiser le fichier obtenu avec
%\begin{verbatim}
%gv rapport.ps
%\end{verbatim}
%ou le fichier \verb+.dvi+ intermÃ©diaire avec
%\begin{verbatim}
%xdvi rapport.dvi
%\end{verbatim}

%Bon courage !

% fin du document
%=============
\end{document}
%=============
