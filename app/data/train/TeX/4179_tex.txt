% !Mode:: "TeX:UTF-8"

\BiChapter{实验测试与验证}{Experiment}
%
%\section{仪器组装}

\section{仪器功能测试}

\subsection{测试环境}

\begin{figure}[hbtp]
  \centering
  \includegraphics[width=0.6\textwidth]{IMG_20160628_151832.jpg}
  \caption{便携式设备面板}\label{fig_device}
\end{figure}

仪器采用索奇10寸触摸屏，利用USB鼠标/手指对计算机操作，触摸屏上安装了2个USB数据采集卡、1个GPRS数据透传模块、12 V电源、5 V电源、信号调理板，气室信号通过面板接口连接到信号调理板。设备外观如图\ref{fig_device}所示。
%
%\subsection{开机测试}

\subsection{波形显示测试}

\begin{figure}[hbtp]
  \centering
  \includegraphics[width=0.8\textwidth]{scr_ad.png}
  \caption{传感器AD采集界面}\label{fig_screen_ad}
\end{figure}

气室传感器安装了三个测试电阻，分别对应AD采集卡通道1/3/4，调整测试电阻的分压，利用程序采集显示的电压波形如图\ref{fig_screen_ad}所示，从波形图读取的电压与万用表测量的电压相一致。

\subsection{输出波形验证}

\begin{figure}[hbtp]
  \centering
  \includegraphics[width=0.8\textwidth]{scr_da.png}
  \caption{加热信号电压检测界面}\label{fig_screen_da}
\end{figure}

\begin{figure}[hbtp]
  \centering
  \includegraphics[width=0.8\textwidth]{scr_da_settings.png}
  \caption{加热信号电压设置界面}\label{fig_screen_da_settings}
\end{figure}

数据采集卡输出加热信号给加热电阻，为了排除故障方便，在采集卡内部通过AD采集了输出的加热信号，分别对应通道1/3/4，如图\ref{fig_screen_da}所示，设置输出波形的界面如图\ref{fig_screen_da_settings}所示。采集的波形比较平滑，与示波器显示的波形相一致，如图\ref{scope_screen_da}所示。

\begin{figure}[hbtp]
  \centering
  \includegraphics[width=0.8\textwidth]{8934DD8042BDB49C254BCDAF24080BD1.jpg}
  \caption{示波器采集的加热信号}\label{scope_screen_da}
\end{figure}

%\subsection{驱动控制测试}

\subsection{上位机通信测试}

\begin{figure}[hbtp]
  \centering
  \includegraphics[width=\textwidth]{scr_putty.png}
  \caption{服务器数据记录}\label{screen_putty}
\end{figure}

服务器记录了设备运行日志，包括设备运行状态和有效数据，利用putty软件通过ssh登陆服务器查看到的服务器的设备运行如图\ref{screen_putty}所示，显示服务器能够正常接受设备发送的数据，也能够通过浏览器给设备发送命令，更改设备的运行状态，设备的运行状态进一步地实时反馈给服务器。

\section{监控平台测试}

\subsection{测试环境}

监控平台部署在阿里云的云主机上，地理位置在北京，操作系统采用Gentoo Linux，运行nginx Web静态服务器。管理员通过ssh登陆服务器操作。

\subsection{远程测控功能验证}

\begin{figure}[hbtp]
  \centering
  \includegraphics[width=0.8\textwidth]{server_client.png}
  \caption{客户端日志}\label{server_client}
\end{figure}

图\ref{server_client}展示了服务器上的客户端日志，上面显示了浏览器访问服务器的时间、客户端数量等信息。

\begin{figure}[hbtp]
  \centering
  \includegraphics[width=0.8\textwidth]{server_post.png}
  \caption{设备命令日志}\label{server_post}
\end{figure}

图\ref{server_post}展示了服务器接受到来自客户端的命令，上面指定了设备的id号和运行状态的切换，经过测试显示浏览器的命令能可靠地发送到服务器上。

\begin{figure}[hbtp]
  \centering
  \includegraphics[width=0.8\textwidth]{screen_browser.png}
  \caption{浏览器页面}\label{screen_browser}
\end{figure}

图\ref{screen_browser}展示了浏览器访问监控平台的界面，经过测试显示设备的数据能够发送到所有访问该设备的客户端浏览器上，数据在网页上通过波形图和表格展示。

\subsection{稳定性验证}

设备与服务器连续进行8小时的工作，结果发现设备在8小时工作之后没有异常，证明了设备和服务器程序的稳定性。

%\section{案例实测}

\section{本章小结}

本章展示了仪器和监控平台的测试结果。对仪器测试了电压采集功能、波形输出功能和数据通信功能。经过测试显示程序显示结果与利用电压表、示波器等仪器测试的结果一致，证明了程序的正确性；设备经过长时间的工作（8小时）没有出现异常，证明了设备硬件和通信协议的稳健性。对监控平台验证了设备通信功能、数据广播功能和命令转发功能，结果显示服务器能正确接收设备的数据、从客户端接收命令后给设备转发，符合服务器程序的设计要求。并且在长时间的工作状态下（8小时）没有出现异常，证明了服务器通信程序的稳定性。