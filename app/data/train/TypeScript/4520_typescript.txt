import * as _ from "lodash";

import * as reducer from "./reducers";

import {ReduxAction} from "./create-action";
import {Store, initialState} from "./store";

export default function rootReducer(store: Store = initialState, action: ReduxAction): Store {
    if (action.error) {
        // FIXME move the action in isLoading=false,error=_error(action.payload) [atomic]
        return store;
    }

    // FIXME move the action in isLoading=false,error=undefined [atomic]

    // FIXME
    if (_.isNil(action.meta) === false && _.isNil(action.meta.caller) === false) {
        console.log({
            actionCaller: action.meta.caller
        });
    }

    return {
// >>> call(reducer)
        __TemplateAction__: reducer.__TemplateAction__(state.__TemplateAction__, action)
// <<< call(reducer)
    };
}
