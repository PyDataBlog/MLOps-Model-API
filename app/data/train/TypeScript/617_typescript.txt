import {grpc, Code, Metadata} from "grpc-web-client";
import {DummyService} from "../_proto/dummy/dummy_service_pb_service";
import {CreateGameRequest, CreateGameResponse} from "../_proto/dummy/dummy_service_pb";

declare const USE_TLS: boolean;
const host = USE_TLS ? "https://web.ae.28k.ch:9091" : "http://web.ae.28k.ch:9090";

function createGame() {
  const createGameRequest = new CreateGameRequest();
  grpc.unary(DummyService.CreateGame, {
    request: createGameRequest,
    host: host,
    onEnd: r => {
      const {status, message} = r;
      var wtf = (m: CreateGameResponse) => { return m.getId(); }
      if (status === Code.OK && message) {
        var response = message as CreateGameResponse;
        console.log("getBook.onEnd.message", message.toObject());
	wtf(response);
      }
    }
  });
}

createGame();
