<link rel="import" href="../bower_components/polymer/polymer.html">

<link rel="import" href="../bower_components/core-pages/core-pages.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/facebook-login/facebook-login.html">
<!--<link rel="import" href="../bower_components/fontawesome-icon/fontawesome-icon.html">-->

<link rel="import" href="claimed-controller.html">
<link rel="import" href="claimed-login.html">
<link rel="import" href="claimed-map.html">
<link rel="import" href="claimed-button.html">

<x-fontawesome></x-fontawesome>
<polymer-element name="claimed-app" block>
  <template>
    <style>
      ::content > .core-selected {
        position: relative;
        display: block;
        z-index: 10;
      }
      
      claimed-map {
        position: absolute;
        z-index: 0;
      }
      
      core-pages {
        position: relative;
        z-index: 1;
      }
      
      claimed-button {
        font-size: 3em;
        display: inline;
      }
    </style>

    <claimed-controller user="{{user}}" location="{{location}}" state="{{state}}"></claimed-controller>

    <core-pages selected="{{state}}" fit>
      <claimed-login name="login" user="{{user}}" on-connected="{{state = 'map'}}" on-disconnected="{{state = 'login'}}"></claimed-login>
      <div name="claim" style="text-align: center;">
        <div style="height: 50%; padding-top: 13em; box-sizing: border-box;">
          <claimed-button icon="user"> User</claimed-button>
        </div>

        <div style="height: 50%; padding-top: 6.5em; box-sizing: border-box;">
          <claimed-button icon="flag" disable="{{!location}}"> Claim</claimed-button>
          <br/>
          <template if="{{!location}}">
            <span style="position:relative; top:-1.5em; color: #ffd600;">
              <!--<fontawesome-icon value="fa fa-warning"></fontawesome-icon>-->
              Enable Geolocation to play
            </span>
          </template>
        </div>
      </div>
    </core-pages>

    <core-ajax auto url="claims/{{user.id}}" method="GET" handleAs="json" on-core-response="{{handleResponse}}"></core-ajax>
    <core-ajax auto url="claim/{{user.id}}" method="POST" params="{{  }}" handleAs="json" on-core-response="{{handleResponse}}"></core-ajax>
    <claimed-map location="{{location}}" fit class="background"></claimed-map>
  </template>
  <script>
    Polymer('claimed-app', {
      created: function () {},
      ready: function () {
        console.dir(this);
      },
      attached: function () {},
      domReady: function () {},
      detached: function () {},
      attributeChanged: function (attrName, oldVal, newVal) {
        //var newVal = this.getAttribute(attrName);
        console.log(attrName, 'old: ' + oldVal, 'new:', newVal);
      },
    });
  </script>
</polymer-element>