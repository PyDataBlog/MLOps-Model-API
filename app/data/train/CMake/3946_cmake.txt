#
# External build for googletest (gtest)
#
if(NOT DEFINED GOOGLETEST_TARGET)
    set(GOOGLETEST_TARGET ${3RDPARTY_INSTALL_PREFIX}/googletest)
endif()

ExternalProject_Add(googletest
    GIT_REPOSITORY "https://github.com/google/googletest.git"
    GIT_TAG ${GOOGLETEST_VERSION}
    PREFIX ${3RDPARTY_BUILD_PREFIX}/googletest
    CMAKE_ARGS
        -DCMAKE_INSTALL_PREFIX:PATH=${GOOGLETEST_TARGET} 
)

list(APPEND GOOGLETEST_CMAKE_ARGS
    "-DGOOGLETEST_ROOT:PATH=${GOOGLETEST_TARGET}"
    "-DGOOGLETEST_INCLUDE_DIR:PATH=${GOOGLETEST_TARGET}/include"
    "-DGOOGLETEST_LIBRARY_DIR:PATH=${GOOGLETEST_TARGET}/lib"
)
list(APPEND EXT_CMAKE_ARGS "${GOOGLETEST_CMAKE_ARGS}")

# This will export the above variables to a file as 'set()' statements

WRITE_ARGS_TO_FILE("googletest" ${3RDPARTY_VARIABLE_EXPORT_DIR} "${GOOGLETEST_CMAKE_ARGS}")