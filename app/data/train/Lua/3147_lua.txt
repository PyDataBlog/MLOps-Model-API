require"shapes"
require"colors"
require"figure"

FiguresPool = {}

FiguresPool.figures = {}

function FiguresPool:Init()
  self.figuresCount = 0
  -- for each figure shape
  for _, shape in ipairs(SHAPES) do
    table.insert(self.figures, Figure:New(shape))
    self.figuresCount = self.figuresCount + 1
  end
  self.currentFigure = 1
end

function FiguresPool:GetFigure(figureIndex, color)
  assert(figureIndex >= 1 and figureIndex <= self.figuresCount,
    "Invalid figure " .. figureIndex, 2)
  self.currentFigure = figureIndex
  local figure = self.figures[figureIndex]
  figure:Reset()
  figure.color = color
  return figure
end

function FiguresPool:GetRandomFigure()
  return self:GetFigure(math.random(1, self.figuresCount),
                        COLORS[math.random(2, 8)])
end
