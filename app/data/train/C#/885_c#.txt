using System;
using System.Globalization;
using System.Resources;
using System.Diagnostics;
using System.Reflection;

namespace Routrek.SSHC 
{
	/// <summary>
	/// StringResource ÌTvÌà¾Å·B
	/// </summary>
	internal class StringResources {
		private string _resourceName;
		private ResourceManager _resMan;

		public StringResources(string name, Assembly asm) {
			_resourceName = name;
			LoadResourceManager(name, asm);
		}

		public string GetString(string id) 
		{
			try
			{
				return _resMan.GetString(id); //àµ±êªx¢æ¤Èç±ÌNXÅLbVÅàÂ­êÎ¢¢¾ë¤
			}
			catch
			{
				return "error loading string";
			}
		}

		private void LoadResourceManager(string name, Assembly asm) {
			//ÊÍpêEú{êµ©µÈ¢
			CultureInfo ci = System.Threading.Thread.CurrentThread.CurrentUICulture;
			//if(ci.Name.StartsWith("ja"))
				//_resMan = new ResourceManager(name+"_ja", asm);
			//else
			_resMan = new ResourceManager(name, asm);
		}
	}
}