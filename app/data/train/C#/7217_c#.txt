using System;

namespace DMTools.Tidier
{
    class TidierTools
    {
        public static bool IsPathToClangTidyValid( string path )
        {
            return System.IO.File.Exists( path ) && System.IO.Path.GetFileName( path ).ToLower() == "clang-tidy.exe";
        }

        public static string TryFindPathToClangTidy()
        {
            // TODO: temp version - revrite to better, e.g. use PATH
            string tidyExe = @"LLVM\bin\clang-tidy.exe";
            string tidyExeProgramFiles = System.IO.Path.Combine( Environment.GetEnvironmentVariable( "ProgramW6432" ), tidyExe );
            if( System.IO.File.Exists( tidyExeProgramFiles ) )
            {
                return tidyExeProgramFiles;
            }

            string programFiles86 = Environment.GetFolderPath( Environment.SpecialFolder.ProgramFilesX86 );
            if( !string.IsNullOrEmpty( programFiles86 ) )
            {
                tidyExeProgramFiles = System.IO.Path.Combine( programFiles86, tidyExe );
                if( System.IO.File.Exists( tidyExeProgramFiles ) )
                {
                    return tidyExeProgramFiles;
                }
            }

            if( System.IO.File.Exists( @"C:\LLVM\bin\clang-tidy.exe" ) )
            {
                return @"C:\LLVM\bin\clang-tidy.exe";
            }

            return "";
        }
    }
}
