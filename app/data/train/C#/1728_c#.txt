namespace P10TraverseDirectoryWithXDocElAttr
{
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Xml.Linq;
    using System.Text;
    using System.Threading.Tasks;

    class P10TraverseDirectoryWithXDocElAttr
    {
        static void Main()
        {
            string directoryPath = @"C:\";
            string fileToWriteLocation = "../../directoryStructure.xml";
            Encoding encoding = Encoding.GetEncoding("windows-1251");

            
            System.IO.DirectoryInfo directory = new System.IO.DirectoryInfo(directoryPath);            

            var directories = directory.GetDirectories("*.*");
            var files = directory.GetFiles("*.*");

            XElement directoryStructure = new XElement(XName.Get("directory"));

            foreach (var dir in directories)
            {
                directoryStructure.Add(new XElement("directory", dir.Name));
            }

            foreach (var file in files)
            {
                var node = new XElement("file", file.Name);
                node.Add(new XAttribute("size", file.Length / 1025 + " KB"));
                directoryStructure.Add(node);

            }

            directoryStructure.Save(fileToWriteLocation);
            Console.WriteLine("File directoryStructure.xml saved.");
        }
    }
}