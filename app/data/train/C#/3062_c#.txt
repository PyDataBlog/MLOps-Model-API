using System;
using System.Transactions;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using Saude.Model.Persistence;

namespace AtendimentoModelTest {


    /// <summary>
    ///This is a test class for TB_AC_CUIDADOTest and is intended
    ///to contain all TB_AC_CUIDADOTest Unit Tests
    ///</summary>
    [TestClass()]
    public class TB_AC_CUIDADOTest {

        private SaudeDesenv databaseContext;

        #region Additional test attributes
        // 
        //You can use the following additional attributes as you write your tests:
        //
        //Use ClassInitialize to run code before running the first test in the class
        //[ClassInitialize()]
        //public static void MyClassInitialize(TestContext testContext)
        //{
        //}
        //
        //Use ClassCleanup to run code after all tests in a class have run
        //[ClassCleanup()]
        //public static void MyClassCleanup()
        //{
        //}
        //
        //Use TestInitialize to run code before running each test
        //[TestInitialize()]
        //public void MyTestInitialize()
        //{
        //}
        //
        //Use TestCleanup to run code after each test has run
        //[TestCleanup()]
        //public void MyTestCleanup()
        //{
        //}
        //
        #endregion

        [TestInitialize]
        public void ContextInitialize() {
            databaseContext = new SaudeDesenv();
            databaseContext.ContextOptions.LazyLoadingEnabled = true;          
        }

        [TestCleanup]
        public void ContextFinalize() {
            databaseContext.Dispose();
        }

        /// <summary>
        /// Insert new cuidado on database.
        ///</summary>
        [TestMethod()]
        public void InsertNewCuidado() {

            using (TransactionScope scope = new TransactionScope()) {

                TB_AC_CUIDADO target = new TB_AC_CUIDADO();
                target.CD_PESSOA = 0;
                target.CD_USUARIO_INCLUSAO = 0;
                target.IC_ATIVO = 1;
                target.DT_INCLUSAO = DateTime.Now;
                target.NM_CUIDADO = "New cuidado";

                databaseContext.TB_AC_CUIDADO.AddObject(target);
                databaseContext.SaveChanges();
                scope.Complete();
                Assert.IsTrue(target.CD_CUIDADO != 0);

            }

        }

        //[TestMethod()]
        //public void UpdateCuidado() {

        //    TB_AC_CUIDADO target = new TB_AC_CUIDADO();
        //    target.CD_PESSOA = 0;
        //    target.CD_CUIDADO = 1012;
        //    target.CD_USUARIO_INCLUSAO = 0;
        //    target.IC_ATIVO = 1;
        //    target.DT_INCLUSAO = DateTime.Now;
        //    target.NM_CUIDADO = "Update cuidado";

        //    databaseContext.TB_AC_CUIDADO.Attach(target);
        //    databaseContext.SaveChanges();
        //    Assert.IsTrue(target.CD_CUIDADO != 0);

        //}

        [TestMethod()]
        public void DeleteCuidado() {

            TB_AC_CUIDADO cuidado = (from i in databaseContext.TB_AC_CUIDADO
                                     where i.CD_CUIDADO == 1012
                                     select i).First();

            TB_AC_CUIDADO target = new TB_AC_CUIDADO();
            target.CD_PESSOA = 0;
            target.CD_CUIDADO = 1012;
            databaseContext.DetectChanges();
            databaseContext.TB_AC_CUIDADO.DeleteObject(target);
            databaseContext.SaveChanges();
            Console.Write(target.CD_CUIDADO.ToString());
            Assert.IsTrue(target.CD_CUIDADO == 0);

        }

        //[TestMethod()]
        //public void GetCuidadoById() {

        //    TB_AC_CUIDADO target = new TB_AC_CUIDADO();
        //    target.CD_PESSOA = 0;
        //    target.CD_USUARIO_INCLUSAO = 0;
        //    target.IC_ATIVO = 1;
        //    target.DT_INCLUSAO = DateTime.Now;
        //    target.NM_CUIDADO = "New cuidado";

        //    databaseContext.TB_AC_CUIDADO.AddObject(target);
        //    databaseContext.SaveChanges();
        //    Assert.IsTrue(target.CD_CUIDADO != 0);

        //}

    }

}