using System;
using System.Windows.Forms;

namespace PhotoMover
{
	public partial class EditDataGrid : DataGridView
	{

		#region Constructor

		public EditDataGrid()
		{
			InitializeComponent();
		}

		#endregion

		#region Overrides

		protected override void OnLeave(EventArgs e)
		{
			base.OnLeave(e);
			this.ClearSelection();
		}

		protected override void OnCellLeave(DataGridViewCellEventArgs e)
		{
			base.OnCellLeave(e);

			foreach (DataGridViewCell c in this.Rows[e.RowIndex].Cells)
			{
				if (c.EditedFormattedValue.ToString() != "")
				{
					return;
				}
			}

			if (e.RowIndex < this.RowCount - 1)
			{
				Rows.Remove(this.Rows[e.RowIndex]);
			}
		}

		protected override void OnKeyDown(KeyEventArgs e)
		{
			if (e.KeyCode == Keys.Delete && SelectedCells.Count > 0 && this.Rows.Count > this.SelectedCells[0].RowIndex + 1)
			{
				this.Rows.RemoveAt(this.SelectedCells[0].RowIndex);
			}

			base.OnKeyDown(e);
		}

		#endregion

	}
}
