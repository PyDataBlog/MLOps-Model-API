using System;
using System.Collections.Generic;
using System.Globalization;
using System.Linq;
using System.Text;

namespace DNK.PriceListImport.MetroClubLoader
{
    public class DateRange
    {
        private DateTime? _start;
        private DateTime? _end;

        public DateTime? Start { get { return _start; } }
        public DateTime? End { get { return _end; } }

        public DateRange()
        {
            _start = null;
            _end = null;
        }

        public DateRange(DateTime start, DateTime end)
            : this()
        {
            _start = start;
            _end = end;
        }

        public DateRange(string source)
            : this()
        {
            DateRange dateRange = GetDatesFromRange(source);
            if (dateRange != null)
            {
                _start = dateRange.Start;
                _end = dateRange.End;
            }
        }
        public static DateRange GetDatesFromRange(string source)
        {
            string[] strArray = source.Split(new char[] { '-' }, StringSplitOptions.RemoveEmptyEntries);
            for (int j = 0; j < strArray.Length; j++)
            {
                strArray[j] = strArray[j].Trim();
            }
            if (strArray.Length == 2)
            {
                DateTime now = DateTime.Now;
                DateTime result = DateTime.Now;
                if (DateTime.TryParseExact(strArray[0], "dd.MM.yy", CultureInfo.InvariantCulture, DateTimeStyles.None, out now) && DateTime.TryParseExact(strArray[1], "dd.MM.yy", CultureInfo.InvariantCulture, DateTimeStyles.None, out result))
                {
                    return new DateRange(now, result);
                }
            }
            return null;
        }

    }
}
