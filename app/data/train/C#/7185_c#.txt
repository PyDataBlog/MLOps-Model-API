// $Id$

using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Text;
using System.Windows.Forms;
using OreEfficiencyCalc.Properties;

namespace OreEfficiencyCalc {
    public partial class ManualPricesForm : Form {
        public ManualPricesForm() {
            InitializeComponent();

            manualCheckBox.Checked = Settings.Default.manualPrices;
            manualCheckBox_CheckedChanged(manualCheckBox, EventArgs.Empty);
        }

        private void cancelButton_Click(object sender, EventArgs e) {
            this.Close();
        }

        private void saveButton_Click(object sender, EventArgs e) {
            foreach (Control c in pricesGroupBox.Controls) {
                if (c is Label) {
                    string label = ((Label)c).Text;
                    TextBox textBox = (TextBox)pricesGroupBox.Controls[label.Replace(' ', '_')];
                    double result;

                    if ((label.Length > 0) && (textBox != null) &&
                        double.TryParse(textBox.Text, out result)) {
                        Prices.setPrice(
                            (Component)Enum.Parse(typeof(Component), label.ToUpper()), result);
                    }
                }
            }

            this.Close();
        }

        private void manualCheckBox_CheckedChanged(object sender, EventArgs e) {
            pricesGroupBox.Enabled =
                Settings.Default.manualPrices = ((CheckBox)sender).Checked;
        }

    }
}
