@echo off
setlocal

set "Version=2.10"

set "MinAppVerF=46.0"
set "MaxAppVerF=51.*"

set "UUID=%THEME%-Extras@Windows"


::copy files
md ".\_RELEASE\%UUID%"
xcopy ".\Firefox-Extras\gnome-extras" ".\_RELEASE\%UUID%" /S /Y
if "%THEME%"=="Tangerine" xcopy ".\Firefox-Extras\tango-extras" ".\_RELEASE\%UUID%" /S /Y
if "%THEME%"=="Gnome-Human" xcopy ".\Firefox-Extras\gnome-brave-extras" ".\_RELEASE\%UUID%" /S /Y
if "%THEME%"=="Gnome-Noble" xcopy ".\Firefox-Extras\gnome-brave-extras" ".\_RELEASE\%UUID%" /S /Y
if "%THEME%"=="Gnome-Wine" xcopy ".\Firefox-Extras\gnome-brave-extras" ".\_RELEASE\%UUID%" /S /Y
if "%THEME%"=="Gnome-Wise" xcopy ".\Firefox-Extras\gnome-brave-extras" ".\_RELEASE\%UUID%" /S /Y
if "%THEME%"=="Humanity" xcopy ".\Firefox-Extras\elementary-extras" ".\_RELEASE\%UUID%" /S /Y
if "%THEME%"=="Tangerine" xcopy ".\Firefox-Extras\tango-extras" ".\_RELEASE\%UUID%" /S /Y
xcopy ".\Firefox-Extras\%THEME%-extras" ".\_RELEASE\%UUID%" /S /Y


::make RDF
set "Contributor=Gnome-Colors Project"
if "%THEME%"=="Gnome" set "Contributor=Gnome Desktop Project"
if "%THEME%"=="Cheser" set "Contributor=Gnome Desktop Project"
if "%THEME%"=="Tango" set "Contributor=Tango Desktop Project"
if "%THEME%"=="Tangerine" set "Contributor=Ubuntu Art Team"
if "%THEME%"=="Humanity" set "Contributor=Ubuntu Art Team"
if "%THEME%"=="Elementary" set "Contributor=ElementaryOS Project"

set "Path=%CD%"

echo LINKESC?xml version="1.0"?RECHTESC > "%TEMP%\Code.txt "
echo. >> "%TEMP%\Code.txt "
echo LINKESCRDF xmlns="http://www.w3.org/1999/02/22-rdf-syntax-ns#" >> "%TEMP%\Code.txt "
echo      xmlns:em="http://www.mozilla.org/2004/em-rdf#"RECHTESC >> "%TEMP%\Code.txt "
echo. >> "%TEMP%\Code.txt "
echo  LINKESCDescription about="urn:mozilla:install-manifest"RECHTESC >> "%TEMP%\Code.txt "
echo    LINKESCem:idRECHTESC%UUID%LINKESC/em:idRECHTESC >> "%TEMP%\Code.txt "
echo    LINKESCem:versionRECHTESC%VERSION%LINKESC/em:versionRECHTESC >> "%TEMP%\Code.txt "
echo    LINKESCem:bootstrapRECHTESCtrueLINKESC/em:bootstrapRECHTESC >> "%TEMP%\Code.txt "
echo    LINKESCem:typeRECHTESC2LINKESC/em:typeRECHTESC >> "%TEMP%\Code.txt "
echo. >> "%TEMP%\Code.txt "
echo    LINKESC!-- Firefox  --RECHTESC >> "%TEMP%\Code.txt "
echo    LINKESCem:targetApplicationRECHTESC >> "%TEMP%\Code.txt "
echo      LINKESCDescriptionRECHTESC >> "%TEMP%\Code.txt "
echo        LINKESCem:idRECHTESC{ec8030f7-c20a-464f-9b0e-13a3a9e97384}LINKESC/em:idRECHTESC >> "%TEMP%\Code.txt "
echo        LINKESCem:minVersionRECHTESC%MinAppVerF%LINKESC/em:minVersionRECHTESC >> "%TEMP%\Code.txt "
echo        LINKESCem:maxVersionRECHTESC%MaxAppVerF%LINKESC/em:maxVersionRECHTESC >> "%TEMP%\Code.txt "
echo      LINKESC/DescriptionRECHTESC >> "%TEMP%\Code.txt "
echo    LINKESC/em:targetApplicationRECHTESC >> "%TEMP%\Code.txt "
echo. >> "%TEMP%\Code.txt "
echo    LINKESC!-- Front End MetaData --RECHTESC >> "%TEMP%\Code.txt "
echo    LINKESCem:nameRECHTESC%THEME% ExtrasLINKESC/em:nameRECHTESC >> "%TEMP%\Code.txt "
echo    LINKESCem:descriptionRECHTESCAdditional customizations for the Firefox Theme with %THEME% Icons.LINKESC/em:descriptionRECHTESC >> "%TEMP%\Code.txt "
echo    LINKESCem:creatorRECHTESCHeebijeebiLINKESC/em:creatorRECHTESC >> "%TEMP%\Code.txt "
echo    LINKESCem:contributorRECHTESC%CONTRIBUTOR%LINKESC/em:contributorRECHTESC >> "%TEMP%\Code.txt "
echo    LINKESCem:homepageURLRECHTESChttp://wintango.blogspot.de/2014/12/firefox-thunderbird-themes.htmlLINKESC/em:homepageURLRECHTESC >> "%TEMP%\Code.txt "
echo  LINKESC/DescriptionRECHTESC    >> "%TEMP%\Code.txt "
echo. >> "%TEMP%\Code.txt "
echo LINKESC/RDFRECHTESC >> "%TEMP%\Code.txt "


far "%TEMP%\Code.txt " "%TEMP%\Code1.txt" "LINKESC" "<"
far "%TEMP%\Code1.txt" "%PATH%\_RELEASE\%UUID%\install.rdf" "RECHTESC" ">"
del "%TEMP%\code.txt"
del "%TEMP%\code1.txt"


::compress
7z a -mx9 ".\_RELEASE\%THEME%-Extras.zip" ".\_RELEASE\%UUID%\*" -xr@exclude.txt
RENAME ".\_RELEASE\%THEME%-Extras.zip" "%UUID%.xpi"
rd /s /q ".\_RELEASE\%UUID%"