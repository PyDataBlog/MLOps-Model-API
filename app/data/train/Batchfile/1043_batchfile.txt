::==================================================================::
:: File  : Make.BAT
:: Description: Make the Keil C source code 
:: Author: JLJuang
:: E-Mail: JLJuang@csie.nctu.edu.tw
:: NOTE  : All copy rights reserved (c) since 2003
::==================================================================::
@echo on
cls
CALL setting.bat
CALL clean.bat

::-----------------------------------------------------------------::
::    STEP 1: SELECT PANEL and DEF_TYPE
::-----------------------------------------------------------------::
CALL SetTarget.BAT %1
CALL SetOption.BAT %2

::-----------------------------------------------------------------::
::    STEP 2: Configure
::-----------------------------------------------------------------::
CALL GENDF.BAT
:: CALL JVER.BAT

::-----------------------------------------------------------------::
::    STEP 3: Compile
::-----------------------------------------------------------------::
::    JCC  [FILE]       	[OPTIMIZE]     [OPTIMIZE_TYPE]		[OTHER]
::-----------------------------------------------------------------::



CALL  JCC  Main          	9               SIZE						
:: [NOTE] : For ZET6231 strobe issue
CALL  JCC  Isr          	9               SPEED						
::CALL  JCC  Isr          	9               SPEED					SRC	
CALL  JCC  I2c          	9               SIZE	
CALL  JAA   Startup				A51	


::-----------------------------------------------------------------::
::    STEP 4: Link 
::-----------------------------------------------------------------::

CALL JLINK JL51.conf JOUT




:: -----------------------------------------------------------------::
::    STEP 5: Generate image
:: -----------------------------------------------------------------::
CALL JH2B JOUT 0x8000

:: -----------------------------------------------------------------::
::    STEP 6: Merge image
:: -----------------------------------------------------------------::
%PRJ_PATH%\BinMerge.exe %BIN_PATH%\JOUT.bin %PRJ_PATH%\DB.BIN %BIN_PATH%\%LOAD_TYPE%%PROJECT_NAME%.BIN	0x7C00 2000


:: -----------------------------------------------------------------::
::    STEP 7: Backup image
:: -----------------------------------------------------------------::
COPY %BIN_PATH%\%LOAD_TYPE%%PROJECT_NAME%.BIN  %DEV_PATH%\%PROJECT_NAME%\%PANEL_TYPE%\%LOAD_TYPE%%PROJECT_NAME%_%DEF_NAME%.BIN


COPY %BIN_PATH%\%PROJECT_NAME%.BIN  %DEV_PATH%\%PROJECT_NAME%\%PANEL_TYPE%\

