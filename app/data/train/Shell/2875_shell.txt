#!/bin/bash
if ["$1" == "--help"]; then
echo "edtime.sh [minutes] [user] "
echo "This tool is adding a time for given user to database"
echo "Bash version above 4.x.x is required"
exit 0
fi
if [ -z $1 ] || [ -z $2 ]; then
echo "You typed wrong user name or wrong times"
echo "edtime.sh [minutes] [user] "
exit 1
fi
if [ ${BASH_VERSION:0:1} -lt 4 ]; then
echo "Bash version above 4.x.x is required"
exit 1
fi

if[ ! -e /perm/database ]; then
touch /perm/database
fi

check=$(cat /etc/passwd | grep "$2")
if [ "$?" == "0" ]; then 
   if [ $1 -ge 0 ] && [ $1 -le 1440 ]; then
     checkDB=$(cat /perm/database | grep "$2")
        if [ "$?" == "0" ]; then
          echo "That user has set time limits. Do you want to change it? (y/n)"
          read choice
		echo "$choice" | tr '[:upper:]' '[:lower:]' > $choice
		fletter=${choice:0:1}
	   	case "$fletter" in
		y) ;;
		*) echo "I don't change anything" ; exit 0;;
		esac
           sed -i "/$2/d" /perm/database
	fi
	echo "$2 $1" >> /perm/database
        exit 0
   else
     echo "Wrong time: 0 - 1440"
     exit 1
   fi
else
   echo "That user doesn't exist"
   exit 1
fi

