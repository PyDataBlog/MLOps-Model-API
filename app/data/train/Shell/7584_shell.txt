headsha=$(git rev-parse --verify HEAD)
echo "Commit sha is: $headsha"

BASE_REPO=demos.hub.polyverse.io

echo "Building the PWP container...."
GOOS=linux CGO_ENABLED=0 go build api.go

docker build \
  -f Dockerfile.pwp \
  -t $BASE_REPO/pwp \
  -t $BASE_REPO/pwp:$headsha \
  .

docker push $BASE_REPO/pwp
docker push $BASE_REPO/pwp:$headsha

rm -rf ./api
