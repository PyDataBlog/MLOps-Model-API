#!/bin/bash
function showhelp {
	cat << EOF
usage: install.sh -u <web user> -d <installation dir> [ -h (help) ]
Notes:
    -u, --webuser    : Provide the user the webserver runs as;
                       required to set permissions correctly.
    -d, --installdir : Specify the installation directory.
                       Remember that this web framework is designed to run under Apache.

Good luck. You will probably need it.
EOF
	exit
}

cd "$( dirname "${BASH_SOURCE[0]}" )"

while [[ $# > 1 ]]
do
key="$1"
shift
case $key in
	-h|--help)
		showhelp
		shift
	;;
	-u|--webuser)
		WEBUSER="$1"
		shift
	;;
	-d|--installdir)
		INSTALLDIR="$1"
		shift
	;;
	*)
		# unknown option
	;;
esac
done

if [ -z "$INSTALLDIR" ] ; then
	showhelp
fi
if [ ! -d "$INSTALLDIR" ] ; then
	mkdir $INSTALLDIR
	if [ $? -ne 0 ] ; then
		echo "Problem: $INSTALLDIR"
		echo " does not seem to exist,"
		echo " and nor is it creatable."
		exit
	fi	
fi

cp -r * $INSTALLDIR
cp .htaccess $INSTALLDIR/.htaccess
rm $INSTALLDIR/README.md
rm $INSTALLDIR/LICENSE.txt
rm $INSTALLDIR/install.sh
mkdir $INSTALLDIR/usr
mkdir $INSTALLDIR/usr/docs
mkdir $INSTALLDIR/usr/img
chown -R $WEBUSER $INSTALLDIR/usr
