#!/bin/bash

# Setting the $sasspid variable.
sasspid=""

# Quitting nginx when the services are stopped.
trap ctrl_c INT
function ctrl_c() {
    nginx -s quit
    kill $sasspid
}

# Starting nginx.
dir=`pwd`
nginx -c "$dir/nginx.conf"

# Starting postgres.
( postgres -D /usr/local/var/postgres )&

# Deploying templates.
( jade --watch -o static/ templates/jade/ )&
( jsx --watch templates/jsx/ static/js/ )&
( sass --scss --watch templates/scss/:static/css/ )&
sasspid=$!

# Starting the Go app.
gin -p 3001 -a 3002
