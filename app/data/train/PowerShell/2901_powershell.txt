# clearing the console window
cls

# REST requests to collect data from the web

# defining the RESTful URL where we want to fetch our data from
$urlString = "http://pokeapi.co/api/v2/pokemon/"

# To keep things simple, we create a list of params we want to fetch data for
# In this case we need to provide IDs to fetch Pokemon information
$urlParams = "1","16" # 1 - Bulbasaur, 16 - Pidgey

# We create an empty list to store the URLS we want to fetch data off
$urlRequestStrings = @()

# Looping through the $urlParams to create all request URLs we want to fetch data from
$urlParams | % { 
    $urlRequestStrings += $($urlString + $_)
}

# The actual REST (GET) request.
# In this case the request returns json formatted data
# that we can easily work with in Powershell
# as Powershell automatically converts the response into a psObject
if (!$xml) {
    $xml = Invoke-RestMethod -Uri $urlRequestStrings[1] -Method Get
}
# Now that we got our xml response (-psObject) we can iterate through
# all of it's parameters to get what we need
# In this case the xml response is rather complex but you should get an idea

#(We limit the output to 3 elements as it's quite some data...)

write-host "Pokemon name: $($xml.name)"
write-host "learnable moves:"

foreach ($i in 0..2) {
    write-host
    write-host "Move name: $($xml.moves[$i].move.name)"
    write-host "Version group: $($xml.moves[$i].version_group_details.version_group.name)"
    write-host "learn method: $($xml.moves[$i].version_group_details.move_learn_method.name)"
    write-host "learned at: $($xml.moves[$i].version_group_details.level_learned_at)"
}


# Just for the sake of it, we can of course iterate over the entire response
# to get all the information by calling the following function
function getAllData() {
    $xml.moves | % {
        write-host
        write-host "Move name: $($_.move.name)"
        write-host "Version group: $($_.version_group_details.version_group.name)"
        write-host "learn method: $($_.version_group_details.move_learn_method.name)"
        write-host "learned at: $($_.version_group_details.level_learned_at)"
    }
}

# Remove the comment (#) below to get all data
# getAllData