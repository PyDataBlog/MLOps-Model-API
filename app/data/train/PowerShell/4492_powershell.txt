Import-Module ActiveDirectory            
      
$users = Import-Csv -Path C:\ScriptSources\AD_Update0215.csv       
    
            
foreach ($user in $users) 

{   

$Manager = (get-aduser -filter "Userprincipalname -eq '$($user.Manager)'")
         
Get-ADUser -Filter "Userprincipalname -eq '$($user.Upn)'" -SearchBase "OU=CAH_Users,DC=colonyah,DC=local" | Set-ADUser -Title $($user.Title) -Manager $Manager -EmployeeID $($user.EmployeeID) -MobilePhone
}


-Company "Colony Starwood"  -Office $($user.Office)  -StreetAddress $($user.Address)




$users = Import-Csv -Path C:\ScriptSources\smart_Search_Results.csv     
    
            
foreach ($user in $users) 

{   

$SAM = $User.'Username'
         
Get-ADUser $SAM | Set-ADUser -MobilePhone $($user.CellNumber)
}

#Dump Data

Get-ADUser -Filter * -Properties Displayname, Title, Office, Officephone, MobilePhone, userprincipalname, Department, Givenname  -SearchBase "OU=CAH_Users,DC=colonyah,DC=local" | 
    Select-Object Displayname, Title, Department, Office, Officephone, MobilePhone, userprincipalname, Givenname, @{Name='Manager';Expression={(get-aduser (get-aduser $_ -Properties manager).manager).name}}, samaccountname | 
        Export-Csv C:\ScriptOutput\ADPull$((Get-Date).ToString('MM-dd-yyyy')).csv





Get-ADUser -Filter * -Properties Displayname, Title, Office, Officephone, MobilePhone, userprincipalname, Department, givenname -SearchBase "OU=CAH_Users,DC=colonyah,DC=local" | 
    Select-Object Displayname, givenname, Title, Department, Office, Officephone, MobilePhone, userprincipalname, @{Name='Manager';Expression={(get-aduser (get-aduser $_ -Properties manager).manager).name}}, samaccountname | 
        Export-Csv C:\ScriptOutput\ADPull$((Get-Date).ToString('MM-dd-yyyy')).csv

Get-ADUser -Filter * -Properties EmployeeID, Displayname, Title, Office, Officephone, MobilePhone, userprincipalname, Department, givenname -SearchBase "OU=CAH_Users,DC=colonyah,DC=local" | 
    Select-Object EmployeeID, Displayname, givenname, Title, Department, Office, Officephone, MobilePhone, userprincipalname, @{Name='Manager';Expression={(get-aduser (get-aduser $_ -Properties manager).manager).name}}, samaccountname | 
        Export-Csv C:\ScriptOutput\ADPull$((Get-Date).ToString('MM-dd-yyyy')).csv


