function Invoke-TranssmartDemo
{
    Param
    (
        [Parameter(Mandatory, ValueFromPipeLine)]
        [ValidateSet('AddressBook', 'MasterData', 'Document', 'Print')]
        [string]$DemoType
    )

    Begin
    {
        Import-Module UncommonSense.Transsmart.Automation -Force
    }
    Process
    {
        switch($DemoType)
        {
            'AddressBook'
            {
                Write-Host Before Add-TranssmartAddressBook:
                Get-TranssmartAddressBook | Format-Table -AutoSize

                $NewEntry = New-TranssmartAddressBook -Name 'Name' -Street 'Street' -StreetNo 'StreetNo' -ZipCode '9999 XX' -City 'City' -Province 'Province' -Country 'NL' 

                Write-Host After Add-TranssmartAddressBook:
                Get-TranssmartAddressBook | Format-Table -AutoSize

                $NewEntry.AddressName = 'Another Name'
                $NewEntry = $NewEntry | Update-TranssmartAddressBook

                Write-Host After Update-TranssmartAddressBook:
                Get-TranssmartAddressBook | Format-Table -AutoSize

                $NewEntry | Remove-TranssmartAddressBook

                Write-Host After Remove-TranssmartAddressBook:
                Get-TranssmartAddressBook | Format-Table -AutoSize
            }

            'MasterData'
            {
                'Get-TranssmartCarrier', 
                'Get-TranssmartCarrierProfile', 
                'Get-TranssmartCostCenter', 
                'Get-TranssmartEMailType', 
                'Get-TranssmartIncoTerm',
                'Get-TranssmartPackage',
                'Get-TranssmartServiceLevelOther',
                'Get-TranssmartServiceLevelTime',
                'Get-TranssmartShipmentLocation',
                'Get-TranssmartUser' |
                    ForEach-Object { Write-Host "$($_):"; &($_) | Format-Table -AutoSize }
            }

            'Document'
            {
                Write-Host Before Add-TranssmartDocument:
                Get-TranssmartDocument | Format-Table -AutoSize

                # FIXME
            }

            'Print'
            {
                Invoke-TranssmartDoLabel -ID #FIXME
            }
        }
    }
}

$ErrorActionPreference = 'Stop'

Clear-Host
'Print' | Invoke-TranssmartDemo 