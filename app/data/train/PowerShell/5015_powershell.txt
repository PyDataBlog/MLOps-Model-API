<#
.Synopsis
Adds a document
#>
function New-TranssmartDocument
{
    Param
    (
        [Parameter(Mandatory)]
        [string]$Url,

        [Parameter(Mandatory)]
        [string]$UserName,

        [Parameter(Mandatory)]
        [AllowNull()]
        [string]$Password,

        [string]$AddressAccountNoPickup,
        [string]$AddressCustomerNoPickup,
        [string]$AddressVatNumberPickup,
        [string]$AddressNamePickup,
        [string]$AddressStreetPickup,
        [string]$AddressStreetNoPickup,
        [string]$AddressStreet2Pickup,
        [string]$AddressZipcodePickup,
        [string]$AddressCityPickup,
        [string]$AddressStatePickup,
        [string]$AddressCountryPickup,
        [string]$AddressContactPickup,
        [string]$AddressPhonePickup,
        [string]$AddressFaxPickup,
        [string]$AddressEmailPickup,

        [string]$AddressAccountNo,
        [string]$AddressCustomerNo,
        [string]$AddressVatNumber,
        [string]$AddressName,
        [string]$AddressStreet,
        [string]$AddressStreetNo,
        [string]$AddressStreet2,
        [string]$AddressZipcode,
        [string]$AddressCity,
        [string]$AddressState,
        [string]$AddressCountry,
        [string]$AddressContact,
        [string]$AddressPhone,
        [string]$AddressFax,
        [string]$AddressEmail,

        [string]$AddressAccountNoInvoice,
        [string]$AddressCustomerNoInvoice,
        [string]$AddressVatNumberInvoice,
        [string]$AddressNameInvoice,
        [string]$AddressStreetInvoice,
        [string]$AddressStreetNoInvoice,
        [string]$AddressStreet2Invoice,
        [string]$AddressZipcodeInvoice,
        [string]$AddressCityInvoice,
        [string]$AddressStateInvoice,
        [string]$AddressCountryInvoice,
        [string]$AddressContactInvoice,
        [string]$AddressPhoneInvoice,
        [string]$AddressFaxInvoice,
        [string]$AddressEmailInvoice,

        [string]$Carrierid,
        [string]$Carrierprofileid,
        [string]$Costcenterid,
        [string]$Mailtypeid,
        [string]$Description,
        [string]$Incotermid,
        [string]$Loadmeter,
        [string]$Preferreddeliverydatefrom,
        [string]$Preferreddeliverydateto,
        [string]$Preferredpickupdatefrom,
        [string]$Preferredpickupdateto,
        [string]$Servicelevelotherid,
        [string]$Serviceleveltimeid,
        [string]$Servicetype,
        [string]$Shipmentlocationid,

        [string]$Refagentreference,
        [string]$Refcustomer,
        [string]$Refcustomerorder,
        [string]$Refdeliveryid,
        [string]$Refdeliverynote,
        [string]$Refengineer,
        [string]$Reference,
        [string]$Refinvoice,
        [string]$Reforder,
        [string]$Refother,
        [string]$Refproject,
        [string]$Refservicepoint,
        [string]$Refyourreference,

        [string]$Tariffcurrency,
        [string]$Shipmenttariff,
        [string]$Shipmentvaluecurrency,
        [string]$Shipmentvalue,
        [string]$Spotpricecurrency,
        [string]$Spotprice,

        [Switch]$PassThru
    )

    $Document = New-Object -TypeName Transsmart.Api.Models.Document
    
    # Pick-up Address
    $Document.AddressAccountNoPickup = $AddressAccountNoPickup
    $Document.AddressCustomerNoPickup = $AddressCustomerNoPickup
    $Document.AddressVatNumberPickup = $AddressVatNumberPickup
    $Document.AddressNamePickup = $AddressName
    $Document.AddressStreetPickup = $AddressStreetPickup
    $Document.AddressStreetNoPickup = $AddressStreetNoPickup
    $Document.AddressStreet2Pickup = $AddressStreet2Pickup
    $Document.AddressZipcodePickup = $AddressZipcodePickup
    $Document.AddressCityPickup  = $AddressCityPickup
    $Document.AddressStatePickup = $AddressStatePickup
    $Document.AddressCountryPickup = $AddressCountryPickup
    $Document.AddressContactPickup = $AddressContactPickup
    $Document.AddressPhonePickup = $AddressPhonePickup
    $Document.AddressFaxPickup = $AddressFaxPickup
    $Document.AddressEmailPickup = $AddressEmailPickup

    # Delivery Address
    $Document.AddressAccountNo = $AddressAccountNo
    $Document.AddressCustomerNo = $AddressCustomerNo
    $Document.AddressVatNumber = $AddressVatNumber
    $Document.AddressName = $AddressName
    $Document.AddressStreet = $AddressStreet
    $Document.AddressStreetNo = $AddressStreetNo
    $Document.AddressStreet2 = $AddressStreet2
    $Document.AddressZipcode = $AddressZipcode
    $Document.AddressCity = $AddressCity
    $Document.AddressState = $AddressState
    $Document.AddressCountry = $AddressCountry
    $Document.AddressContact = $AddressContact
    $Document.AddressPhone = $AddressPhone
    $Document.AddressFax = $AddressFax
    $Document.AddressEmail = $AddressEmail

    # Invoice Address
    $Document.AddressAccountNoInvoice = $AddressAccountNoInvoice
    $Document.AddressCustomerNoInvoice = $AddressCustomerNoInvoice
    $Document.AddressVatNumberInvoice = $AddressVatNumberInvoice
    $Document.AddressNameInvoice = $AddressNameInvoice
    $Document.AddressStreetInvoice = $AddressStreetInvoice
    $Document.AddressStreetNoInvoice = $AddressStreetNoInvoice
    $Document.AddressStreet2Invoice = $AddressStreet2Invoice
    $Document.AddressZipcodeInvoice = $AddressZipcodeInvoice
    $Document.AddressCityInvoice = $AddressCityInvoice
    $Document.AddressStateInvoice = $AddressStateInvoice
    $Document.AddressCountryInvoice = $AddressCountryInvoice
    $Document.AddressContactInvoice = $AddressContactInvoice
    $Document.AddressPhoneInvoice = $AddressPhoneInvoice
    $Document.AddressFaxInvoice = $AddressFaxInvoice
    $Document.AddressEmailInvoice = $AddressEmailInvoice

    # Other fields
    $Document.CarrierId = $CarrierID
    $Document.CarrierProfileId = $CarrierProfileId # nullable!     
    $Document.CostCenterId = $CostCenterId
    $Document.MailTypeId = $MailTypeId
    $Document.Description = $Description
    $Document.IncoTermId = $IncoTermId
    $Document.LoadMeter = $LoadMeter
    $Document.PreferredDeliveryDateFrom = $PreferredDeliveryDateFrom
    $Document.PreferredDeliveryDateTo = $PreferredDeliveryDateTo
    $Document.PreferredPickupDateFrom = $PreferredPickupDateFrom
    $Document.PreferredPickupDateTo = $PreferredPickupDateTo
    $Document.ServiceLevelOtherId = $ServiceLevelOtherId
    $DOcument.ServiceLevelTimeId = $ServiceLevelTimeId
    $Document.ServiceType = $ServiceType
    $Document.ShipmentLocationId = $ShipmentLocationId

    # References
    $Document.RefAgentReference = $RefAgentReference
    $Document.RefCustomer = $RefCustomer                                   
    $Document.RefCustomerOrder = $RefCustomerOrder                                             
    $Document.RefDeliveryId = $RefDeliveryId                                     
    $Document.RefDeliveryNote = $RefDeliveryNote                                           
    $Document.RefEngineer = $RefEngineer                                       
    $Document.Reference = $Reference                                               
    $Document.RefInvoice = $RefInvoice                                                   
    $Document.RefOrder = $RefOrder                                                 
    $Document.RefOther = $RefOther                                                     
    $Document.RefProject = $RefProject                                                    
    $Document.RefServicePoint = $RefServicePoint                                               
    $Document.RefYourReference = $RefYourReference                                       

    # Amounts
    $Document.TariffCurrency = $TariffCurrency
    $Document.ShipmentTariff = $ShipmentTariff
    $Document.ShipmentValueCurrency = $ShipmentValueCurrency
    $Document.ShipmentValue = $ShipmentValue
    $Document.SpotPriceCurrency = $SpotPriceCurrency
    $Document.SpotPrice = $SpotPrice

<#
Add colli information
Add DocumentDeliveryNoteInfo
#>

    $Client = New-Object -TypeName Transsmart.Api.Client -ArgumentList $Url, $UserName, $Password
    $Document = $Client.AddDocument($Document)

    if ($PassThru)
    {
        $Document    
    }
}
