# Simple powershell (built-in to Win7/8/10) utility script
#  to compute sha256 (or md5, sha1 or sha512) of a file
#
# Usage:
# C:\> powershell
# PS .\Get-Hash filename.ext [sha|md5|sha256|sha512]
#
# May require: Control Panel/System/Admin/Windows Power Shell Modules, then: Set-Executionpolicy RemoteSigned
#
# Based on James Manning's and Mike Wilbur's get-hashes and get-sha256 MSDN scripts
#
param(
    [string] $file = $(throw "A filename is required. Usage: .\Get-Hash filename.ext [sha|md5|sha256|sha512]"),
    [string] $algorithm = 'sha256'
)
$fileStream = [system.io.file]::openread((resolve-path $file))
$hasher = [System.Security.Cryptography.HashAlgorithm]::create($algorithm)
$hash = $hasher.ComputeHash($fileStream)
$fileStream.close()
$fileStream.dispose()
[system.bitconverter]::tostring($hash).ToLower().replace('-','')+" '"+$file+"' "+$algorithm+"`r`n"