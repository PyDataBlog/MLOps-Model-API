#***************************************************
# Empty shell script by Doug Tripple
#***************************************************

# Get the current execution path
$fullPathIncFileName = $MyInvocation.MyCommand.Definition 
$currentScriptName = $MyInvocation.MyCommand.Name 
$currentExecutingPath = $fullPathIncFileName.Replace($currentScriptName, "") 

# Variables go here
$errfile = $currentExecutingPath + "errlist$(get-date -f yyyy-MM-dd-HH-mm).txt"
$logfile = $currentExecutingPath + "transcript$(get-date -f yyyy-MM-dd-HH-mm).txt"
$dlfile = $currentExecutingPath + "dlfile.csv"

# Functions Go Here

# Kill any old logging that may be still going on
try{
  stop-transcript|out-null
}
catch [System.InvalidOperationException]{}

# start the logging
start-transcript -path $logfile

# Body of script goes here

$csv = import-csv $dlfile

foreach ($line in $csv)
{
get-distributiongroup $line.Identity |fl name,managedby,exchangeversion
$New= Read-host "Username of Person to Add as manager?"
		
		if ($new -ne ""){
        #set the new owner
		Set-DistributionGroup $line.Identity -ManagedBy @{add=$new} -BypassSecurityGroupManagerCheck
        get-distributiongroup $line.identity |fl name,managedby,exchangeversion 
         }
         else{
         "No Change made" |Out-Default}

	}




# Body of script ends above here
Stop-transcript