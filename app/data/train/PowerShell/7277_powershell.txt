import-module hyper-v

$tp = '2012'
$baseName = "@Base1"

$path = Split-Path $MyInvocation.MyCommand.path

$t = get-content "$($path)\_runConfig.ps1"

get-vm  | ? { $_.name -like "$($BaseName)-$($tp)-*" } | % {
    $vm = $_

    $vm.name -match ".*srv(\d{2})$"
    $nr = [int]($Matches[1])

    $x = $t

    $x = $x.Replace("{{IP}}", "10.0.0.$($nr)")
    $x = $x.Replace("{{ServerName}}", "Srv$($nr)")

    $x | set-content "$($path)\$($vm.name)\RunConfig.ps1" -Force -confirm:$false
}