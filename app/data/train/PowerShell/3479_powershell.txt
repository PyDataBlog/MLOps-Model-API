Do {
$UPN = read-host "Please enter the full email address you wish to assign to this user"
$firstName = read-host "Please enter the users first name"
$lastName = read-host "Please enter the users last name"
$Correct = Read-host "You have entered $($UPN) and  $($firstName) $($lastName) Is this correct? y/n"
if ($correct -eq "y") {
Do{
$password = read-host -assecurestring "Please enter a password for this user" 
$plainPassword = (New-Object System.Management.Automation.PSCredential 'N/A', $password).GetNetworkCredential().Password
$PWD1 = $plainPassword
$password = read-host -assecurestring "Please re-enter the password for the user" 
$plainPassword = (New-Object System.Management.Automation.PSCredential 'N/A', $password).GetNetworkCredential().Password
$PWD2 = $plainPassword
if ($PWD1 -eq $PWD2) {$match = "yes"}
Else {
Write-host "passwords did not match, please try again"}
}
Until ($match -eq "yes")
pause
New-MsolUser -UserPrincipalName $UPN -DisplayName "$($firstName) $($lastName)" -FirstName $firstName -LastName $lastName -Password $password}
}
Until ($correct -eq "y")
}