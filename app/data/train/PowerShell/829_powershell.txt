#constants
$backupRootPath = "G:\Backup\"
$pathsToCopy = "D:\Lenonardo", `
               "E:\Code"#, `
               #"D:\VMs"

# for testing
#$testBackupRootPath = "d:\Test"
#$testPathToCopy = "D:\Downloads\Photos",  "D:\Downloads\torrents", "D:\Downloads\pixelmon"

function CopyFolder($sources, $destination){
   foreach($source in $sources){
      [void] (Copy-Item -Path $source -Destination $destination -Recurse -Force -Whatif)
      [void] (Copy-Item -Path $source -Destination $destination -Recurse -Force)
   }
}

function CreateDestinationFolder($root){
   $currentDate = Get-Date -Format "yyyy.MM.dd"
   $newFolderPath = Join-Path -Path $root -ChildPath $currentDate

   #create new folder in backupRootPath
   return New-Item -Path $newFolderPath -ItemType Directory -Force
}

function Backup(){
   Write-Host "remove oldest folder in the dir unless it's the only one"
   $destinationFolder = createDestinationFolder -root $backupRootPath
   CopyFolder -sources $pathsToCopy -destination $destinationFolder
}

