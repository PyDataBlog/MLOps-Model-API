# Dieser Job checkt für alle SCCM-Server das Vorhandensein eines 
# übergebenen Pakets mittels Package-ID
　
$strPackageID = $args[0]
　
$objServerListe = Get-Content -Path C:\temp\ChkSCCMServer.txt
　
$objDiskList = @()
　
　
ForEach ($objServer in $objServerListe)
  {
	$objDiskData = "" | select-Object Server, Share, PackageExist
	
	$strSplit = $objServer.Split(";")
　
	$objDiskData.Server =  $strSplit[0]
	$strServer = $objDiskData.Server
	
	$objDiskData.Share = "SMSPKG" + $strSplit[1] + "$"
	$strShare = $objDiskData.Share
	
	$strCheckPath = "\\$strServer\$strShare\$strPackageID"
	
	if (Test-Path $strCheckPath)
	  {
		$objDiskData.PackageExist = "True"
	  }
	else
	  {
	    $objDiskData.PackageExist = "False"
	  }
	
	$objDiskList += $objDiskData
  }
　
$objDiskList | format-Table -AutoSize
　
