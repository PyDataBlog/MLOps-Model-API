# Login to Windows Azure subscription
Add-AzureAccount

# Set default Windows Azure subscription - Use the results from the last command
$subscription = "MS Azure Internal"
$location = "East US"

Select-AzureSubscription $subscription

# Get default Windows Azure Storage Account - This Storage Account  was provisioned in the first lab section.
Get-AzureStorageAccount | Format-Table -Property Label

# Set default Windows Azure Storage Account - Use the results from the last command for exemple:  portalvhds9qvls2qdp9zgq  and enter it as the variable in the  $storageAccountName = "enter it here" line

$storageAccountName = "<enter Azure Storage Account here>"
Get-AzureSubscription | Set-AzureSubscription -CurrentStorageAccountName $storageAccountName

# Retrieve list of platform images for Virtual Machines
( Get-AzureVMImage | where-object { $_.Label -like "Windows*" } ) | Format-Table -AutoSize -Property Label
$imageNames = @( Get-AzureVMImage | where-object { $_.Label -like "Windows*" } ).ImageName



# Prompt for Admin Credentials
$admin = Get-Credential

# Set Virtual Machine name and Cloud Service name to be provisioned
$vmName = "BootCamp01"
$serviceName = "BootCamp01"

# Provision new Virtual Machine
New-AzureQuickVM `
-Name $vmName `
-ServiceName $serviceName `
-InstanceSize Small `
-Windows `
-ImageName $imageNames[11] `
-AdminUsername $admin.Username `
-Password $admin.GetNetworkCredential().Password `
-Location $location

# Get list of provisioned Virtual Machines
Get-AzureVM

# Stop / Start Azure Virtual Machines
#Stop-AzureVM -Name $vmName -ServiceName $serviceName -Force

#Start-AzureVM -Name $vmName -ServiceName $serviceName