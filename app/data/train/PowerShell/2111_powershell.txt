###Morning coffee.

#if this script fails security policy in powershell run the below.
Set-ExecutionPolicy -ExecutionPolicy Unrestricted -Scope Process -Force

#Is java installed??
$jdk18x = Test-Path "C:\Program Files\Java\jdk1.8*\bin"

if(!$jdk18x){
    $wshell.Popup("Unable to locate jdk 1.8.x in C:\Program Files\Java`n`nPlease install 1.8 jdk 64 bit.");
    exit;    
}




$wshell = New-Object -ComObject Wscript.Shell
$jdkHomePath = Get-ChildItem -Path "C:\Program Files\Java\jdk1.8*\bin";
$jreHomePath = Get-ChildItem -Path "C:\Program Files\Java\jdk1.8*\jre";


#Setup java related environmental variables.
[Environment]::SetEnvironmentVariable("JAVA_HOME", $jdkHomePath.FullName, "Machine");
[Environment]::SetEnvironmentVariable("JRE_HOME", $jreHomePath.FullName, "Machine");


#TODO check for git and prompt to install it.
#TODO exec git checkout then git config --global core.excludesfile ~/.gitignore_global
