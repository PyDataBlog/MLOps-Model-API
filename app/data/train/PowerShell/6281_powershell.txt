$Date = Get-Date -Format yyyy-M-dd-HH-mm
$source = "<WorldFolder>" #i.e. c:\users\<username>\AppData\LocalLow\ProjectorGames\FortressCraft\Worlds\<WorldName>
$archive = "C:\Admin\Archive\Hourly"
$Name = $Date+"_FCE_<UniqueIdentifer>.zip"
$destination = "<UNC path to network Share>"
$ArchiveFile = Join-Path -Path $archive -ChildPath $Name 


MD $archive -EA 0 | Out-Null

If(Test-path $ArchiveFile) {Remove-item $ArchiveFile}

Write-Host "Starting Backup Process" -ForegroundColor Yellow

#Clean up old backups

Write-Host "Purging any backups older than 62 minutes"

    Get-ChildItem -path $archive | where {$_.Lastwritetime -lt (date).AddMinutes(-62)} | remove-item
    Get-ChildItem -path $destination | where {$_.Lastwritetime -lt (date).AddMinutes(-62)} | remove-item



#Notify users of backup
Write-Host "Notifying Users of Backup Job Start"
    &C:\Perl64\bin\perl.exe "C:\Admin\Scripts\BackupWarning.pl"

#Create backup
    Write-Host "Creating backup" -ForegroundColor Yellow

        Add-Type -assembly "system.io.compression.filesystem"
        [io.compression.zipfile]::CreateFromDirectory($Source, $ArchiveFile)

            Write-Host "Copying backup to network share"
                Copy-Item -Path $ArchiveFile -Destination $destination -Force

Start-Sleep -Seconds 15

Write-Host "Backup complete" -ForegroundColor Green