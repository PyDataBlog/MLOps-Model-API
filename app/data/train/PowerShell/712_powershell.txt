function Get-DriveCapacity
{
    <#
    .SYNOPSIS
    Returns local drive data and formats HTML report. 
    
    .DESCRIPTION
    Gets drive capacity and formats showing GB totals and free space.
    
    .EXAMPLE
    Get-DriveCapacity
    
    .NOTES
    Used in script to return HTML fragment.
    #>
    [CmdletBinding()]
    param()

    $localdrives = get-wmiobject -Class win32_volume | Where-Object { $_.DriveType -eq 3 } | ForEach-Object {Get-PSDrive -LiteralName $_.DriveLetter[0]}
    $localdrives | Select-Object Name,@{Name="Disk Size(GB)";Expression={"{0,8:N0}" -f($_.free/1gb +$_.used/1gb)}},@{Name="Disk Used(GB)";Expression={"{0,8:N0}" -f($_.used/1gb)}},@{Name="Free (%)";Expression={"{0,6:P0}" -f($_.free / ($_.free +$_.used))}}

}

Get-DriveCapacity