<#
.Synopsis
Retrieves address book entries
#>
function Get-TranssmartAddressBook
{
    Param
    (
        [Parameter(Mandatory)]
        [string]$Url,

        [Parameter(Mandatory)]
        [string]$UserName,

        [Parameter(Mandatory)]
        [AllowNull()]
        [string]$Password,

        [int]$ID
    )

    $Client = New-Object -TypeName Transsmart.Api.Client -ArgumentList $Url, $UserName, $Password

    if ($ID)
    {
        $Client.GetAddressBook($ID)
    }
    else
    {
        $Client.GetAddressBooks()
    }
}
