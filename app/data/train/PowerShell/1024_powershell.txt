<#
.DESCRIPTION
    Gather AD user deatials from a list of AD SamAccountName names
    This will search at the top level forrest if used against a global catalgue server
    Edit the " -Server ninjas.superawesome.com:3268" section to reflect your AD GC server
    Edit the " -Properties * |select SamAccountName,ect..." section for the information you want gathered from the AD record
.NOTES
    File Name      : AD-user-loop.ps1
    Author         : Jon Cheuvront (@monkee13)
.LINK
    https://github.com/monkee13/monkeescripts
.Example
  ./AD-user-loop.ps1 | Export-Cvs outpifile-name.csv -NoTypeInformation
#>

$users = Import-Csv user-list.csv | Select -ExpandProperty *
foreach ($user in $users) {
try 
{
get-aduser $user -Server ninjas.superawesome.com:3268 -Properties * |select SamAccountName,DisplayName,UserPrincipalName,Mail,ipPhone,company,Department,l,office,city,co,PasswordNeverExpires,enabled,DistinguishedName
}
Catch {write-Host User $User was not found in Active Directory ... -ForegroundColor red}
}
