$HerePath = 'C:\PATH\TO\APP\DOCUMENT\DIR'
$HerePathFull = $HerePath + "\"

Remove-Item $HerePath -Recurse -Force -Confirm:$false
net use \\NETWORK\PATH "YOURPASSWORD" /user:DOMAIN\USER
xcopy '\\NETWORK\PATH\POLICIES\FOLDER' $HerePathFull /s /e /y
net use \\NETWORK\PATH /delete

# Remove any files that don't have a .doc or .docx extension
Get-ChildItem $HerePath -Rec | Where {!$_.PSIsContainer} | Where {$_.FullName -NotMatch '\.doc*'} | Foreach ($_) {
    Remove-Item $_.FullName -Recurse -Force -Confirm:$false
}

$Word = New-Object -ComObject Word.Application
Get-ChildItem $HerePath -Rec -Filter *.doc* | Foreach-Object {
    $thisFile = $_.FullName
    $pdfPath = [io.path]::ChangeExtension($_.FullName, "pdf")
    $txtPath = [io.path]::ChangeExtension($_.FullName, "txt")

    $thisDoc = $Word.Documents.Open($thisFile)
    $thisDoc.SaveAs($pdfPath, 17)
    $thisDoc.SaveAs($txtPath, 2)
    $thisDoc.Close()

    Write-Host $_.Name" successfully converted..."
}

Restart-Service BoardSearch
[Environment]::Exit(0)
