#Automatically trigger this script via a timer to clean up your Exchange 2010 / 2013 

Set-Executionpolicy RemoteSigned


#Number of days Exchange Logfiles are kept
$days=7 


#Path Exchange Logfiles are kept in
$IISLogPath="C:\inetpub\logs\LogFiles\"



$ExchangeLoggingPath="$env:exchangeinstallpath\Logging\"



Write-Host "Removing IIS and Exchange logs; keeping last" $days "days"



Function CleanLogfiles($TargetFolder)



{



    if (Test-Path $TargetFolder) {



        $Now = Get-Date



        $LastWrite = $Now.AddDays(-$days)



        $Files = Get-ChildItem $TargetFolder -Include *.log,*.blg -Recurse | Where {$_.LastWriteTime -le "$LastWrite"}



        foreach ($File in $Files)



            {Write-Host "Deleting file $File" -ForegroundColor "Red"; Remove-Item $File -ErrorAction SilentlyContinue | out-null}



       }



Else {



    Write-Host "The folder $TargetFolder doesn't exist! Check the folder path!" -ForegroundColor "red"



    }



}



CleanLogfiles($IISLogPath)



CleanLogfiles($ExchangeLoggingPath)