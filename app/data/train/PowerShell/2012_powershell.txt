Function Get-DataHubModellingInformation
{
[CmdletBinding()]
Param(
    [string]$DBName,
    [string]$DBInstance
)
Begin { }
Process {
$Query = @"
Select Name,ISNULL(ISNULL(Temp1.Tjeneste,Temp2.ServiceName),Temp3.ServiceName) as Tjeneste from v_Modelling_UmodellerteServere 
left outer join SMModellingData as Temp1 on v_Modelling_UmodellerteServere.Name = Temp1.[Server]
left outer join SMServerTjeneste as Temp2 on REPLACE(v_Modelling_UmodellerteServere.Name,'old','') = Temp2.ServerName
left outer join SMServerTjeneste as Temp3 on REPLACE(v_Modelling_UmodellerteServere.Name,'ny','') = Temp3.ServerName
WHERE ISNULL(ISNULL(Temp1.Tjeneste,Temp2.ServiceName),Temp3.ServiceName) is not null
"@
  #$Query = "Select Name,Tjeneste from v_Modelling_UmodellerteServere inner join SMModellingData on v_Modelling_UmodellerteServere.Name = SMModellingData.Server"
  $SqlConnection = New-Object System.Data.SqlClient.SqlConnection
  $SqlConnection.ConnectionString = "Server=$DBInstance;Database=$DBName;Trusted_Connection=True;"
  $SqlCmd = New-Object System.Data.SqlClient.SqlCommand
  $SqlCmd.Connection = $SqlConnection
  $SqlAdapter = New-Object System.Data.SqlClient.SqlDataAdapter
  $SqlAdapter.SelectCommand = $SqlCmd
  $DataSet = New-Object System.Data.DataSet
  $SqlConnection.Open()
  $SqlCmd.CommandText = $Query
  $SqlAdapter.Fill($DataSet) | Out-Null
  $Entries = $DataSet.Tables[0].Rows
  $SqlConnection.Close()

  Foreach ($Entry in $Entries) {
    Write-Output $Entry
  } # End Foreach
}
End { }
}