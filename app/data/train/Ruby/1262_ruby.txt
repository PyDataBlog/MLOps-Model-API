# Logic for creating a security key during password reset
module Authenticatable
  class SecurityKey < ActiveRecord::Base
    # Uses the hashable concern
    include Hashable
    
    # Requires user id and an expiration_date to be present
    validates :user_id,:expiration_date, presence: true
    
    # ActiveRecord association to the user who create the security key
    belongs_to :user
    
    # Runs the method to create security key before saving the record
    before_create :set_key
    
    # Assigns security using method from hashable concern
    def set_key
      self.key = hash_from_salt
    end
    
    # Check to see if password is before date of expiration.
    def not_expired?(date)
      date <= self.expiration_date
    end
    
  end
end