class GamesController < ApplicationController

  before_action :set_game, only: [:start, :destroy]
  # before_action :set_state, only: [:rysh, :state]
  # before_action :lookup_location, only: [:travel]

  def create
    @game = current_user.games.build
    @game.setup!

    current_user.set_current_game! @game
    redirect_sable
  end

  def destroy
    @game.destroy
    redirect_to "/"
  end

  def start
    current_user.set_current_game! @game
    redirect_to "/"
  end

  def quit
    current_user.set_current_game! nil
    redirect_to "/"
  end

  def sable
    if current_game
      if current_game.active_encounter.present?
        return render "/encounters/show"
      end
    end

    render "/games/show"
  end

private

  def set_game
    @game = current_user.games.where(id:params[:id]).first
    ensure_model! @game
  end

end
