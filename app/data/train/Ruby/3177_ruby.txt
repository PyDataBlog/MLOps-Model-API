module Sopro

  # Model with a title and description.  Assuming to be included
  # in classes that extend ActiveRecord::Base.
  #
  module TitledDescription
    
    def self.included(base)
      base.send :before_validation, :strip_title

      base.send :validates_presence_of,   :title, :description
      base.send :validates_uniqueness_of, :title, :case_sensitive => false

      # latest(N) -  Latest N quantity of problems, most recent first 
      base.send :scope, :latest, 
                lambda { |max_result_count| 
                  (base.send :order, 'id DESC').limit(max_result_count) }
    end

    private 
    def strip_title
      self.title = self.title.strip if not self.title.nil?
    end
  end
end
