#ifndef _DEFFERED_H_
#define _DEFFERED_H_

#include "tiny_obj_loader.h"
#include "Application.h"
#include "FlyCam.h"
#include <vector>
#include <string>


struct OpenGLInfo
{
	unsigned int m_VAO;
	unsigned int m_VBO;
	unsigned int m_IBO;
	unsigned int m_IndexCount;
};

class Deffered : public Application
{
public:

	virtual bool Init();
	virtual bool Update();

	virtual void ShutDown();
	virtual void Draw();

	void SetUpGpass();
	void BuildLightBuffer();
	void BuildMesh();
	void BuildQuad();
	void BuildCube();

	//Light Functions
	void DrawDirLight(const vec3& a_Colour, const vec3& a_Dir);
	void DrawPointLight(const vec3& a_Pos, const vec3& a_Colour, float a_Radius);
private:
	FlyCam cam;
	OpenGLInfo m_Bunny;
	OpenGLInfo m_Quad;
	OpenGLInfo m_Cube;

	uint m_Gpass;
	uint m_GpassDepth;
	uint m_colourTexture;	//Albedo Texture
	uint m_posTexture;
	uint m_normalTexture;

	uint m_LightFbo;
	uint m_LightTexture;

	uint m_GPassProgram;
	uint m_DirLightProgram;
	uint m_PointLightProgram;
	uint m_SpotLightProgram;
	uint m_CompProgram;
};


#endif