       PROGRAM LINECOUNT
C ADRIANO HERNANDEZ
C 22 MARCH 2017
C BUILD - PASSING
C
C COMPILE WITH "gfortran -fimplicit-none -Wall test.for"
C
C THIS IS A SIMPLE PROGRAM THAT COUNTS THE LINE
C NUMBERS IN A FILE.
C
C IT ASSUMES THAT THE FILE IS CALLED 'file.txt'
C AND GIVES IT UNIT 30, BUT YOU CAN CHANGE THAT BY
C GOING INTO THE CODE AND SETTING IT IN THE MAIN PROGRAM (PROGRAM LINECOUNT)
C (NOT TO BE CONFUSED WITH MAIN SUBROUTINE, AN EXTENSION OF PROGRAM)

C
C PARAMETERS
C
       INTEGER*8 UT
       CHARACTER*8 FILENAME

       PARAMETER (UT = 30)
       PARAMETER (FILENAME = 'file.txt')

C
C      MAIN PROGRAM MODULE
C

       CALL MAIN(FILENAME,UT)

       STOP
       END PROGRAM

CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C SUBROUTINES
C
C
C MAIN - SIMPLE SUBROUTINE THAT PRINTS THE NUMBER OF LINES
C        IN A FILE OF A GIVEN FILENAME
C        (THIS IS A CONTINUATION OF MAIN PROGRAM)
C        (IT EXISTS TO ALLOW FOR MORE MODULARITY AND EASIER INTIALIZATION)
C FILENAME - FILENAME IS AN ARGUMENT/PARAMETER REPRESENTING THE NAME OF THE FILE
C UT - UT IS AN ARGUMENT/PARAMETER REPRESENTING THE UNIT NUMBER OF THE FILE

       SUBROUTINE MAIN(FILENAME,UT)
       CHARACTER*8 FILENAME
       INTEGER*8 UT
C
C FUNCTION DECLARATIONS
C
       INTEGER*8 COUNTE
C
C MAIN PROGRAM MODULE (SINCE THIS IS EFFECTIVELLY OUR MAIN PROGRAM)
C
       OPEN(UNIT = UT, FILE = FILENAME, STATUS = 'OLD')
C OUTPUT THE NUMBER OF LINES USING COUNTE FROM FILE UNIT UT

       WRITE(*,*) COUNTE(UT)

C FINISH (AND CLOSE TO AVOID EXTERNALITIES)
       CLOSE(UT, STATUS = 'KEEP')

       RETURN
       END



CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
C FUNCTIONS
C
C
C COUNTE - FUNCTION THAT COUNTS THE LINES IN THE FILE WITH UNIT UT (RETURNS AN INTEGER*8)
C UT - THE UNIT NUMBER OF THE FILE TO BE CHECKED (AN ARGUMENT)
C
       FUNCTION COUNTE(UT)
       INTEGER*8 COUNTE
       INTEGER*8 UT

C INIT RETURN VALLUE AND REWIND THE FILE
C TO AVOID WIERD BUGS
       REWIND(UT)
       COUNTE = 0

C COUNT UNTIL WE REACH THE END
2000   READ(UT,*,END = 3000)
          COUNTE = COUNTE + 1
          GOTO 2000
3000   CONTINUE

C REWIND TO AVOID EXTERNALITIES, AND RETURN VALUE
       REWIND(UT)

       RETURN
       END
