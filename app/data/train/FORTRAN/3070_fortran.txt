PROGRAM Computer_Usage_Records
!===========================================================
!´Ó¼üÅÌÉÏ¶ÁÈ¡ÓÃ»§ºÅÂë£¬ËÑË÷¼ÆËã»úÊ¹ÓÃ¼ÇÂ¼ÎÄ¼þ£¬Èç¹ûºÅÂëÒ»ÖÂ£¬
!ÔòÏÔÊ¾ÓÃ»§µÄÐÅÏ¢
!
!Computer_Usage_Info : 
!FileName            : 
!OpenStatus          :
!InputStatus         :
!User                : 
!InputNumber         : 
!UserNumber          : 
!Found               : 

!ÊäÈë£¨¼üÅÌ£©£ºInputNumber
!ÊäÈë£¨ÎÄ¼þ£©£ºUserNumber, UserÖÐµÄÓÃ»§ÆäËûÐÅÏ¢
!Êä³ö£¨ÆÁÄ»£©£ºÓÃ»§ºÅÂë£¬ÐÕÃû£¬ÕÊÃæÓà¶î
!===========================================================
IMPLICIT NONE
TYPE Computer_Usage_Info
	CHARACTER(15) :: LastName, FirstName
	INTEGER       :: IdNumber
	CHARACTER(6)  :: Password
	INTEGER       :: ResourceLimit
	REAL          :: ResourceUsed
END TYPE Computer_Usage_Info

CHARACTER(20) :: FileName
TYPE(Computer_Usage_Info) :: User
INTEGER :: OpenStatus, InputStatus, InputNumber, UserNumber
LOGICAL :: Found

WRITE(*,'(a)',ADVANCE='NO') '¼üÈëÎÄ¼þÃû='
READ *, FileName
OPEN(UNIT=10,FILE=FileName,STATUS='OLD',IOSTAT=OpenStatus)
IF(OpenStatus>0) STOP '²»ÄÜ´ò¿ªÎÄ¼þ'

DO
	PRINT *
	WRITE(*,'(a)',ADVANCE='NO') '¼üÈëÓÃ»§ºÅÂë£¨ÖÐÖ¹Ê±Îª0£©='
	READ *, InputNumber
	IF(InputNumber==0) EXIT
	DO
		READ(10,'(T31,I5)', IOSTAT=InputStatus) UserNumber
		IF(InputStatus>0) STOP '¶ÁÈë´íÎó'
		IF(InputStatus<0) EXIT
		Found=(InputNumber==UserNumber)
		IF(Found) EXIT
	END DO
	IF(Found) THEN
		BACKSPACE 10
		READ(10,'(2A15,10X,I4,F5.2)') &
			User%LastName, User%FirstName, &
			User%ResourceLimit, User%ResourceUsed
		PRINT '(I5,1X,2A15/"×Ü¶î£½",I4,"  Óà¶î£½",F5.2)', &
			UserNumber, User%FirstName, User%LastName, &
			User%ResourceLimit, User%ResourceUsed
	ELSE
		PRINT *,'Ã»ÓÐÕÒµ½ÓÃ»§',InputNumber
	END IF
	REWIND 10
END DO
END PROGRAM Computer_Usage_Records
