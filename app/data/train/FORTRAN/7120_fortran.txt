	.TITLE	ARGS_UCUR
	.LIBRARY	/ARGSMAC/
	ARGSDEF	UCUR,<^X400>
	ARGSINPUT
TYPE:	.BLKW	1
NPOS:	.BLKW	1
SIZE:	.BLKW	1
XPOS:	.BLKW	1
YPOS:	.BLKW	1
ORX:	.BLKW	1
ORY:	.BLKW	1
ISX:	.BLKW	1
ISY:	.BLKW	1
	ARGSINEND
	TB_INIT
	ARGSENTRY
	TB_READ
	DEV	4,5
	.WORD	<^X78>
	SETAV	DATA,INDEX
	SETLV	0,POSR
	SETVV	TYPE,WORK
	CMPLV	2,WORK
	BRAZE	SQ
	SDM	0
	JRE	DRAW1
SQ:
	SDM	3
DRAW1:
	JSE	DRAW
LOOP:
	TB_READ END,INC,DEC,ACC
	SETVV	TB_DELTAX,WORK
	ADDVV	TB_DELTAY,WORK
	CMPLV	0,WORK
	BRAZE	LOOP
	JSE	ERASE
	ADDVV	TB_DELTAX,XPOS
	ADDVV	TB_DELTAY,YPOS
	JSE	DRAW
	JRE	LOOP
INC:
	JSE	ERASE
	ADDLV	1,SIZE
	JSE	DRAW
	JRE	LOOP
DEC:
	SETVV	SIZE,WORK
	CMPLV	0,WORK
	BRAGE	LOOP
	JSE	ERASE
	SUBLV	1,SIZE
	JSE	DRAW
	JRE	LOOP
ACC:
	JSE	ERASE
	ZWE1	<^X0100>
	ZDI1	256
	JSE	DRAW+8
	ZWE1	<^X0200>
	JSE	DRAW
	SETVV	INDEX,MOV+6
MOV:	MOV	SIZE,YPOS,INDEX
	ADDLV	3,INDEX
	ADDLV	1,POSR
	SETVV	NPOS,WORK
	CMPVV	POSR,WORK
	BRAZE	END
	JRE	LOOP
END:
	JSE	ERASE
	DEV	4,5
	.WORD	0
	SSZ	0
	STP

ERASE:
	ZDI	0
	JRE	ERDR
DRAW:
	ZDI1	512
ERDR:
	JSE	COORD
	SETVV	TYPE,WORK
	CMPLV	2,WORK
	BRAGT	CIR
	BRAZE	DSQ
	SETVV	TYPE,WORK
	CMPLV	4,WORK
	BRAZE	ARW
	SETVV	YPOS,YCS
	SETVV	YPOS,YCE
	SETVV	XPOS,WORK
	SUBVV	SIZE,WORK
	SETVV	WORK,XCE
	SUBLV	10,WORK
	SETVV	WORK,XCS
	JSE	LINE
	SETVV	XPOS,WORK
	ADDVV	SIZE,WORK
	SETVV	WORK,XCS
	ADDLV	10,WORK
	SETVV	WORK,XCE
	JSE	LINE
	SETVV	XPOS,XCS
	SETVV	XPOS,XCE
	SETVV	YPOS,WORK
	SUBVV	SIZE,WORK
	SETVV	WORK,YCE
	SUBLV	10,WORK
	SETVV	WORK,YCS
	JSE	LINE
	SETVV	YPOS,WORK
	ADDVV	SIZE,WORK
	SETVV	WORK,YCS
	ADDLV	10,WORK
	SETVV	WORK,YCE
	JSE	LINE
	JRE	RET
DSQ:
	SETVV	XPOS,XC
	SUBVV	SIZE,XC
	ANDVV	MASK,XC
	SETVV	YPOS,YC
	SUBVV	SIZE,YC
	ANDVV	MASK,YC
	ADDVV	XMAC,XC
	ADDVV	YMAC,YC
	SETVV	XC,XMA
	SETVV	YC,YMA
XMA:	.BLKW	1
YMA:	.BLKW	1
	ADDVV	SIZE,XC
	ADDVV	SIZE,XC
	SETVV	XC,TCX
TCX:	.BLKW	1
	SETVV	YPOS,YC
	ADDVV	SIZE,YC
	ADDVV	YDAC,YC
	SETVV	YC,YDA
YDA:	.BLKW	1
	JRE	RET
ARW:
	SETVV	XPOS,XCS
	SETVV	XPOS,XCE
	SETVV	YPOS,WORK
	SETVV	YPOS,YCS
	SUBVV	SIZE,WORK
	SUBVV	SIZE,WORK
	SETVV	WORK,YCE
	JSE	LINE
	SETVV	XPOS,WORK
	SUBVV	SIZE,WORK
	SETVV	WORK,XCE
	ADDVV	SIZE,YCE
	JSE	LINE
	ADDLV	1,YCS
	ADDLV	1,YCE
	JSE	LINE
	ADDLV	1,YCS
	ADDLV	1,YCE
	JSE	LINE
	ADDVV	SIZE,XCE
	ADDVV	SIZE,XCE
	JSE	LINE
	SUBLV	1,YCS
	SUBLV	1,YCE
	JSE	LINE
	SUBLV	1,YCS
	SUBLV	1,YCE
	JSE	LINE
	JRE	RET
CIR:
	SETVV	XPOS,XOR+2
	SETVV	YPOS,YOR+2
XOR:	XOR	0
YOR:	YOR	0
	SETVV	SIZE,DC+2
DC:	SPC	0,0
	XOR	0
	YOR	0
RET:
	RET	0

COORD:
	SETVV	XPOS,XC
	SUBLV	54,XC
	ANDVV	MASK,XC
	ADDVV	XMAC,XC
	SETVV	XC,XM
	SETVV	YPOS,YC
	ADDVV	SIZE,YC
	ADDLV	3,YC
	ANDVV	MASK,YC
	ADDVV	YMAC,YC
	SETVV	YC,YM
XM:	.BLKW	1
YM:	.BLKW	1
	SETVV	XPOS,WORK
	SUBVV	ORX,WORK
	BRALT	OUT
	CMPVV	ISX,WORK
	BRALT	OUT
	JSE	CONV
	SETVV	HUNS,WORK
	ANDLV	<^XF>,WORK
	ADDLV	<^X30>,WORK
	MOV	WORK+1,WORK+1,CHAR+2
	SETVV	UNITS,WORK
	ANDLV	<^XF>,WORK
	ADDLV	<^X30>,WORK
	MOV	WORK+1,WORK+1,CHAR+6
	SETVV	TENS,WORK
	ANDLV	<^XF>,WORK
	ADDLV	<^X30>,WORK
	MOV	WORK+1,WORK+1,CHAR+4
	SETVV	YPOS,WORK
	SUBVV	ORY,WORK
	BRALT	OUT
	CMPVV	ISY,WORK
	BRALT	OUT
	JSE	CONV
	SETVV	HUNS,WORK
	ANDLV	<^XF>,WORK
	ADDLV	<^X30>,WORK
	MOV	WORK+1,WORK+1,CHAR+10
	SETVV	UNITS,WORK
	ANDLV	<^XF>,WORK
	ADDLV	<^X30>,WORK
	MOV	WORK+1,WORK+1,CHAR+14
	SETVV	TENS,WORK
	ANDLV	<^XF>,WORK
	ADDLV	<^X30>,WORK
	MOV	WORK+1,WORK+1,CHAR+12
	.WORD	<^X3610>
	.WORD	<^X0000>
CHAR:	.WORD	<^X2020>
	.WORD	<^X3000>
	.WORD	<^X3000>
	.WORD	<^X3000>
	.WORD	<^X2020>
	.WORD	<^X3000>
	.WORD	<^X3000>
	.WORD	<^X3000>
OUT:
	RET	0

LINE:
	SETVV	XCS,XC
	ANDVV	MASK,XC
	ADDVV	XMAC,XC
	SETVV	XC,P1X
	SETVV	YCS,YC
	ANDVV	MASK,YC
	ADDVV	YMAC,YC
	SETVV	YC,P1Y
P1X:	.BLKW	1
P1Y:	.BLKW	1
	SETVV	XCE,XC
	ANDVV	MASK,XC
	ADDVV	XMAC,XC
	SETVV	XC,P2X
	SETVV	YCE,YC
	ANDVV	MASK,YC
	ADDVV	YDAC,YC
	SETVV	YC,P2Y
P2X:	.BLKW	1
P2Y:	.BLKW	1
	RET	0

CONV:
	SETLV	0,HUNS
HLOOP:
	ADDLV	1,HUNS
	SUBLV	100,WORK
	BRAGE	HLOOP
	SUBLV	1,HUNS
	ADDLV	100,WORK
	SETLV	0,TENS
TLOOP:
	ADDLV	1,TENS
	SUBLV	10,WORK
	BRAGE	TLOOP
	SUBLV	1,TENS
	ADDLV	10,WORK
	SETVV	WORK,UNITS
	RET	0

HUNS:	.WORD	3
TENS:	.WORD	4
UNITS:	.WORD	5


WORK:	.BLKW	1

XC:	.BLKW	1
YC:	.BLKW	1
XCS:	.BLKW	1
YCS:	.BLKW	1
XCE:	.BLKW	1
YCE:	.BLKW	1

MASK:	.WORD	<^X0FFF>
XMAC:	.WORD	<^XC000>
YMAC:	.WORD	<^XA000>
YDAC:	.WORD	<^XE000>

INDEX:	.BLKW	1
	ARGSOUTPUT
DATA:	.BLKW	768
POSR:	.BLKW	1
	ARGSOUTEND

	ARGSEND	UCUR

	.END

