C
C    Copyright (C) 2009 Anders Aspegren SÃ¸ndergaard <andersas@gmail.com>
C    -------------------------------------------------------------------

C    This file is part of Wavlib.

C    Wavlib is free software: you can redistribute it and/or modify
C    it under the terms of the GNU General Public License as published by
C    the Free Software Foundation, either version 3 of the License, or
C    (at your option) any later version.

C    Wavlib is distributed in the hope that it will be useful,
C    but WITHOUT ANY WARRANTY; without even the implied warranty of
C    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
C    GNU General Public License for more details.

C    You should have received a copy of the GNU General Public License
C    along with Wavlib. If not, see <http://www.gnu.org/licenses/>.


C       Changes the sample rate of a wav file

        PROGRAM CHGRTE

        INTEGER OPENW,WAVIFO
        LOGICAL SETIFO

        INTEGER ITEST
        LOGICAL LTEST

        INTEGER RATE

        ITEST = OPENW(10,'test.wav')
        IF (ITEST .NE. 0) THEN
                WRITE(*,*) 'Could not open test.wav'
                STOP
        ENDIF      

C       add 10% to the sample rate
C        RATE = INT(0.5 * REAL(WAVIFO(10,'Samplerate')))
        WRITE(*,*) RATE
C        LTEST = SETIFO(10,'Samplerate',44100)
        LTEST = SETIFO(10,'Samplerate',65535)
C       LTEST = SETIFO(10,'Channels',1)
        IF (.NOT. LTEST) THEN
                WRITE(*,*) 'Could not set sample rate'
                CALL CLOSEW(10)
                STOP
        ENDIF

        CALL CLOSEW(10)
        STOP
        END
