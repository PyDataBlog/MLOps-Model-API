package com.lvxingpai.model.marketplace.product

import java.util.{ List => JList }
import javax.validation.constraints.NotNull

import com.lvxingpai.model.account.UserInfo
import com.lvxingpai.model.marketplace.order.Order
import com.lvxingpai.model.misc.ImageItem
import com.lvxingpai.model.mixin.{ ObjectIdEnabled, RatingEnabled, TimestampEnabled }
import org.mongodb.morphia.annotations._

/**
 * 商品的评论. 有两个索引: "user.userId", 以及commodityId
 */
@Entity
@Indexes(Array(new Index(fields = Array(new Field("user.userId")))))
class CommodityComment extends BaseCommodityComment with ObjectIdEnabled with RatingEnabled {
  /**
   * 商家的回复
   */
  var reply: BaseCommodityComment = _

  /**
   * 评论者
   */
  @NotNull
  var user: UserInfo = _

  /**
   * 订单
   */
  var order: Order = _

  /**
   * 是否匿名评论
   */
  var anonymous: Boolean = false
}

/**
 * Created by zephyre on 1/22/16.
 */
@Embedded
class BaseCommodityComment extends TimestampEnabled {
  /**
   * 评论正文
   */
  var contents: String = _

  /**
   * 评论附带的照片
   */
  var images: JList[ImageItem] = _
}
