DROP TABLE hospitals;
CREATE EXTERNAL TABLE hospitals(
provider_id string,
hospital_name string,
address string,
city string,
state string,
zip_code string,
county_name string,
phone_number string,
hospital_type string,
hospital_ownership string,
emergency_services string
)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde'
WITH SERDEPROPERTIES(
"separatorChar" = ",",
"quoteChar" = '"',
"escapeChar" = '\\'
)
STORED AS TEXTFILE
LOCATION '/user/w205/hospital_compare/hospitals';

DROP TABLE effective_care_full;
CREATE EXTERNAL TABLE effective_care_full(
provider_id string,
hospital_name string,
address string,
city string,
state string,
zip_code string,
county_name string,
phone_number string,
condition string,
measure_id string,
measure_name string,
score int,
sample int,
footnote string,
measure_start_date date,
measure_end_date date
)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde'
WITH SERDEPROPERTIES(
"separatorChar" = ",",
"quoteChar" = '"',
"escapeChar" = '\\'
)
STORED AS TEXTFILE
LOCATION '/user/w205/hospital_compare/effective_care';

DROP TABLE readmissions_full;
CREATE EXTERNAL TABLE readmissions_full(
provider_id string,
hospital_name string,
address string,
city string,
state string,
zip_code string,
county_name string,
phone_number string,
measure_name string,
measure_id string,
compared_to_national string,
denominator int,
score float,
lower_estimate float,
higher_estimate float,
footnote string,
measure_start_date date,
measure_end_date date
)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde'
WITH SERDEPROPERTIES(
"separatorChar" = ",",
"quoteChar" = '"',
"escapeChar" = '\\'
)
STORED AS TEXTFILE
LOCATION '/user/w205/hospital_compare/readmissions';

DROP TABLE measures;
CREATE EXTERNAL TABLE measures(
measure_name string,
measure_id string,
measure_start_quarter string,
measure_start_date date,
measure_end_quarter string,
measure_end_date date
)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde'
WITH SERDEPROPERTIES(
"separatorChar" = ",",
"quoteChar" = '"',
"escapeChar" = '\\'
)
STORED AS TEXTFILE
LOCATION '/user/w205/hospital_compare/measures';

DROP TABLE surveys_responses_full;
CREATE EXTERNAL TABLE surveys_responses_full(
provider_number string,
hospital_name string,
address string,
city string,
state string,
zip_code string,
county_name string,
comm_with_nurses_achieve_pts string,
comm_with_nurses_improve_pts string,
comm_with_nurses_dimension_score string,
comm_with_doc_achieve_pts string,
comm_with_doc_improve_pts string,
comm_with_doc_dimension_score string,
response_staff_achieve_pts string,
response_staff_improve_pts string,
response_staff_dimension_score string,
pain_mgmt_achieve_pts string,
pain_mgmt_improve_pts string,
pain_mgmt_dimension_score string,
comm_about_meds_achieve_pts string,
comm_about_meds_improve_pts string,
comm_about_meds_dimension_score string,
clean_quiet_environment_achieve_pts string,
clean_quiet_environment_improve_pts string,
clean_quiet_environment_dimension_score string,
discharge_info_achieve_pts string,
discharge_info_improve_pts string,
discharge_info_dimension_score string,
overall_rating_hospital_achieve_pts string,
overall_rating_hospital_improve_pts string,
overall_rating_hospital_dimension_score string,
hcahps_base_score int,
hcahps_consistency_score int
)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde'
WITH SERDEPROPERTIES(
"separatorChar" = ",",
"quoteChar" = '"',
"escapeChar" = '\\'
)
STORED AS TEXTFILE
LOCATION '/user/w205/hospital_compare/surveys_responses';

DROP TABLE total_performance;
CREATE EXTERNAL TABLE total_performance(
provider_number string,
hospital_name string,
address string,
city string,
state string,
zip_code string,
county_name	string,
unweighted_normalized_clinical_process_of_care_domain_score float,
weighted_clinical_process_of_care_domain_score float,
unweighted_patient_experience_of_care_domain score int,
weighted_patient_experience_of_care_domain score float,
unweighted_normalized_outcome_domain_score float,
weighted_outcome_domain_score float,
unweighted_normalized_efficiency_domain_score int,
weighted_efficiency_domain_score float,
total_performance_score float
)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde'
WITH SERDEPROPERTIES(
"separatorChar" = ",",
"quoteChar" = '"',
"escapeChar" = '\\'
)
STORED AS TEXTFILE
LOCATION '/user/w205/hospital_compare/total_performance';