
#SET GLOBAL event_scheduler = 1;
#SELECT @@event_scheduler;
delimiter //
DROP EVENT IF EXISTS E_startCalculate;
CREATE EVENT E_startCalculate ON SCHEDULE EVERY 1 MONTH STARTS DATE_ADD(DATE_ADD(DATE_SUB(CURDATE(),INTERVAL DAY (CURDATE()) - 1 DAY),INTERVAL 1 MONTH),INTERVAL 1 SECOND)
ON COMPLETION PRESERVE ENABLE DO
BEGIN
	DECLARE whichMonth DATETIME;
	SET whichMonth = DATE_SUB(DATE_SUB(DATE_FORMAT(NOW(),'%y-%m-%d'),INTERVAL EXTRACT(DAY FROM NOW())-1 DAY),INTERVAL 1 MONTH);
	#SELECT whichMonth;

	#INSERT INTO tim (t) VALUES(whichMonth);
	CALL P_startCalculate(whichMonth,1);
END;//
delimiter ;