--练习列出受雇日期早于其直接上级的所有员工的编号、姓名、部门名称、部门位置、部门人数。
SELECT e.empno, e.ename, e.deptno
FROM emp e, emp m WHERE e.mgr = m.empno AND e.hiredate < m.hiredate;
SELECT d.deptno, d.dname, d.loc, t.counts
   FROM (SELECT deptno, COUNT(deptno) counts FROM emp GROUP BY deptno) t, dept d
WHERE t.deptno = d.deptno;
SELECT t1.empno, t1.ename, t1.deptno, t2.dname, t2.loc, t2.counts
  FROM (SELECT e.empno, e.ename, e.deptno
          FROM emp e, emp m
         WHERE e.mgr = m.empno
           AND e.hiredate < m.hiredate) t1,
       (SELECT d.deptno, d.dname, d.loc, t.counts
          FROM (SELECT deptno, COUNT(deptno) counts FROM emp GROUP BY deptno) t,
               dept d
         WHERE t.deptno = d.deptno) t2
 WHERE t1.deptno = t2.deptno;


--练习列出所有“CLERK”（办事员）的姓名及其部门名称，部门的人数，工资等级。

   SELECT e.empno, e.ename, d.dname, s.grade, temp.人数
  FROM (SELECT deptno, COUNT(deptno) 人数 FROM emp GROUP BY emp.deptno) temp,
       emp e,
       dept d,
       salgrade s
 WHERE e.job = 'CLERK'    
   AND e.deptno = temp.deptno
   AND e.deptno = d.deptno
   AND e.sal BETWEEN s.losal AND s.hisal
--练习列出在部门“SALES”（销售部）工作的员工姓名、基本工资、雇佣日期、部门名称、假定不知道销售部的部门编号。
SELECT e.ename, e.sal, e.hiredate, d.dname
FROM emp e, dept d
WHERE e.deptno = d.deptno
HAVING d.dname = 'SALES'
GROUP BY d.dname,e.ename, e.sal, e.hiredate ;

--列出公司各个工资等级雇员的数量、平均工资。
SELECT COUNT(e.deptno), TRUNC(AVG(e.sal), 2)
FROM emp e, salgrade s
WHERE e.sal BETWEEN s.losal AND s.hisal
GROUP BY s.grade;

--列出在每个部门工作的员工数量、平均工资和平均服务期限。
SELECT d.dname, TRUNC( sum(e.sal) / count(d.dname),2), (TRUNC (sum( months_between (sysdate,e.hiredate))/count(d.dname), 2))
FROM emp e, dept d
WHERE e.deptno = d.deptno
GROUP BY d.dname;

--列出所有员工的姓名、部门名称和工资
SELECT e.ename, d.dname, e.sal
FROM emp e, dept d
WHERE e.deptno = d.deptno;

--列出所有部门的详细信息和部门人数。
SELECT  d.deptno, d.dname, d.loc, count(d.deptno)
FROM emp e, dept d
WHERE e.deptno = d.deptno
GROUP BY d.deptno,d.dname, d.loc;

---列出所有员工的年工资，所在部门名称，按年薪从低到高排序。
SELECT e.ename, d.dname, (e.sal *12)as 年薪
FROM emp e, dept d
WHERE e.deptno = d.deptno
ORDER BY 年薪 ;

--求出部门名称中，带‘S’字符的部门员工的工资合计、部门人数。
SELECT  d.dname, sum(e.sal), count(d.dname)
FROM emp e, dept d
WHERE e.deptno = d.deptno
HAVING d.dname like('%S%')
GROUP BY d.dname;
