/**
 * Database schema functions required by StorageModule.
 *
 * @author Anastaszor
 * @link https://github.com/yii1-module/yii1-storage
 * @license 2016-X MIT
 */

DELIMITER $$

CREATE TRIGGER `storage_folder_before_insert` BEFORE INSERT ON `storage_folder`
FOR EACH ROW BEGIN
	SET NEW.date_created = NOW();
	SET NEW.date_updated = NOW();
END;$$

CREATE TRIGGER `storage_folder_before_update` BEFORE UPDATE ON `storage_folder`
FOR EACH ROW BEGIN
	SET NEW.date_updated = NOW();
END;$$

CREATE TRIGGER `storage_asset_before_insert` BEFORE INSERT ON `storage_asset`
FOR EACH ROW BEGIN
	SET NEW.date_created = NOW();
	SET NEW.date_updated = NOW();
END;$$

CREATE TRIGGER `storage_asset_before_update` BEFORE UPDATE ON `storage_asset`
FOR EACH ROW BEGIN
	SET NEW.date_updated = NOW();
END;$$

CREATE TRIGGER `storage_tag_before_insert` BEFORE INSERT ON `storage_tag`
FOR EACH ROW BEGIN
	SET NEW.date_created = NOW();
	SET NEW.date_updated = NOW();
END;$$

CREATE TRIGGER `storage_tag_before_update` BEFORE UPDATE ON `storage_tag`
FOR EACH ROW BEGIN
	SET NEW.date_updated = NOW();
END;$$

DELIMITER ;