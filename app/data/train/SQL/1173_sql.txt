IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id('FK_codAdministradora') AND OBJECTPROPERTY(id, 'IsForeignKey') = 1)
ALTER TABLE GFI_contas DROP CONSTRAINT FK_codAdministradora ;

IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id('FK_codBanco') AND OBJECTPROPERTY(id, 'IsForeignKey') = 1)
ALTER TABLE GFI_contas DROP CONSTRAINT FK_codBanco ;

IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id('FK_codTipoConta') AND OBJECTPROPERTY(id, 'IsForeignKey') = 1)
ALTER TABLE GFI_contas DROP CONSTRAINT FK_codTipoConta ;

IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id('FK_codConta') AND OBJECTPROPERTY(id, 'IsForeignKey') = 1)
ALTER TABLE GFI_lancamentos DROP CONSTRAINT FK_codConta ;

IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id('FK_codEntidade') AND OBJECTPROPERTY(id, 'IsForeignKey') = 1)
ALTER TABLE GFI_lancamentos DROP CONSTRAINT FK_codEntidade ;

IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id('FK_codMarcador') AND OBJECTPROPERTY(id, 'IsForeignKey') = 1)
ALTER TABLE GFI_lancamentos DROP CONSTRAINT FK_codMarcador ;

IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id('FK_codUsuario') AND OBJECTPROPERTY(id, 'IsForeignKey') = 1)
ALTER TABLE GFI_lancamentos DROP CONSTRAINT FK_codUsuario ;

IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id('FK_codLancamento') AND OBJECTPROPERTY(id, 'IsForeignKey') = 1)
ALTER TABLE GFI_lancamentos_parcelas DROP CONSTRAINT FK_codLancamento ;

IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id('FK_codPermissao') AND OBJECTPROPERTY(id, 'IsForeignKey') = 1)
ALTER TABLE GFI_permissoes_telas DROP CONSTRAINT FK_codPermissao ;

IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id('FK_codTela') AND OBJECTPROPERTY(id, 'IsForeignKey') = 1)
ALTER TABLE GFI_permissoes_telas DROP CONSTRAINT FK_codTela ;

IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id('FK_codTipoUsuario') AND OBJECTPROPERTY(id, 'IsForeignKey') = 1)
ALTER TABLE GFI_permissoes_telas DROP CONSTRAINT FK_codTipoUsuario ;

IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id('FK_codSuperior') AND OBJECTPROPERTY(id, 'IsForeignKey') = 1)
ALTER TABLE GFI_telas DROP CONSTRAINT FK_codSuperior ;

IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id('FK_codBanco') AND OBJECTPROPERTY(id, 'IsForeignKey') = 1)
ALTER TABLE GFI_tipos_contas_bancos DROP CONSTRAINT FK_codBanco ;

IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id('FK_codTipoConta') AND OBJECTPROPERTY(id, 'IsForeignKey') = 1)
ALTER TABLE GFI_tipos_contas_bancos DROP CONSTRAINT FK_codTipoConta ;

IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id('FK_codCorretora') AND OBJECTPROPERTY(id, 'IsForeignKey') = 1)
ALTER TABLE GFI_usuarios DROP CONSTRAINT FK_codCorretora ;

IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id('FK_codTipoUsuario') AND OBJECTPROPERTY(id, 'IsForeignKey') = 1)
ALTER TABLE GFI_usuarios DROP CONSTRAINT FK_codTipoUsuario ;


IF EXISTS (SELECT * FROM dbo.SYSOBJECTS WHERE id = object_id('GFI_administradoras_cartoes') AND  OBJECTPROPERTY(id, 'IsUserTable') = 1)
DROP TABLE GFI_administradoras_cartoes ;

IF EXISTS (SELECT * FROM dbo.SYSOBJECTS WHERE id = object_id('GFI_bancos') AND  OBJECTPROPERTY(id, 'IsUserTable') = 1)
DROP TABLE GFI_bancos ;

IF EXISTS (SELECT * FROM dbo.SYSOBJECTS WHERE id = object_id('GFI_contas') AND  OBJECTPROPERTY(id, 'IsUserTable') = 1)
DROP TABLE GFI_contas ;

IF EXISTS (SELECT * FROM dbo.SYSOBJECTS WHERE id = object_id('GFI_entidades') AND  OBJECTPROPERTY(id, 'IsUserTable') = 1)
DROP TABLE GFI_entidades ;

IF EXISTS (SELECT * FROM dbo.SYSOBJECTS WHERE id = object_id('GFI_lancamentos') AND  OBJECTPROPERTY(id, 'IsUserTable') = 1)
DROP TABLE GFI_lancamentos ;

IF EXISTS (SELECT * FROM dbo.SYSOBJECTS WHERE id = object_id('GFI_lancamentos_parcelas') AND  OBJECTPROPERTY(id, 'IsUserTable') = 1)
DROP TABLE GFI_lancamentos_parcelas ;

IF EXISTS (SELECT * FROM dbo.SYSOBJECTS WHERE id = object_id('GFI_marcadores') AND  OBJECTPROPERTY(id, 'IsUserTable') = 1)
DROP TABLE GFI_marcadores ;

IF EXISTS (SELECT * FROM dbo.SYSOBJECTS WHERE id = object_id('GFI_permissoes') AND  OBJECTPROPERTY(id, 'IsUserTable') = 1)
DROP TABLE GFI_permissoes ;

IF EXISTS (SELECT * FROM dbo.SYSOBJECTS WHERE id = object_id('GFI_permissoes_telas') AND  OBJECTPROPERTY(id, 'IsUserTable') = 1)
DROP TABLE GFI_permissoes_telas ;

IF EXISTS (SELECT * FROM dbo.SYSOBJECTS WHERE id = object_id('GFI_telas') AND  OBJECTPROPERTY(id, 'IsUserTable') = 1)
DROP TABLE GFI_telas ;

IF EXISTS (SELECT * FROM dbo.SYSOBJECTS WHERE id = object_id('GFI_tipos_contas') AND  OBJECTPROPERTY(id, 'IsUserTable') = 1)
DROP TABLE GFI_tipos_contas ;

IF EXISTS (SELECT * FROM dbo.SYSOBJECTS WHERE id = object_id('GFI_tipos_contas_bancos') AND  OBJECTPROPERTY(id, 'IsUserTable') = 1)
DROP TABLE GFI_tipos_contas_bancos ;

IF EXISTS (SELECT * FROM dbo.SYSOBJECTS WHERE id = object_id('GFI_tipos_usuarios') AND  OBJECTPROPERTY(id, 'IsUserTable') = 1)
DROP TABLE GFI_tipos_usuarios ;

IF EXISTS (SELECT * FROM dbo.SYSOBJECTS WHERE id = object_id('GFI_usuarios') AND  OBJECTPROPERTY(id, 'IsUserTable') = 1)
DROP TABLE GFI_usuarios ;


CREATE TABLE GFI_administradoras_cartoes ( 
	codAdministradora int identity(1,1)  NOT NULL,
	nome varchar(100) NULL
) ;

CREATE TABLE GFI_bancos ( 
	codBanco int identity(1,1)  NOT NULL,
	codigo char(3) NULL,
	nome varchar(100) NULL
) ;

CREATE TABLE GFI_contas ( 
	codUsuario int NULL,
	codTipoConta int NULL,
	codConta int identity(1,1)  NOT NULL,
	codBanco int NULL,
	codAdministradora int NULL,
	nome varchar(100) NULL,
	diaFechamento int NULL,
	diaVencimento int NULL,
	limite numeric(15,2) NULL,
	saldoInicial numeric(15,2) NULL,
	saldoInicialData smalldatetime NULL
) ;

CREATE TABLE GFI_entidades ( 
	codUsuario int NULL,
	codEntidade int identity(1,1)  NOT NULL,
	nome varchar(100) NULL
) ;

CREATE TABLE GFI_lancamentos ( 
	codUsuario int NULL,
	codLancamento int identity(1,1)  NOT NULL,
	tipoLancamento char(1) DEFAULT D NULL,
	codConta int NULL,
	codEntidade int NULL,
	periodicidade char(1) DEFAULT M NULL,
	numParcela int DEFAULT 0 NULL,
	valorParcela numeric(15,2) NULL,
	valorTotal numeric(15,2) NULL,
	diasUteis char(1) DEFAULT N NULL,
	dataLancamento datetime DEFAULT getDate() NULL,
	codMarcador int NULL,
	realizado char(1) DEFAULT N NULL,
	obs varchar(255) NULL
) ;

CREATE TABLE GFI_lancamentos_parcelas ( 
	codLancamento int NOT NULL,
	codParcela int NOT NULL,
	numParcela int NULL,
	dataParcela smalldatetime NULL,
	valorParcela numeric(5,2) NULL,
	realizado char(1) DEFAULT N NULL
) ;

CREATE TABLE GFI_marcadores ( 
	codUsuario int NULL,
	codMarcador int identity(1,1)  NOT NULL,
	nome varchar(100) NULL,
	descricao varchar(255) NULL,
	cor varchar(7) NULL
) ;

CREATE TABLE GFI_permissoes ( 
	codPermissao int NOT NULL,
	descricao varchar(100) NULL
) ;

CREATE TABLE GFI_permissoes_telas ( 
	codTipoUsuario int NULL,
	codTela int NULL,
	codPermissao int NULL
) ;

CREATE TABLE GFI_telas ( 
	codTela int NOT NULL,
	codSuperior int NULL,
	ordem int NULL,
	descricao varchar(100) NULL,
	diretorio varchar(255) NULL,
	situacao char(1) NULL
) ;

CREATE TABLE GFI_tipos_contas ( 
	codTipoConta int identity(1,1)  NOT NULL,
	nome varchar(100) NULL
) ;

CREATE TABLE GFI_tipos_contas_bancos ( 
	codTipoConta int NOT NULL,
	codBanco int NOT NULL
) ;

CREATE TABLE GFI_tipos_usuarios ( 
	codTipoUsuario int NOT NULL,
	descricao varchar(50) NULL
) ;

CREATE TABLE GFI_usuarios ( 
	codUsuario int identity(1,1)  NOT NULL,
	codTipoUsuario int NULL,
	codCorretora int NULL,
	login varchar(20) NULL,
	senha varchar(10) NULL,
	nome varchar(50) NULL,
	email varchar(50) NULL,
	situacao char(1) NULL
) ;


ALTER TABLE GFI_administradoras_cartoes ADD CONSTRAINT PK_GFI_administradoras_cartoes 
	PRIMARY KEY CLUSTERED (codAdministradora) ;

ALTER TABLE GFI_bancos ADD CONSTRAINT PK_GFI_bancos 
	PRIMARY KEY CLUSTERED (codBanco) ;

ALTER TABLE GFI_contas ADD CONSTRAINT PK_GFI_contas 
	PRIMARY KEY CLUSTERED (codConta) ;

ALTER TABLE GFI_entidades ADD CONSTRAINT PK_GFI_entidades 
	PRIMARY KEY CLUSTERED (codEntidade) ;

ALTER TABLE GFI_lancamentos ADD CONSTRAINT PK_GFI_lancamentos 
	PRIMARY KEY CLUSTERED (codLancamento) ;

ALTER TABLE GFI_lancamentos_parcelas ADD CONSTRAINT PK_GFI_lancamentos_parcelas 
	PRIMARY KEY CLUSTERED (codLancamento, codParcela) ;

ALTER TABLE GFI_marcadores ADD CONSTRAINT PK_GFI_marcadores 
	PRIMARY KEY CLUSTERED (codMarcador) ;

ALTER TABLE GFI_permissoes ADD CONSTRAINT PK_GFI_permissoes 
	PRIMARY KEY CLUSTERED (codPermissao) ;

ALTER TABLE GFI_telas ADD CONSTRAINT PK_GFI_telas 
	PRIMARY KEY CLUSTERED (codTela) ;

ALTER TABLE GFI_tipos_contas ADD CONSTRAINT PK_GFI_tipos_contas 
	PRIMARY KEY CLUSTERED (codTipoConta) ;

ALTER TABLE GFI_tipos_contas_bancos ADD CONSTRAINT PK_GFI_tipos_contas_bancos 
	PRIMARY KEY CLUSTERED (codTipoConta, codBanco) ;

ALTER TABLE GFI_tipos_usuarios ADD CONSTRAINT PK_GFI_tipo_usuario 
	PRIMARY KEY CLUSTERED (codTipoUsuario) ;

ALTER TABLE GFI_usuarios ADD CONSTRAINT PK_GFI_usuarios 
	PRIMARY KEY CLUSTERED (codUsuario) ;