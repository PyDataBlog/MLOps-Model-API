<?php

namespace VM5\IpBundle\Tests\Utility;

use Symfony\Bundle\FrameworkBundle\Test\WebTestCase;

class Ipv4TypeTest extends WebTestCase
{

    /**
     * @var \Doctrine\ORM\EntityManager
     */
    private $em;

    /**
     * {@inheritDoc}
     */
    public function setUp()
    {
        self::bootKernel();
        $this->em = static::$kernel->getContainer()
                ->get('doctrine')
                ->getManager()
        ;
    }

    public function testType()
    {
        return;

        $ipAddresses = array(
            '192.168.1.7' => 3232235783,
            '127.0.0.1' => 2130706433,
            '74.125.71.94' => 1249724254,
            '217.174.146.30' => 3652096542
        );

        foreach ($ipAddresses as $sourceIp => $targetIp) {
            $ipAddressEntity = new \VM5\IpBundle\Tests\Entity\IpAddress();
            $ipAddressEntity->setSourceIp($sourceIp);
            $ipAddressEntity->setTargetIp($targetIp);

            $this->em->persist($ipAddressEntity);
        }
        $this->em->flush();

        $connection = $this->em->getConnection();
        foreach ($ipAddressEntity as $sourceIp => $targetIp) {
            $ipAddressEntity = $this->em->find('VM5\IpBundle\Tests\Entity\IpAddress', $sourceIp);
            $this->assertEquals($sourceIp, $ipAddressEntity->getTargetIp());



//            $this->assertEquals($targetIp, $databaseIP);
        }
    }

    /**
     * {@inheritDoc}
     */
    protected function tearDown()
    {
        parent::tearDown();
        $this->em->close();
    }

}
