<?php
/* Copyright (C) 2011-2015 Emmanuel DEROME - All rights reserved */

// Prevents any direct access
defined('_JEXEC') or die();

// echo "<h1>\n";
// echo JText::_('COM_EGS_ENTREPRISE');
// echo "</h1>\n";
?>

<form action="index.php" method="post" name="adminForm" id="adminForm">
	<?php
		$user = JFactory::getUser();                            // gets current user object
		$isEntreprise = (array_search('11', $user->groups));    // sets flag when user group is '11' that is 'EGS Entreprise'
		$isProf = (array_search('9', $user->groups));     		// sets flag when user group is '9' that is 'EGS Professeur'
		echo $this->getToolbar($isEntreprise, $isProf);   
		
		echo "<div class='pagetitle icon-48-article'><h2>\n";
		echo JText::_('COM_EGS_ENTREPRISE') . " : " . $this->entreprise->nom;
		echo "</h2></div>\n";				
	?>

	<div>
		<fieldset class="adminform">
			<table class="admintable">
				<tr>
					<td width="110" class="key">
						<label for="nom">
							<?php echo JText::_('COM_EGS_ENTREPRISES_NOM'); ?>:
						</label>
					</td>
					<td>						
						<?php if ($isEntreprise) {
							?> <input class="inputbox" type="text" name="nom" id="nom" size="60" value="<?php echo $this->entreprise->nom; ?>" />
						<?php } else {
							?> <input type="hidden" name="nom" value="<?php echo $this->entreprise->nom; ?>" /> <?php
							echo $this->entreprise->nom;
						} ?> 
					</td>
				</tr>
				<tr>
					<td width="110" class="key">
						<label for="logo">
							<?php echo JText::_('COM_EGS_ENTREPRISES_LOGO'); ?>:
						</label>
					</td>
					<td>
						<?php echo "<img src='" . JURI::root() . "images/logos/" . $this->entreprise->logo . "' border='0' />"; ?>
						<?php if ($isEntreprise) {
							?> <input class="inputbox" type="text" name="logo" id="logo" size="60" value="<?php echo $this->entreprise->logo; ?>" /> <?php
						} ?> 
					</td>
				</tr>
				<tr>
					<td width="110" class="key">
						<label for="activite">
							<?php echo JText::_('COM_EGS_ENTREPRISES_ACTIVITE'); ?>:
						</label>
					</td>
					<td>
						<?php if ($isEntreprise) {
							?> <textarea class="inputbox" type="text" name="activite" id="activite" cols='60' rows='4'><?php echo $this->entreprise->activite; ?></textarea>
						<?php } else {
							?> <input type="hidden" name="activite" value="<?php echo $this->entreprise->activite; ?>" /> <?php
							echo $this->entreprise->activite;
						} ?>	
					</td>
				</tr>
				<tr>
					<td width="110" class="key">
						<label for="siteWeb">
							<?php echo JText::_('COM_EGS_ENTREPRISES_SITEWEB'); ?>:
						</label>
					</td>
					<td>
						<?php if ($isEntreprise) {
							?> <input class="inputbox" type="text" name="siteWeb" id="siteWeb" size="60" value="<?php echo $this->entreprise->siteWeb; ?>" />
						<?php } else {
							?> <input type="hidden" name="siteWeb" value="<?php echo $this->entreprise->siteWeb; ?>" /> <?php
							echo $this->entreprise->siteWeb;
						} ?>	
					</td>
				</tr>
				<tr>
					<td width="110" class="key">
						<label for="adrRue">
							<?php echo JText::_('COM_EGS_ENTREPRISES_ADR_RUE'); ?>:
						</label>
					</td>
					<td>
						<?php if ($isEntreprise) {
							?> <input class="inputbox" type="text" name="adrRue" id="adrRue" size="60" value="<?php echo $this->entreprise->adrRue; ?>" />
						<?php } else {
							?> <input type="hidden" name="adrRue" value="<?php echo $this->entreprise->adrRue; ?>" /> <?php
							echo $this->entreprise->adrRue;
						} ?>	
					</td>
				</tr>
				<tr>
					<td width="110" class="key">
						<label for="adrVille">
							<?php echo JText::_('COM_EGS_ENTREPRISES_ADR_VILLE'); ?>:
						</label>
					</td>
					<td>
						<?php if ($isEntreprise) {
							?> <input class="inputbox" type="text" name="adrVille" id="adrVille" size="60" value="<?php echo $this->entreprise->adrVille; ?>" />
						<?php } else {
							?> <input type="hidden" name="adrVille" value="<?php echo $this->entreprise->adrVille; ?>" /> <?php
							echo $this->entreprise->adrVille;
						} ?>	
					</td>
				</tr>
				<tr>
					<td width="110" class="key">
						<label for="adrCP">
							<?php echo JText::_('COM_EGS_ENTREPRISES_ADR_CP'); ?>:
						</label>
					</td>
					<td>
						<?php if ($isEntreprise) {
							?> <input class="inputbox" type="text" name="adrCP" id="adrCP" size="60" value="<?php echo $this->entreprise->adrCP; ?>" />
						<?php } else {
							?> <input type="hidden" name="adrCP" value="<?php echo $this->entreprise->adrCP; ?>" /> <?php
							echo $this->entreprise->adrCP;
						} ?>	
					</td>
				</tr>
				<tr>
					<td width="110" class="key">
						<label for="pays_id">
							<?php echo JText::_('COM_EGS_ENTREPRISES_ADR_PAYS'); ?>:
						</label>
					</td>
					<td>
						<?php if ($isEntreprise) { 
							?> <select class="inputbox" name="pays_id" id="pays_id"> <?php
								$db =& JFactory::getDBO();
								$query2 = 'SELECT * FROM #__egs_pays ORDER BY pays';
								$db->setQuery($query2);
								$rows2 = $db->loadObjectList();
								foreach ($rows2 as $row2) {
									if ($this->entreprise->pays_id == $row2->id){
										echo "<option value='$row2->id' selected='selected'>$row2->pays</option>\n";  
									}else{
										echo "<option value='$row2->id'>$row2->pays</option>\n";  
									}
								} 
							?> </select> <?php						
						} else {
							?> <input type="hidden" name="pays_id" value="<?php echo $this->entreprise->pays_id; ?>" /> <?php
							$db = JFactory::getDBO();
							$query2 = 'SELECT * FROM #__egs_pays WHERE id = ' . $this->entreprise->pays_id;
							$db->setQuery($query2);
							$row2 = $db->loadObject();
							if ($row2) {echo $row2->pays;}
						} ?>
					</td>
				</tr>
			</table>
		</fieldset>
	</div>
	<div class="clr"></div>
	<div class="clr"></div>

	<input type="hidden" name="option" value="com_egs" />
	<input type="hidden" name="id" value="<?php echo $this->entreprise->id; ?>" />
	<input type="hidden" name="task" value="" />
	<input type="hidden" name="controller" value="entreprises" />
</form>
