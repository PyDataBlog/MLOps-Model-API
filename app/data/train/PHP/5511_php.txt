SELECT Dimensions, sum(Trans) as Trans, sum(Trans_Percent) as Trans_Percent
FROM (
    SELECT
    buyers_race as Dimensions,
    count(*) as Trans,
    round((count(*) / (SELECT count(*) FROM (SELECT transaction_type,
                                                       		  CASE transaction_type
                                                       			   WHEN 'D' THEN 2 * count(*)
                                                       			   ELSE count(*)
                                                      		  END AS Sales
                                                       FROM c2s_checklist_master
                                                       WHERE paid_unpaid = 'P'
                                                         AND EXTRACT(YEAR FROM transaction_date) = 2016) T2 )) * 100), 1) as Trans_Percent
    FROM c2s_checklist_master
    WHERE paid_unpaid = 'P' AND transaction_type = 'B' AND EXTRACT(YEAR FROM transaction_date) = 2016
    GROUP BY buyers_race
    ) T

    GROUP BY Dimensions ORDER BY Dimensions
