<?php

namespace Notebleu\Lexicon\Curators;

use Notebleu\Lexicon\Core\Curator;
use Notebleu\Lexicon\Entities\User;

/**
 * Class UserCurator
 * @package Notebleu\Lexicon\Curators
 *
 */
class Users extends Curator
{

    protected $className = User::class;

    final protected function prepareCoreArgs()
    {
        $args = [
            'number' => $this->constraints['limit'],
            'exclude' => $this->constraints['exclude'],
            'include' => $this->constraints['ids'],
            'offset' => $this->constraints['offset'],
            'order' => strtoupper($this->constraints['order']['direction']),
            'orderby' => $this->constraints['order']['by'],
            'has_published_posts' => $this->constraints['isAuthor']
        ];

        return $args;

    }

    final protected function getDefaultConstraints() {
        return [
            'limit' => '',
            'exclude' => null,
            'ids' => null,
            'offset' => '',
            'order' => [
                'by' => 'login',
                'direction' => 'ASC'
            ],
            'isAuthor' => null
        ];
    }

    /**
     * @param array $args
     *
     * @return \WP_User[]
     */
    protected function fetchRaw(array $args)
    {
        return $this->warp->get_users($args) ?: [];
    }

    /**
     * @return User[]
     */
    public function getArray()
    {
        return $this->createArray();
    }

    /**
     * @return User
     */
    public function getFirst()
    {
        return $this->first();
    }

    /**
     * @return User
     */
    public function getLast()
    {
        return $this->last();
    }

    /**
     * @param int $id
     *
     * @return User
     */
    public function getById($id)
    {
        return $this->byId($id);
    }
}