Imports M_OrderLibrary
Imports System.Drawing


'PNG (Portable Network Graphics)
'Il formato PNG consente di usufruire di molti dei vantaggi offerti dal formato GIF, ma fornisce anche ulteriori funzionalità rispetto a tale formato. Analogamente ai file GIF, i file PNG vengono compressi senza alcuna perdita di informazioni. È possibile memorizzare nei file PNG colori con 8, 24 o 48 bit per pixel e scale di grigi con 1, 2, 4, 8 o 16 bit per pixel. I file GIF consentono di memorizzare solo 1, 2, 4 o 8 bit per pixel. È inoltre possibile memorizzare in un file PNG anche un valore alfa per ogni pixel, che consente di specificare il livello di fusione del colore di tale pixel con il colore dello sfondo.
'Il formato PNG rappresenta un miglioramento della capacità del formato GIF di visualizzare progressivamente un'immagine, ovvero di visualizzare approssimazioni sempre migliori di un'immagine mentre viene trasmessa attraverso una connessione di rete. È possibile memorizzare nei file PNG informazioni relative alla correzione gamma e alla correzione dei colori, in modo da consentire il rendering accurato delle immagini su svariate periferiche di visualizzazione.


Public Class LibFoto

    Private Shared pathimage As String
    Private Shared _variante As String


    Public Shared Function LoadResourceImage(ByVal imageName As String) As Bitmap
        Return New Bitmap(System.Reflection.Assembly.GetExecutingAssembly(). _
         GetManifestResourceStream("M_Order." + imageName))
    End Function

#If CONFIG = "Desktop" Then
    Public Const imgEXT As String = ".jpg"
#Else
    Public Const imgEXT As String = ".jpeg"
#End If

    Public Shared Function SetFoto(ByVal pic As PictureBox, Optional ByVal variante As Integer = 0) As PictureBox
        If LibSettings.MostraFoto Then
            Try
                If variante = 0 Then
                    _variante = ""
                Else
                    _variante = "_" & variante.ToString.PadLeft(2, "0"c)
                End If

                pathimage = LibDb.FolderFoto & LibSettings.CodArticolo & _variante & imgEXT
                If IO.File.Exists(pathimage) Then
                    pic.Image = New Bitmap(pathimage)
                    pic.SizeMode = PictureBoxSizeMode.CenterImage
                    'Il file rimarrà bloccato fino all'eliminazione dell'oggetto Bitmap
                Else
                    'carica immagine vuota
                    pic.Image = LibFoto.LoadResourceImage("foto.jpeg")
                    pic.SizeMode = PictureBoxSizeMode.CenterImage
                End If
            Catch ex As Exception
                'MessageBox.Show(ex.Message)
            End Try
        End If
        Return pic
    End Function
End Class
