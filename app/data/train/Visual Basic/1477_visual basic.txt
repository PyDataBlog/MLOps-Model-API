Imports WeifenLuo.WinFormsUI.Docking
Imports OxyPlot
Imports OxyPlot.Series
Imports MathNet.Numerics
Public Class GraphDockPanel : Inherits DockContent
    Sub New()

        ' This call is required by the designer.
        InitializeComponent()

        ' Add any initialization after the InitializeComponent() call.
        InitializePlot()
    End Sub

    Private Sub InitializePlot()
        Dim plot = New PlotModel
        Dim lseries = New LineSeries
        Dim lseries2 = New LineSeries
        Dim lseries3 = New LineSeries

        plot.Axes.Add(New Axes.LinearAxis With {.Position = Axes.AxisPosition.Left})
        plot.Axes.Add(New Axes.LinearAxis With {.Position = Axes.AxisPosition.Bottom})
        For i = 0 To 200
            Dim ydata = Math.Cos(i * Math.PI / 100)
            lseries.Points.Add(New DataPoint(i, ydata))
            lseries2.Points.Add(New DataPoint(i + 5, ydata))
            lseries3.Points.Add(New DataPoint(i + 10, ydata))
        Next
        plot.Series.Add(lseries)
        plot.Series.Add(lseries2)
        plot.Series.Add(lseries3)
        Me.mainPlot.Model = plot

    End Sub

    Public Sub AddSeries(ByVal data As Double(,))
        Dim lseries = New LineSeries

        For i = 0 To Math.Floor(data.Length / 2) - 1
            lseries.Points.Add(New DataPoint(data(0, i), data(1, i)))
        Next
        Me.mainPlot.Model.Series.Add(lseries)
    End Sub

    Property Plot
        Get
            Plot = Me.mainPlot
        End Get
        Set(value)

        End Set
    End Property

End Class