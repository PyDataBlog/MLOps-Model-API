Public Class ChangePassWord

    Private Sub ChangePassWord_FormClosed(ByVal sender As Object, ByVal e As System.Windows.Forms.FormClosedEventArgs) Handles Me.FormClosed
        End
    End Sub

    Private Sub ChangePassWord_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        Text_Wnum.Text = User.UserID
        If User.UType = "普通用户" Then
            Text_Wnum.Enabled = False
        Else
            Text_Wnum.Enabled = True
            'Label2.Text = "用户名"
            Button1.Text = "更新"
        End If
        UserType1 = ''
        Me.FormBorderStyle = Windows.Forms.FormBorderStyle.Fixed3D
    End Sub

    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
        SQLString = "select * from Admin where Wnum= '" & Trim(Text_Wnum.Text) & "'and Password = '" & Trim(Text_Name.Text) & "'"
        UserType1 = Trim(CDBOperation.DBsearch(SQLString, "UserType"))

        If UserType1 <> "未来可期" Then

            If Trim(TextBox1.Text) <> "" And Trim(TextBox2.Text) <> "" Then

                If Trim(TextBox1.Text) = Trim(TextBox2.Text) Then
                    SQLString = "UPDATE admin set password = '" & TextBox1.Text & " ' where Wnum = '" & Text_Wnum.Text & " '"
                    CDBOperation.DBoperate(SQLString， 1)
                Else
                    MsgBox("前后两次输入的密码不一致", MsgBoxStyle.Exclamation, strInfo)
                End If

            Else
                MsgBox("前后两次输入的密码均不能为空", MsgBoxStyle.Exclamation, strInfo)
            End If

        Else
            MsgBox("密码输入错误", MsgBoxStyle.Exclamation, strInfo)
        End If

    End Sub

    Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button2.Click
        Frm_Main.Show()
        Me.Dispose()
        Me.Hide()
    End Sub

    Private Sub Text_Wnum_TextChanged(sender As Object, e As EventArgs) Handles Text_Wnum.TextChanged

    End Sub

    Private Sub Text_Name_TextChanged(sender As Object, e As EventArgs) Handles Text_Name.TextChanged

    End Sub

    Private Sub Label3_Click(sender As Object, e As EventArgs) Handles Label3.Click

    End Sub

    Private Sub TextBox1_TextChanged(sender As Object, e As EventArgs) Handles TextBox1.TextChanged

    End Sub

    Private Sub ChangePassWord_Closed(sender As Object, e As EventArgs) Handles Me.Closed
        End
    End Sub
End Class