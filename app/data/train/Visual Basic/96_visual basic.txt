Imports System.Windows.Forms

Public Class EnterNewSignal
    Public inplayer As Integer = 0
    Public outKeyCode As Integer = 0

    Private Sub OK_Button_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles OK_Button.Click
        Me.DialogResult = System.Windows.Forms.DialogResult.OK
        Me.Close()
    End Sub

    Private Sub Cancel_Button_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Cancel_Button.Click
        Me.DialogResult = System.Windows.Forms.DialogResult.Cancel
        Me.Close()
    End Sub

    Private Sub EnterNewSignal_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        Label1.Text = "Please press the key to use" & vbCrLf & "for player " & inplayer
        Me.KeyPreview = True
    End Sub

    Public Sub HandleKeyStroke(ByVal sender As Object, ByVal e As KeyEventArgs) Handles Me.KeyDown
        Label1.Text = "New Key Code" & vbCrLf & "for player " & inplayer & vbCrLf & "is " & e.KeyCode & "(" & Asc(e.KeyCode) & ")"
        outKeyCode = e.KeyCode
    End Sub

End Class
