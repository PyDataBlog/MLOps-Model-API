Namespace Extensions

    Public Module System_Windows_Forms_FolderBrowserDialog

        <System.Runtime.CompilerServices.Extension()> Public Function STAShowDialog(fbd As System.Windows.Forms.FolderBrowserDialog) As Windows.Forms.DialogResult
            Dim State As New Models.DialogState
            State.FolderBrowserDialog = fbd
            Dim SubThread As New Threading.Thread(AddressOf State.ShowFolderBrowserDialog)
            SubThread.SetApartmentState(Threading.ApartmentState.STA)
            SubThread.Start()
            SubThread.Join()
            Return State.DialogResult
        End Function

    End Module

End Namespace