Imports System.Security
Imports System.Security.Cryptography
Imports System.IO
Imports System.Text
Imports System.Reflection

Module Hash
    'File Hashing

    Public Function fileMD5(ByVal fileName As String)
        Dim md5 = Cryptography.MD5.Create
        Dim md5hash As Byte()
        Dim sysSB As New StringBuilder

        Using st As New FileStream(fileName, FileMode.Open, FileAccess.Read, FileShare.ReadWrite)
            md5hash = md5.ComputeHash(st)
        End Using

        For Each b In md5hash
            sysSB.Append(b.ToString("X2"))
        Next
        Return sysSB.ToString
    End Function

    Public Function fileSHA1(ByVal fileName As String)
        Dim sha1 = Cryptography.SHA1.Create
        Dim sha1hash As Byte()
        Dim sysSB As New StringBuilder

        Using st As New FileStream(fileName, FileMode.Open, FileAccess.Read, FileShare.ReadWrite)
            sha1hash = sha1.ComputeHash(st)
        End Using
        For Each b In sha1hash
            sysSB.Append(b.ToString("X2"))
        Next
        Return sysSB.ToString
    End Function

    Public Function fileSHA256(ByVal fileName As String)
        Dim sha256 = Cryptography.SHA256.Create
        Dim sha256hash As Byte()
        Dim sysSB As New StringBuilder

        Using st As New FileStream(fileName, FileMode.Open, FileAccess.Read, FileShare.ReadWrite)
            sha256hash = sha256.ComputeHash(st)
        End Using
        For Each b In sha256hash
            sysSB.Append(b.ToString("X2"))
        Next
        Return sysSB.ToString
    End Function

    Public Function fileSHA512(ByVal fileName As String)
        Dim sha512 = Cryptography.SHA512.Create
        Dim sha512hash As Byte()
        Dim sysSB As New StringBuilder

        Using st As New FileStream(fileName, FileMode.Open, FileAccess.Read, FileShare.ReadWrite)
            sha512hash = sha512.ComputeHash(st)
        End Using
        For Each b In sha512hash
            sysSB.Append(b.ToString("X2"))
        Next
        Return sysSB.ToString
    End Function


    'String Hashing

    Public Function stringSHA1(ByVal str As String)
        Dim sha1 As New SHA1CryptoServiceProvider()
        Dim sha1hash As Byte()
        Dim sysSB1 As New StringBuilder

        sha1hash = Encoding.ASCII.GetBytes(str)
        sha1hash = sha1.ComputeHash(sha1hash)

        For Each b In sha1hash
            sysSB1.Append(b.ToString("X2"))
        Next
        Return sysSB1.ToString.ToLower()
    End Function

End Module