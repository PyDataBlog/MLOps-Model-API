Imports System.Reflection
Imports Microsoft.Office.Interop

Module MicrosoftCalendar
    Public Sub CreateAppointment(ByVal title As String, ByVal startTime As DateTime, ByVal endTime As DateTime)
        ' Create an Outlook application.
        Dim oApp As Outlook.Application = New Outlook.Application()

        ' Get NameSpace and Logon.
        Dim oNs As Outlook.NameSpace = oApp.GetNamespace("mapi")
        oNS.Logon("", "", True, True) ' TODO:

        ' Create a new AppointmentItem.
        Dim oAppt As Outlook.AppointmentItem = oApp.CreateItem(Outlook.OlItemType.olAppointmentItem)
        'oAppt.Display(true)  'Modal	

        ' Set some common properties.
        oAppt.Subject = "Created using OOM in C#"
        oAppt.Body = "Hello World"
        oAppt.Location = "Samm E"

        oAppt.Start = Convert.ToDateTime("30/08/2015 9:00:00 AM")
        oAppt.End = Convert.ToDateTime("30/08/2015 1:00:00 PM")

        oAppt.ReminderSet = True
        oAppt.ReminderMinutesBeforeStart = 5
        oAppt.BusyStatus = Outlook.OlBusyStatus.olBusy  '  olBusy
        oAppt.IsOnlineMeeting = False

        ' Save to Calendar.
        oAppt.Save()

        ' Display.
        'oAppt.Display(true)

        ' Logoff.
        oNS.Logoff()

        ' Clean up.
        oApp = Nothing
        oNS = Nothing
        oAppt = Nothing
    End Sub

End Module
