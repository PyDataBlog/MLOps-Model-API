'
'    ____
'   |  _ \ ___ _ __ ___  ___ _   _ ___
'   | |_) / _ \ '__/ __|/ _ \ | | / __|
'   |  __/  __/ |  \__ \  __/ |_| \__ \
'   |_|   \___|_|  |___/\___|\__,_|___/
'
'   Perseus Compiler Kernel
'
'
'   (c) Perseus Developers (owner: minxomat)
'
'   =====================================================================================================

Option Strict Off
Option Explicit On

Module Enviroment
#Region "Types"
    Structure TYPE_TYPE
        Dim Name As String
        Dim Source As String
    End Structure

    Structure TYPE_OBJECT
        Dim Declares As String
        Dim Name As String
        Dim ObjectProperty As Boolean
        Dim ReturnAs As String
    End Structure

    Structure TYPE_CONSTANT
        Dim Name As String
        Dim Value As String
    End Structure

    Structure TYPE_SYMBOL
        Dim IsProto As Boolean
        Dim Name As String
        Dim Offset As Integer
        Dim Section As ENUM_SECTION_TYPE
        Dim SymType As ENUM_SYMBOL_TYPE
    End Structure

    Structure TYPE_EXPORT
        Dim Name As String
        Dim Ordinal As Short
    End Structure

    Structure TYPE_RELOCATION
        Dim Offset As Integer
    End Structure

    Structure TYPE_IMPORT
        Dim ImportAlias As String
        Dim Library As String
        Dim Name As String
        Dim pCount As Integer
        Dim Used As Boolean
    End Structure

    Structure TYPE_FIXUP
        Dim ExtraAdd As Integer
        Dim Name As String
        Dim Offset As Integer
        Dim Section As ENUM_SECTION_TYPE
    End Structure

    Structure TYPE_SECTION
        Dim Bytes() As Byte
        Dim Characteristics As ENUM_SECTION_CHARACTERISTICS
        Dim Name As String
        Dim SectionType As ENUM_SECTION_TYPE
    End Structure

    Enum ENUM_APP_TYPE
        GUI = 2
        CUI = 3
    End Enum

    Enum ENUM_SECTION_CHARACTERISTICS
        CH_CODE = &H20
        CH_INITIALIZED_DATA = &H40
        CH_MEM_DISCARDABLE = &H2000000
        CH_MEM_EXECUTE = &H20000000
        CH_MEM_READ = &H40000000
        CH_MEM_WRITE = &H80000000
    End Enum

    Enum ENUM_SECTION_TYPE
        SET_DATA = 1
        SET_CODE = 2
        SET_IMPORT = 3
        SET_EXPORT = 4
        SET_RESOURCE = 5
        SET_LINKER = 6
        SET_RELOCATE = 7
    End Enum

    Enum ENUM_SYMBOL_TYPE
        ST_LABEL = 2
        ST_DWORD = 3
        ST_WORD = 4
        ST_BYTE = 5
        ST_US_DWORD = 6
        ST_US_WORD = 7
        ST_US_BYTE = 8
        ST_STRING = 9
        ST_TYPE = 10
        ST_IMPORT = 11
        ST_EXPORT = 12
        ST_OBJECT = 14
        ST_LOCAL_DWORD = 15
        ST_LOCAL_STRING = 16
        ST_LOCAL_SINGLE = 17
        ST_SINGLE = 18
    End Enum
#End Region

#Region "Strings"
    Public sSourceCode As String
    Public sOutputFile As String
    Public sDebugMsg As String = ""
    Public sEntryPointName As String
    Public sWithVar As String
    Public sCurSec As String
    Public sCurType As String
    Public sAssign As String
    Public sLeftComp As String
    Public sRightComp As String
    Public sRelation As String
	Public sCurObject As String
	Public sSyntax As String
	Public sParserOutput As String
#End Region

#Region "Counters"
	Public iCarryProg As Long
	Public iSrcProg As Long
	Public iSrcPos As Long
	Public iTypesLeft As Integer
	Public dUniqueID As Integer
	Public fUniqueID As Integer
	Public lUniqueID As Integer
	Public eUniqueID As Integer
	Public iEvalCount As Integer
	Public iArgCount As Integer
	Public iSecsSize As Integer
	Public iSecsSizeRaw As Integer
	Public iSizeOfHeader As Integer
	Public iJustTabs As Integer = 0
#End Region

#Region "Flags"
	Public bVerbose As Boolean = False
	Public bErrorOccured As Boolean = False
	Public bUnsigned As Boolean
	Public bFloat As Boolean
	Public bStringCompare As Boolean
	Public bCallObject As Boolean
	Public bDLL As Boolean
#End Region

#Region "Collections"
    Public Types() As TYPE_TYPE
    Public Objects() As TYPE_OBJECT
    Public ConstantList() As TYPE_CONSTANT
    Public Symbols() As TYPE_SYMBOL
    Public Exports() As TYPE_EXPORT
    Public Relocations() As TYPE_RELOCATION
    Public ImportsList() As TYPE_IMPORT
    Public Fixups() As TYPE_FIXUP
    Public AppType As ENUM_APP_TYPE
    Public Section() As TYPE_SECTION
#End Region
End Module
