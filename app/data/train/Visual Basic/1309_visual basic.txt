Imports System.Windows.Forms

Public Class Options

    Private Sub OK_Button_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles OK_Button.Click
        With My.Settings
            .SplashScreen = ShowSplashScreen.Checked
            .BigIcon = BigIcon.Checked

            Select Case ComboLanguage.SelectedIndex
                Case 0
                    .Language = vbNullString
                Case 1
                    .Language = "ru-RU"
                Case 2
                    .Language = "en-US"
            End Select

            .Save()
        End With

        Me.DialogResult = System.Windows.Forms.DialogResult.OK
        Me.Close()
    End Sub

    Private Sub Cancel_Button_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Cancel_Button.Click
        Me.DialogResult = System.Windows.Forms.DialogResult.Cancel
        Me.Close()
    End Sub

    Private Sub Options_Load(sender As System.Object, e As System.EventArgs) Handles MyBase.Load
        With My.Settings
            ShowSplashScreen.Checked = .SplashScreen
            BigIcon.Checked = .BigIcon

            Select Case Trim(.Language)
                Case "ru-RU"
                    ComboLanguage.SelectedIndex = 1
                Case "en-US"
                    ComboLanguage.SelectedIndex = 2
                Case Else
                    ComboLanguage.SelectedIndex = 0
            End Select
        End With
    End Sub
End Class
