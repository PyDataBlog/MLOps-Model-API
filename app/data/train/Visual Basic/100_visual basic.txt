Namespace Extensions

    Public Module System_Data_SqlClient_SqlCommand

        <System.Runtime.CompilerServices.Extension()> Public Sub AddParameters(cmd As System.Data.SqlClient.SqlCommand, parameters As IDictionary(Of String, Object))
            If cmd Is Nothing Then
                Return
            End If
            If parameters Is Nothing Then
                Return
            End If
            If parameters.Count <= 0 Then
                Return
            End If
            cmd.Parameters.AddRange(parameters.Select(Function(o) New System.Data.SqlClient.SqlParameter(o.Key, Data.GetDBParameter(o.Value))).ToArray())
        End Sub

    End Module

End Namespace