Imports Com.Aspose.Tasks.Api
Imports Com.Aspose.Tasks.Model
Imports Com.Aspose.Storage.Api

Namespace Resources
    Class AddResource
        Public Shared Sub Run()
            ' ExStart:1
            Dim tasksApi As New TasksApi(Common.APP_KEY, Common.APP_SID, Common.BASEPATH)
            Dim storageApi As New StorageApi(Common.APP_KEY, Common.APP_SID, Common.BASEPATH)

            ' Set input file name
            Dim name As [String] = "sample-project.mpp"
            Dim resourceName As [String] = "Resource6"
            Dim beforeResourceId As Integer = 1
            Dim fileName As [String] = ""
            Dim storage As [String] = ""
            Dim folder As [String] = ""

            Try
                ' Upload source file to aspose cloud storage
                storageApi.PutCreate(name, "", "", System.IO.File.ReadAllBytes(Common.GetDataDir() + name))

                ' Invoke Aspose.Tasks Cloud SDK API to add resource informations
                Dim apiResponse As ResourceItemResponse = tasksApi.PostProjectResource(name, resourceName, beforeResourceId, fileName, storage, folder)

                If apiResponse IsNot Nothing Then
                    Console.WriteLine("Add a Resource To Project, Done!")
                    Console.ReadKey()
                End If
            Catch ex As Exception

                System.Diagnostics.Debug.WriteLine("error:" + ex.Message + vbLf + ex.StackTrace)
            End Try
            ' ExEnd:1
        End Sub
    End Class
End Namespace
