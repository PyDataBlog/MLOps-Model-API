Public Class NewMissionForm
    Public MissionObjController As MissionObjectController
    Public TransporterObjController As TransporterObjectController
    Public MaxAnalyzers As Integer
    Public MaxScans As Integer
    Public MaxSwitchDrivers As Integer
    Public MaxPositioners As Integer
    Public SurveyNumber As Integer = 0
    Public AddSurvey As Boolean = False

    Public Sub New(ByRef aMissionObjController As MissionObjectController, Optional ByVal add As Boolean = False, Optional ByVal index As Integer = 0)
        Me.MissionObjController = aMissionObjController
        Me.maxAnalyzers = Me.MissionObjController.aMain.missionObj.getMaxMissionObjects
        Me.maxScans = Me.MissionObjController.aMain.missionObj.getMaxMissionObjects
        Me.maxSwitchDrivers = Me.MissionObjController.aMain.missionObj.getmaxSwitchDrivers
        Me.maxPositioners = Me.MissionObjController.aMain.missionObj.getmaxPositioners
        Me.addSurvey = add
   
        'This call is required by the designer.
        InitializeComponent()

        'populate the analyzer combo box drop down
        With Me.MissionObjController.aMain.missionObj
            For ii As Integer = 0 To .getNumberAnalyzersDefined
                If .getAnalyzer(ii) Is Nothing Then
                    Exit For
                Else
                    Me.cmbBxAzr.Items.Add("Analyzer " & ii)
                End If
            Next
        End With

        If add = True Then
            Me.GroupBoxAnalyzers.Visible = False
            Me.GroupBoxScan.Visible = True
            Me.grpBxMissions.Visible = False
            Me.numUpDwnScans.Maximum = Me.maxScans
            Me.numUpDwnNumSwitchDrivers.Maximum = Me.maxSwitchDrivers
            Me.numUpDwnNumPositoners.Maximum = Me.maxPositioners
            Me.surveyNumber = index
          Me.lblSurveyNumber.Text = Me.surveyNumber
            Me.txtBxSurveyName.Text = "Survey " & Me.surveyNumber
        End If

        ' Add any initialization after the InitializeComponent() call.
        Me.StartPosition = FormStartPosition.Manual
        Me.Left = 300
        Me.Top = 300
        Me.Visible = True

    End Sub

    Private Sub Button1_Click_1(sender As System.Object, e As System.EventArgs) Handles Button1.Click
        Me.MissionObjController.defineParameters(Me.txtBxMissionName.Text, Me.NumUpDwnNumOfAnalyzers.Value)
        Me.GroupBoxAnalyzers.Visible = False
        Me.GroupBoxScan.Visible = True
        Me.numUpDwnScans.Maximum = Me.maxScans
        Me.numUpDwnNumSwitchDrivers.Maximum = Me.maxSwitchDrivers
        Me.numUpDwnNumPositoners.Maximum = Me.maxPositioners
        Me.lblSurveyNumber.Text = Me.surveyNumber
        Me.txtBxSurveyName.Text = "Survey " & Me.surveyNumber
    End Sub

    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnDefineAnalyzers.Click
        If Me.cmbBxAzr.SelectedIndex < 0 Then
            Me.cmbBxAzr.SelectedIndex = 0
        End If
        Me.MissionObjController.defineSurvey(Me.surveyNumber, Me.txtBxSurveyName.Text, Me.numUpDwnScans.Value, Me.numUpDwnNumSwitchDrivers.Value, Me.numUpDwnNumSwitches.Value, Me.numUpDwnNumPositoners.Value, Me.cmbBxAzr.SelectedIndex)
        Me.surveyNumber += 1
        Me.lblSurveyNumber.Text = Me.surveyNumber
        Me.txtBxSurveyName.Text = "Survey " & Me.surveyNumber
        Me.numUpDwnScans.Value = 0
        Me.numUpDwnNumSwitchDrivers.Value = 0
        Me.numUpDwnNumPositoners.Value = 0
        ' If Me.surveyNumber >= Me.MissionObjController.editDeleteExistingMissionForm.EditTransporterController.aTransport.getNumSurveysDefined Then
        If Me.surveyNumber >= Me.MissionObjController.aMain.NewTransporterObject.getNumSurveysDefined Then

            Me.Close()
        End If

        'add this new survey back into the editTransport cmbBx of surveys
        If Me.addSurvey = True Then
            With Me.MissionObjController.editDeleteExistingMissionForm.EditTransporterController.EditTransporterForm
                .cmbBxScanNames.Items.Clear()
                'changed 7/6
                'For ii As Integer = 0 To Me.MissionObjController.aMain.TransporterObj.getNumSurveysDefined - 1
                '    .cmbBxScanNames.Items.Add(Me.MissionObjController.aMain.TransporterObj.getSurveyObject(ii).getName)
                'Next
                For ii As Integer = 0 To Me.MissionObjController.editDeleteExistingMissionForm.EditTransporterController.aTransport.getNumSurveysDefined - 1
                    .cmbBxScanNames.Items.Add(Me.MissionObjController.editDeleteExistingMissionForm.EditTransporterController.aTransport.getSurveyObject(ii).getName)
                Next
            End With
        End If
    End Sub

End Class