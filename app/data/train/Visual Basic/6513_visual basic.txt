Imports System.Runtime.Serialization.Formatters.Binary
Imports System.IO
<System.Serializable()>
Public Class Memory

    Public allScripts As Dictionary(Of String, JsScript)

    Public Sub New()
        allScripts = New Dictionary(Of String, JsScript)
        Dim temp As New JsScript(True, My.Resources.RandomKeyBoard, "Random Keyboard Colors", False)
        Dim temp1 As New JsScript(False, My.Resources.ReactiveBlink, "Reactive Keyboard no GUI (enable this and click on your keyboard)", False)
        Dim temp2 As New JsScript(True, My.Resources.FullKeyboardSelection, "Keyboard Color Selector", False)
        Dim temp3 As New JsScript(False, My.Resources.AllRed, "All Red (One time run)", False)
        allScripts.Add(temp.name, temp)
        allScripts.Add(temp1.name, temp1)
        allScripts.Add(temp2.name, temp2)
        allScripts.Add(temp3.name, temp3)
    End Sub

    Public Sub Save(filename As String)
        Dim fs As FileStream = New FileStream(filename, FileMode.OpenOrCreate)
        Dim bf As New BinaryFormatter()
        bf.Serialize(fs, Me)
        fs.Close()
    End Sub
    Public Shared Function Open(filename As String) As Memory
        Dim fsRead As New FileStream(filename, FileMode.Open)
        Try
            Dim bf As New BinaryFormatter()
            Dim objTest As Object = bf.Deserialize(fsRead)
            fsRead.Close()
            Return CType(objTest, Memory)
        Catch ex As Exception
            fsRead.Close()
            Throw ex
        End Try
    End Function
End Class
