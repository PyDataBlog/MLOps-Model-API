Imports MySql.Data.MySqlClient

Namespace Dao.MySQL
    Public Class ConnectionFactory
        Public Function GetConnection() As MySqlConnection
            Dim user As String = Configuracao.Configuracao.LerValor(Configuracao.Configuracao.Section.Conexao, Configuracao.Configuracao.KeyName.user, "") '"root"
            Dim pwd As String = Configuracao.Seguranca.DescriptografaString(Configuracao.Configuracao.LerValor(Configuracao.Configuracao.Section.Conexao, Configuracao.Configuracao.KeyName.password, "")) '"sysdba"
            Dim dbName As String = Configuracao.Configuracao.LerValor(Configuracao.Configuracao.Section.Conexao, Configuracao.Configuracao.KeyName.Schema, "") '"sgv"
            Dim dbHostname As String = Configuracao.Configuracao.LerValor(Configuracao.Configuracao.Section.Conexao, Configuracao.Configuracao.KeyName.ip, "") '"192.168.0.1"
            Dim port As String = Configuracao.Configuracao.LerValor(Configuracao.Configuracao.Section.Conexao, Configuracao.Configuracao.KeyName.port, "") '"3306"
            Dim url As String = "Server=" & dbHostname & ";Port=" & port & ";DataBase=" & dbName & ";Uid=" & user & ";Pwd=" & pwd
            Dim conn As New MySqlConnection(url)
            conn.Open()
            Return conn
        End Function
    End Class
End Namespace