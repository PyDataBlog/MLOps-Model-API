Module Carrito

    Public Sub setCarrito(ByRef dgv As DataGridView)

        If formMain.carrito.Tables.Contains("Compras") Then
            If Not formMain.carrito.Tables("Compras").Columns.Contains("Items") Then
                For i = 0 To 5
                    formMain.carrito.Tables("Compras").Columns.Add(New DataColumn)
                Next
                formMain.carrito.Tables("Compras").Columns("column1").ColumnName = "id"
                formMain.carrito.Tables("Compras").Columns("column2").ColumnName = "idItem"
                formMain.carrito.Tables("Compras").Columns("column3").ColumnName = "Items"
                formMain.carrito.Tables("Compras").Columns("column4").ColumnName = "Número"
                formMain.carrito.Tables("Compras").Columns("column5").ColumnName = "Precio"
                formMain.carrito.Tables("Compras").Columns("column6").ColumnName = "Forma de Pago"
            End If
        End If

        dgv.ColumnHeadersDefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleCenter
        dgv.AutoSizeColumnsMode = DataGridViewAutoSizeColumnsMode.Fill
        dgv.SelectionMode = DataGridViewSelectionMode.FullRowSelect
        dgv.DefaultCellStyle.Alignment = DataGridViewContentAlignment.MiddleCenter
        formMain.carrito.Tables("Compras").Columns("id").AutoIncrement = True
        formMain.carrito.Tables("Compras").Columns("id").AutoIncrementSeed = 1

        dgv.DataSource = formMain.carrito.Tables("Compras")
        dgv.Columns("idItem").Visible = False
        dgv.Columns("id").Visible = False

    End Sub
    Public Function setClienteCarrito(ByVal cliente As String, ByVal dni As String)

        If formMain.userCarrito(1) = "" Or formMain.userCarrito(1) = dni Then
            VistaCarrito.tbCliente.Text = cliente
            formMain.userCarrito(0) = cliente
            VistaCarrito.tbDNI.Text = "DNI: " & dni
            formMain.userCarrito(1) = dni
            VistaCarrito.tbFecha.Text = "Fecha: " & Now()
            Return ("Correcto")
        Else
            VistaCarrito.tbCliente.Text = formMain.userCarrito(0)
            VistaCarrito.tbDNI.Text = "DNI: " & formMain.userCarrito(1)
            VistaCarrito.tbFecha.Text = "Fecha: " & DateTime.Now.ToString("dd/MM/yyyy")
            Return ("AlreadySet")
        End If

    End Function
    Public Sub agregarAlCarrito(ByRef Item As String, ByVal Numero As String, ByVal Precio As Double, ByVal FormaPago As String)

        Dim idItem As Integer = obtenerID("Items", "nombre", Item)

        formMain.carrito.Tables("Compras").Rows.Add(Nothing, idItem, Item, Numero, Precio, FormaPago)

    End Sub
    Public Sub quitarDelCarrito(ByVal id As Integer)

        For i = 0 To formMain.carrito.Tables("Compras").Rows.Count - 1
            If formMain.carrito.Tables("Compras").Rows(i).Item("id") = id Then
                formMain.carrito.Tables("Compras").Rows.Remove(formMain.carrito.Tables("Compras").Rows(i))
                Exit For
            End If
        Next

    End Sub
    Public Function cantidadItemsCarrito(ByVal item As String)

        Dim contador As Integer = 0

        For i = 0 To formMain.carrito.Tables("Compras").Rows.Count - 1
            If formMain.carrito.Tables("Compras").Rows(i).Item("Items") = item Then
                contador = contador + 1
            End If
        Next

        Return (contador)

    End Function

End Module