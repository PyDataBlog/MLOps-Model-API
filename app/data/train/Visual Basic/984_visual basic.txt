VERSION 5.00
Begin {C62A69F0-16DC-11CE-9E98-00AA00574A4F} select_customers 
   Caption         =   "list customer connections"
   ClientHeight    =   4725
   ClientLeft      =   45
   ClientTop       =   360
   ClientWidth     =   8040
   OleObjectBlob   =   "select_customers.frx":0000
   StartUpPosition =   1  'Fenstermitte
End
Attribute VB_Name = "select_customers"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Private Sub UserForm_Activate()
Rem fill list field
Call fill_data
Rem fill list field eof

Rem north/south
cb_n_s.Clear
cb_n_s.AddItem "north"
cb_n_s.AddItem "south"
Rem nordth/south eof
End Sub

Private Sub cb_show_Click()

select_customers.Hide
ControlPanel.Hide
Sheets("Overview").Activate
    Cells.Select
    Selection.sort Key1:=Range("B2"), Order1:=xlAscending, Key2:=Range("C2") _
        , Order2:=xlAscending, Header:=xlYes, OrderCustom:=1, MatchCase:=False _
        , Orientation:=xlTopToBottom, DataOption1:=xlSortNormal, DataOption2:= _
        xlSortNormal
    Selection.AutoFilter Field:=1, Criteria1:=list_customers.Value
If cb_n_s.Value <> "" Then
    Selection.AutoFilter Field:=24, Criteria1:=cb_n_s.Value
End If
Cells(2, 1).Select
End Sub

Private Sub fill_data()

Dim i As Integer

list_customers.Clear

Rem kundenliste sortieren
Call sort_customer
Rem kundenliste sortieren

Rem kunden einlesem

x = 1

For i = 1 To 70

If Sheets("Values").Cells(x, 1).Value = "" Then

    If Sheets("Values").Cells(x + 1, 1).Value = "" Then
    Exit Sub
    Else
    x = x + 1
    End If
Else
list_customers.AddItem Sheets("Values").Cells(x, 1).Value
x = x + 1
End If

Next

Rem kunden einlesen eof

End Sub

Sub sort_customer()

With Worksheets("Values")
     .Range("A1:A70").sort Key1:=.Range("A1"), Order1:=xlAscending, Header:=xlNo, _
        OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _
        DataOption1:=xlSortNormal
        
Rem Name define for Validation
        
ActiveWorkbook.names.Add Name:="Customers", RefersToR1C1:= _
        "=OFFSET(Values!R1C1,0,0,COUNTA(Values!C1),1)"
        
Rem Name define for Validation eof

End With

End Sub
