Imports System.IO
Imports System.Runtime.InteropServices

Module Example
    <STAThread()> _
    Sub Main()

        Dim objApplication As SolidEdgeFramework.Application
        Dim objPartDocument As SolidEdgePart.PartDocument
        Dim objConstructions As SolidEdgePart.Constructions
        Dim objConstructionModel As SolidEdgePart.ConstructionModel

        Try
            OleMessageFilter.Register()

            objApplication = Marshal.GetActiveObject("SolidEdge.Application")
            objPartDocument = objApplication.ActiveDocument
            objConstructions = objPartDocument.Constructions
            objConstructionModel = objConstructions.Item(1)
            objConstructionModel.HealAndOptimizeBody(True, True)

        Catch ex As Exception
            Console.WriteLine(ex.Message)
        Finally
            OleMessageFilter.Revoke()
        End Try
    End Sub
End Module