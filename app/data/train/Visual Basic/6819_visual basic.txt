Imports System.ServiceModel

Namespace Services.SurfacePicker
    Public Module Fucnt
        ''' <summary>
        ''' Creates the connection
        ''' </summary>
        ''' <param name="Address">The endpoint of the server to connect to.</param>
        ''' <param name="Binding">The binding to use. A NetTCPBinding will be useed (with max 2GB message size) if you don't specify anything,.</param>
        ''' <returns>The client interface, which has the functions you can use.</returns>
        Public Function ConnectChannel(Address As String, Optional Binding As Channels.Binding = Nothing) As iSPClientChannel

            Dim EP As New EndpointAddress(New Uri(Address))
            If IsNothing(Binding) Then
                Dim TempBinding As New NetTcpBinding
                TempBinding.MaxReceivedMessageSize = (Int32.MaxValue - 1)
                Binding = TempBinding
            End If
            Dim Factory As New ChannelFactory(Of iSPClientChannel)(Binding, EP)
            Factory.Open()

            Dim Channel As iSPClientChannel = Factory.CreateChannel
            Channel.Open()

            Return Channel
        End Function
    End Module

    Public Interface iSPClientChannel
        Inherits SPContract, IClientChannel
    End Interface
End Namespace