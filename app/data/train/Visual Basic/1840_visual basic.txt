Public Class LoginUI

	'Form load
	Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
		TextBoxUsername.Text = My.Settings.RemeUser
		CheckBoxReme.Checked = My.Settings.RemeTick
	End Sub

	' Check DB
	Private Function login() As Boolean
		Dim result = db.query("SELECT ID FROM Staff WHERE enable = true AND username = '" + TextBoxUsername.Text + "' AND password='" + TextBoxPassword.Text + "'")
		Return result.hasRows()
	End Function

	' Save Setting
	Private Sub rememberSettings()
		My.Settings.RemeTick = CheckBoxReme.Checked

		If CheckBoxReme.Checked Then
			My.Settings.RemeUser = TextBoxUsername.Text
		Else
			My.Settings.RemeUser = ""
		End If

		My.Settings.Save()
	End Sub

	' OK
	Private Sub ButtonOK_Click() Handles ButtonOK.Click
		rememberSettings()

		If login() Then
			currUser = Staff.getStaff(TextBoxUsername.Text)
			'MainMenuUI.Dispose()
			MainMenuUI.Show()
			Me.Close()
		Else
			MsgBox("Incorrect Username or Password. Please try again.")
		End If
	End Sub

	' Cancel
	Private Sub ButtonCancel_Click() Handles ButtonCancel.Click
		End
	End Sub

	' Keyboard
	Private Sub KeyDownHandle(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles TextBoxPassword.KeyDown, TextBoxUsername.KeyDown
		If e.KeyValue = Keys.Enter Then
			ButtonOK_Click()
		End If
	End Sub

End Class
