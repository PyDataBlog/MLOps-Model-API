Imports System.Windows.Forms

Public Class AddLecturerUI

	Private Sub OK_Button_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles OK_Button.Click

		If Not checkError() Then
			Return
		End If

		Dim l As New Lecturer()
		l.name = TextBoxLName.Text
		l.email = TextBoxEmail.Text
		l.phone = TextBoxPhone.Text
		l.salary = TextBoxSal.Text
		l.insert()

		Me.DialogResult = System.Windows.Forms.DialogResult.OK
		Me.Close()
	End Sub

	Private Sub Cancel_Button_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Cancel_Button.Click
		Me.DialogResult = System.Windows.Forms.DialogResult.Cancel
		Me.Close()
	End Sub

	Private Function checkError() As Boolean
		If TextBoxLName.Text = "" Or TextBoxEmail.Text = "" Or TextBoxPhone.Text = "" Or TextBoxSal.Text = "" Then
			MsgBox("Please fill in all fields.")
			Return False
		End If

		If Not IsNumeric(TextBoxPhone.Text) Or Not IsNumeric(TextBoxSal.Text) Then
			MsgBox("Salary or Phone number should be numeric.")
			Return False
		End If
		Return True
	End Function

End Class
