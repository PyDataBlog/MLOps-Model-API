Public Class form_settings

#Region "Load"

    Private Sub form_settings_Load(sender As Object, e As EventArgs) Handles MyBase.Load

        TabControl1.SelectedTab = TabPage1

        'GENERAL
        If My.Settings.set_autoscroll = True Then
            chk_autoscroll.Checked = True
        Else
            chk_autoscroll.Checked = False
        End If

        If My.Settings.set_startupchk = True Then
            chk_startupchk.Checked = True
        Else
            chk_startupchk.Checked = False
        End If

        If My.Settings.upd_beta = True Then
            chk_updbeta.Checked = True
        Else
            chk_updbeta.Checked = False
        End If
        'THEMES

        If My.Settings.thm_default = True Then
            RadioButton1.Checked = True
        Else
            RadioButton2.Checked = True
        End If

        cb_theme.Text = My.Settings.thm_dafaulttheme


        bc1.BackColor = My.Settings.thm_cback
        bc2.BackColor = My.Settings.thm_ccontrol
        bc3.BackColor = My.Settings.thm_ccontrol2
        bc5.BackColor = My.Settings.thm_cfont



    End Sub
#End Region
#Region "Save/Cancel"
    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click

        'GENERAL
        If chk_autoscroll.Checked = True Then
            My.Settings.set_autoscroll = True
        Else
            My.Settings.set_autoscroll = False
        End If

        If chk_startupchk.Checked = True Then
            My.Settings.set_startupchk = True
        Else
            My.Settings.set_startupchk = False
        End If

        If chk_updbeta.Checked = True Then
            My.Settings.upd_beta = True
        Else
            My.Settings.upd_beta = False
        End If

        'THEMES
        If RadioButton1.Checked = True Then
            If cb_theme.Text = "Light Theme" Then 'LIGHT
                My.Settings.thm_default = True
                My.Settings.thm_dafaulttheme = cb_theme.Text
                My.Settings.thm_cback = SystemColors.Window
                My.Settings.thm_ccontrol = SystemColors.Window
                My.Settings.thm_ccontrol2 = Color.Silver
                My.Settings.thm_cfont = SystemColors.WindowText
            ElseIf cb_theme.Text = "Dark Theme" Then 'DARK
                My.Settings.thm_default = True
                My.Settings.thm_dafaulttheme = cb_theme.Text
                My.Settings.thm_cback = SystemColors.ControlDark
                My.Settings.thm_ccontrol = SystemColors.ControlDarkDark
                My.Settings.thm_ccontrol2 = Color.SteelBlue
                My.Settings.thm_cfont = Color.White
            End If
        Else
            My.Settings.thm_default = False
            My.Settings.thm_dafaulttheme = cb_theme.Text
            My.Settings.thm_cback = bc1.BackColor
            My.Settings.thm_ccontrol = bc2.BackColor
            My.Settings.thm_ccontrol2 = bc3.BackColor
            My.Settings.thm_cfont = bc5.BackColor
        End If



        My.Settings.Save()

        form_main.ini_theme()

        Me.Close()
    End Sub

    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click
        Me.Close()
    End Sub

#End Region
#Region "General"

    Private Sub Button3_Click(sender As Object, e As EventArgs) Handles Button3.Click
        chk_startupchk.Checked = False
        chk_autoscroll.Checked = True
    End Sub
    Private Sub chk_updbeta_MouseClick(sender As Object, e As MouseEventArgs) Handles chk_updbeta.MouseClick
        If chk_updbeta.Checked = True Then
            If MessageBox.Show("Are you sure you want to enable beta-updates ? These may can contain bugs and errors!", "Warining", MessageBoxButtons.YesNo, MessageBoxIcon.Warning) = Windows.Forms.DialogResult.No Then
                chk_updbeta.Checked = False
            End If
        End If
    End Sub
#End Region
#Region "Theme"

    Private Sub bc4_Click(sender As Object, e As EventArgs) Handles bc5.Click
        RadioButton2.Checked = True
        Dim c4_dia As New ColorDialog
        If c4_dia.ShowDialog() = Windows.Forms.DialogResult.OK Then
            bc5.BackColor = c4_dia.Color
        End If
    End Sub

    Private Sub bc3_Click(sender As Object, e As EventArgs) Handles bc3.Click
        RadioButton2.Checked = True
        Dim c3_dia As New ColorDialog
        If c3_dia.ShowDialog() = Windows.Forms.DialogResult.OK Then
            bc3.BackColor = c3_dia.Color
        End If
    End Sub

    Private Sub bc2_Click(sender As Object, e As EventArgs) Handles bc2.Click
        RadioButton2.Checked = True
        Dim c2_dia As New ColorDialog
        If c2_dia.ShowDialog() = Windows.Forms.DialogResult.OK Then
            bc2.BackColor = c2_dia.Color
        End If
    End Sub

    Private Sub bc1_Click(sender As Object, e As EventArgs) Handles bc1.Click
        RadioButton2.Checked = True
        Dim c1_dia As New ColorDialog
        If c1_dia.ShowDialog() = Windows.Forms.DialogResult.OK Then
            bc1.BackColor = c1_dia.Color
        End If
    End Sub

    Private Sub cb_theme_SelectedIndexChanged(sender As Object, e As EventArgs) Handles cb_theme.SelectedIndexChanged
        RadioButton1.Checked = True
    End Sub

    Private Sub b_reset_Click(sender As Object, e As EventArgs) Handles b_reset.Click
        RadioButton1.Checked = True
        cb_theme.Text = "Light Theme"
        bc1.BackColor = SystemColors.Control
        bc2.BackColor = SystemColors.Window
        bc3.BackColor = SystemColors.ControlDark
        bc5.BackColor = SystemColors.WindowText
    End Sub

#End Region
End Class