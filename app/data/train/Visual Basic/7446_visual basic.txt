Imports System.IO
Imports System.Linq
Imports System.Text

Imports Nancy
Imports Nancy.Authentication.Forms
Imports Nancy.Session

Imports App.Core

Public Class Bootsrapper
    Inherits DefaultNancyBootstrapper

    Private Shared ReadOnly _logger As log4net.ILog = log4net.LogManager.GetLogger(
                                                        System.Reflection.MethodInfo.GetCurrentMethod().DeclaringType)

    Protected Overrides Sub ApplicationStartup(container As TinyIoC.TinyIoCContainer, pipelines As Nancy.Bootstrapper.IPipelines)
        MyBase.ApplicationStartup(container, pipelines)
        CookieBasedSessions.Enable(pipelines)
        Me.ConfigureLogging()
    End Sub

    Private Sub ConfigureLogging()
        'configure log4net through common.logging bindings
        Dim logFilePath As String = AppDomain.CurrentDomain.BaseDirectory + "Content\Config\log4net-config.xml"
        Dim finfo As New FileInfo(logFilePath)
        log4net.Config.XmlConfigurator.ConfigureAndWatch(finfo)
    End Sub
End Class


