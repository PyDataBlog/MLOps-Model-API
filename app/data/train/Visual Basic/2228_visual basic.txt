Public Class Uploads

    ' HiF-Client - A client to connect to the HiF database
    ' Copyright (C) 2016 Hawaii Impossible Force team

    ' This program Is free software: you can redistribute it And/Or modify
    ' it under the terms Of the GNU General Public License As published by
    ' the Free Software Foundation, either version 3 Of the License, Or
    ' (at your option) any later version.

    ' This program Is distributed In the hope that it will be useful,
    ' but WITHOUT ANY WARRANTY; without even the implied warranty Of
    ' MERCHANTABILITY Or FITNESS FOR A PARTICULAR PURPOSE.  See the
    ' GNU General Public License For more details.

    ' You should have received a copy Of the GNU General Public License
    ' along with this program.  If Not, see <http://www.gnu.org/licenses/>.

    Private ServerURL As String = Login.serverURL
    Dim hasLogin As Boolean = False

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Home.Show()
        Me.Close()
    End Sub

    Private Sub Uploads_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        WebBrowser1.Navigate(ServerURL + "/uploads/")



    End Sub

    Private Sub WebBrowser1_DocumentCompleted(sender As Object, e As WebBrowserDocumentCompletedEventArgs) Handles WebBrowser1.DocumentCompleted

        'Handles login and expections
        If Not WebBrowser1.Url.AbsolutePath = "/uploads/" Then
            If WebBrowser1.Url.AbsolutePath = "/login" Then
                hasLogin = False
            Else
                WebBrowser1.Visible = True
                hasLogin = True
            End If
            While (hasLogin = False)
                hasLogin = True
                Try
                    WebBrowser1.Document.GetElementById("username").SetAttribute("value", Login.username.Text)
                    WebBrowser1.Document.GetElementById("password").SetAttribute("value", Login.password.Text)
                    WebBrowser1.Document.GetElementById("submit").InvokeMember("click")

                Catch ex As Exception
                    MessageBox.Show(ex.Message, ex.GetType().Name, MessageBoxButtons.OK, MessageBoxIcon.Error)
                    Application.Exit()

                End Try
            End While

            WebBrowser1.Navigate(ServerURL + "/uploads/")
        Else
            WebBrowser1.Visible = True
        End If

    End Sub

    Private Sub WebBrowser1_Navigating(sender As Object, e As WebBrowserNavigatingEventArgs) Handles WebBrowser1.Navigating
        WebBrowser1.Visible = False
    End Sub
End Class