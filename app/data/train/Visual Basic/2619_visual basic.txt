Imports System.Data.SqlClient
Imports CrystalDecisions.CrystalReports.Engine
Imports CrystalDecisions.Shared
Imports System.Configuration

Module Module1
    Public CONN As SqlConnection
    Public DA As SqlDataAdapter
    Public DS As New DataSet
    Public CMD As SqlCommand
    Public DR As SqlDataReader
    Public STR As String

    Public cryRpt As New ReportDocument
    Public crtableLogoninfos As New TableLogOnInfos
    Public crtableLogoninfo As New TableLogOnInfo
    Public crConnectionInfo As New ConnectionInfo
    Public CrTables As Tables
    Public CrTable As Table

    'Dim host As String = My.Computer.Name & "\SQLEXPRESS"

    Public Sub Module_Konfigurasi_laporan()
        With crConnectionInfo
            .ServerName = "localhost"
            .DatabaseName = "Arsip"
            .UserID = "sa"
            .Password = "123"
        End With

        CrTables = cryRpt.Database.Tables
        For Each CrTable In CrTables
            crtableLogoninfo = CrTable.LogOnInfo
            crtableLogoninfo.ConnectionInfo = crConnectionInfo
            CrTable.ApplyLogOnInfo(crtableLogoninfo)
        Next
    End Sub

    Public Sub Koneksi()
        'STR = "data source=" & host & "; initial catalog=arsip;user id=sa; password=123"
        '        CONN = New SqlConnection(ConfigurationManager.AppSettings("DSN"))
        CONN = New SqlConnection(My.Settings.Connection)
        If CONN.State = ConnectionState.Closed Then
            CONN.Open()
        End If
    End Sub
End Module
