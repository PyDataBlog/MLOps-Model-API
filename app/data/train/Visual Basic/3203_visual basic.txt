Public Class PositionerForm
    Public MissionObjectController As MissionObjectController
    Private _newSwitchDriverForm As NewSwitchDriverForm
    Private _positionerForm As PositionerForm
    Private _positonerIdx As Integer
    Private _maxPositoners As Integer
    Private _surveyName As String
    Private _numSwitchDrivers As Integer

    Public Sub New(ByRef aMissionObjectController As MissionObjectController, ByVal aIdx As Integer, ByVal maxNum As Integer, ByVal numSwitchDrivers As Integer)
        Me.MissionObjectController = aMissionObjectController
        Me._positonerIdx = aIdx
        Me._maxPositoners = maxNum
        Me._numSwitchDrivers = numSwitchDrivers

        If aIdx >= maxNum Then
            Me._newSwitchDriverForm = New NewSwitchDriverForm(Me.MissionObjectController, 0, numSwitchDrivers)
            Return
        End If

        InitializeComponent()

        'populate the combo box with the types defined
        Me.cmbBxPositionerType.DataSource = System.Enum.GetValues(GetType(Enumerations.PositionerModel))

        Me.Text = "Positioner " & aIdx + 1
        Me.StartPosition = FormStartPosition.Manual
        Me.Left = 300
        Me.Top = 300
        Me.Visible = True

    End Sub

    Private Sub btnFinished_Click_1(sender As System.Object, e As System.EventArgs) Handles btnFinished.Click

        With Me.MissionObjectController.aMain.SurveyController.surveyObj
            .getPositioner(Me._positonerIdx) = New PositionerObject

            With .getPositioner(Me._positonerIdx)
                .getPositionerType = Me.cmbBxPositionerType.SelectedItem
                .getComPortNumber = Me.numUpDwnSerCOMportNum.Value
                .getConnectionString = "ASRL" & .getComPortNumber & "::INSTR"

                .getInterleaveStep = Me.numUpDwnInterleaveStep.Value
                .getAzimuthStep = Me.numUpDwnAzimuthStep.Value
                .getAzimuthStart = Me.numUpDwnAzimStart.Value
                .getAzimuthStop = Me.numUpDwnAzimStop.Value

                .getElevationStart = Me.numUpDwnElStart.Value
                .getElevationStop = Me.numUpDownElStop.Value
                .getElevationStep = Me.numUpDwnElStep.Value
                .getElevationInterleaveStep = Me.numUpDownElInterleaveStep.Value

                If Me.cmbBxIgnoreElevation.Text = "TRUE" Then
                    .getIgnoreElevationParameters = True
                Else
                    .getIgnoreElevationParameters = False
                End If

                If Me.cmbBxPrevCableWrap.Text = "TRUE" Then
                    .getPreventCableWrap = True
                Else
                    .getPreventCableWrap = False
                End If


            End With

        End With
        Me._positonerIdx += 1
        Me.Visible = False
        Me._positionerForm = New PositionerForm(Me.MissionObjectController, Me._positonerIdx, Me._maxPositoners, Me._numSwitchDrivers)

    End Sub

    Private Sub cmbBxIgnoreElevation_SelectedIndexChanged(sender As System.Object, e As System.EventArgs) Handles cmbBxIgnoreElevation.SelectedIndexChanged
        Try
            If Me.cmbBxIgnoreElevation.Text.ToUpper = "TRUE" Then
                Me.grpBxElev.Visible = False
            ElseIf Me.cmbBxIgnoreElevation.Text.ToUpper = "FALSE" Then
                Me.grpBxElev.Visible = True
            End If
        Catch ex As Exception

        End Try
    End Sub
End Class