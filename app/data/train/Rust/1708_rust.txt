extern crate oxide;

use oxide::http;
use oxide::http::HttpMethod;
use oxide::http::HttpRequest;
use oxide::http::HttpResponse;
use oxide::http::HttpResponseBuilder;
use oxide::http::HttpStatusCode;
use std::net::Ipv4Addr;

fn main() {

    let handler = |req: HttpRequest| -> HttpResponse {
        println!("{}", req.to_string());

        let method = req.get_method();
        let message =
                match method {
                    HttpMethod::Post => format!("Hello {}!", req.get_message()),
                    _                => format!("Hello World!"),
                };

        HttpResponseBuilder::new()
                             .set_status(HttpStatusCode::OK)
                             .set_message(message)
                             .build()
    };

    http::Server::new(Ipv4Addr::new(0, 0, 0, 0), 8080).listen(handler);

}

