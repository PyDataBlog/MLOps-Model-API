package com.accela.ObjectStreams;

import java.io.DataOutputStream;
import java.io.IOException;
import java.io.OutputStream;

import com.accela.ObjectStreams.support.ObjectOutputStreamSupport;

/**
 * 
 * Ò»¡¢HP¶ÔÏóÊä³öÁ÷(ÎÒÆðµÄÃû×Ö)¡£Õâ¸ö¶ÔÏóÊä³öÁ÷ÓÉ·´ÉäÐ´³É¡£
 * ¿ÉÒÔ¶ÁÈ¡»òÊä³ö£º
 * 1¡¢¶ÁÈ¡ÓµÓÐ¿ÉÒÔÍ¨¹ý·´ÉäÀûÓÃ¹¹Ôìº¯ÊýÀ´´´½¨µÄ¶ÔÏó¡£¹¹Ôìº¯Êý¿ÉÒÔ
 * ÊÇË½ÓÐµÄ£¬×îºÃÊÇÎÞ²Î¹¹Ôìº¯Êý£¬µ«ÊÇÓÐ²ÎÊýµÄ¹¹Ôìº¯ÊýÒ²¿ÉÒÔ£¬
 * Ö»ÊÇËÙ¶È¸üÂý¡£
 * 2¡¢Êý×éÀàÐÍ£¬ÎÞÂÛÊý×éÔªËØÊÇ»ù±¾ÀàÐÍ»¹ÊÇ¶ÔÏóÀàÐÍ¡£
 * null¡£
 * 3¡¢Ã¶¾Ù±äÁ¿
 * 4¡¢ÄÜ¹»Ê¶±ðÉùÃ÷ÎªtransientµÄ¶ÔÏóÀàÐÍµÄ×Ö¶Î£¬ÔÚÊä³öµÄÊ±ºò»á×Ô¶¯
 * Ð´Îªnull
 * 5¡¢ÄÜ¹»Ê¶±ðÊµÏÖÁËCollection»òMap½Ó¿ÚµÄ¶ÔÏó£¬ÓÃÓÅ»¯µÄ·½Ê½Êä³ö¡£
 * µ«ÊÇ¶ÔÓÚËüÃÇ»áºöÂÔÈ¥ÖÐµÄtransient×Ö¶Î£¬µ±×÷Ã»ÓÐÉùÃ÷transient
 * µÄ×Ö¶ÎÊä³ö
 * 6¡¢ÄÜ¹»Êä³öºÍ¶ÁÈ¡´æÔÚÑ­»·ÒýÓÃµÄ¶ÔÏó
 * 
 * ¶þ¡¢Óëjava.io.ObjectInputStreamºÍjava.io.ObjectOutputStreamµÄÇø±ð£º
 * 1¡¢Èç¹ûÔÚÎÄ¼þÖÐÐ´ÈëÒ»¸ö¶ÔÏó£¬ÓÃjava.io.ObjectInputStream¶ÁÈ¡ÎÞÂÛ
 * ¶àÉÙ´Î£¬¶¼Ö»»áÉú³ÉÒ»¸öÊµÀý¡£ÕâÔÚÍøÂçÖÐ·¢ËÍ¶ÔÏóµÄÊ±ºò»áµ¼ÖÂ·¢ËÍ¶ÔÏó
 * ·½·¢ËÍÒ»¸ö¶ÔÏóºó£¬¸ü¸Ä¸Ã¶ÔÏó£¬ÔÙ·¢ËÍ£¬¶ø½ÓÊÕ¶ÔÏó·½Ö»ÄÜ½ÓÊÕÒ»´Î£¬ºó
 * ÐøµÄ½ÓÊÕ·µ»ØµÄ¶¼ÊÇµÚÒ»´Î½ÓÊÕµÄ¶ÔÏó¡£
 * 2¡¢ÓëObjectPoolÅäºÏ£¬ÓÅ»¯ÁËÐÂ½¨¶ÔÏóÊ±µÄÄÚ´æ·ÖÅä¡£µ±·¢ËÍÍ¬ÀàÐÍµÄ¶Ô
 * ÏóµÄÊ±ºò£¬Èç¹ûÃ¿10ms¿ËÂ¡Ò»¸±±¾²¢·¢ËÍÒ»´Î(Èç¹û²»¿ËÂ¡£¬java.io.ObjectInputStream£¬
 * ¾ÍÖ»ÄÜ½ÓÊÕµÚÒ»´Î·¢ËÍµÄ¶ÔÏó)£¬Ê¹ÓÃjava.io.ObjectInputStream½ÓÊÕ¶ÔÏó
 * µÄÊ±ºò»áÐÂ½¨´óÁ¿¶ÔÏóÊµÀý£¬¼´Ê¹ÊÍ·ÅÒ²ÄÑÒÔ±»Á¢¼´»ØÊÕ¡£¶øÊ¹ÓÃHPObjectInputStream
 * Ôò¿ÉÒÔÓë¶ÔÏó³ØÅäºÏ£¬ÀûÓÃÊÍ·ÅµôµÄ¶ÔÏó£¬±ÜÃâÖØ¸´ÐÂ½¨ÊµÀý¡£
 * 
 * Èý¡¢ÐèÒª×¢ÒâµÄµØ·½£º
 * 1¡¢HPObjectOutputStreamºÍHPObjectInputStreamÓëjava.io.ObjectInputStream
 * ºÍjava.io.ObjectOutputStream²¢²»ÄÜ¼æÈÝ¡£ÓÃÒ»ÖÖÊä³öÁ÷Ð´µÄ¶ÔÏó£¬ÁíÒ»ÖÖÊäÈëÁ÷
 * ²»ÄÜ¶ÁÈ¡¡£
 * 2¡¢HPObjectOutputStreamºÍHPObjectInputStreamÊ¹ÓÃ·´ÉäÐ´³É£¬·´ÉäÊÇÆäÐÔÄÜµÄÆ¿
 * ¾±£¬¾¡¹Ü¶ÔÏó³Ø¿ÉÒÔ´ó´óµØÓÅ»¯ÆäÐ§ÂÊ¡£HPObjectInputStreamÊ¹ÓÃ·´Éä¹¹Ôìº¯ÊýÀ´ÐÂ
 * ½¨¶ÔÏµÄÇ¸ö£¬Èç¹ûÃ»ÓÐÎÞ²Î¹¹Ôìº¯Êý£¬HPObjectInputStream¾Í»áÓÃÊÔÌ½²ÎÊý²âÊÔÆäËûµÄ
 * ÓÐ²Î¹¹Ôìº¯Êý£¬À´ÊÔÍ¼ÐÂ½¨¶ÔÏóÊµÀý¡£Õâ»ØÔì³ÉÐÔÄÜÀË·Ñ£¬½¨ÒéÔÚ²»±ãÊ¹ÓÃÓÐ²Î¹¹Ôìº¯Êý
 * µÄÇé¿öÏÂ£¬¸øÐèÒªÊä³öµÄÀàÐ´Ò»¸öË½ÓÐµÄÎÞ²Î¹¹Ôìº¯Êý¡£
 * 3¡¢HPObjectOutputStreamºÍHPObjectInputStreamÊ¹ÓÃ·´ÉäÀ´·ÃÎÊ¶ÔÏóµÄ¹¹Ôìº¯ÊýºÍ×Ö
 * ¶Î£¬µ«ÊÇÈç¹û¶ÔÏóÊÇÓÃÁËSecurityManagerÀ´½ûÖ¹£¬ÄÄÅÂÊ¹ÓÃsetAccessible(true)·½·¨£¬
 * Ò²ÎÞ·¨·ÃÎÊµÄ»°£¬HPObjectOutputStreamºÍHPObjectInputStream¾Í»áÅ×³öÒì³£¡£
 * 
 * ËÄ¡¢Î´½â¾öµÄBUG
 * 1¡¢ÔÚÊ¹ÓÃÖÐ·¢ÏÖ£¬µ±Ê¹ÓÃHPObjectOutputStreamºÍHPObjectInputStreamÊ±£¬¼«ÉÙÇé¿öÏÂ£¬
 * »áËæ»úµÄ·¢ÉúConcurrentModificationException¡£Ô­Òò²»Ã÷£¬¿ÉÄÜºÍ¶ÔÐ´¼¯ºÏÀàÓÐ¹Ø¡£
 * 
 *
 */
public class HPObjectOutputStream extends DataOutputStream
{
	private ObjectOutputStreamSupport support = new ObjectOutputStreamSupport();
	
	public HPObjectOutputStream(OutputStream out)
	{
		super(out);
	}

	public void writeObject(Object object) throws IOException
	{
		support.writeObject(object, this);
	}

}
